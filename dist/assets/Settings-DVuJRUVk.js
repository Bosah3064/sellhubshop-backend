import{u as ve,v as je,m as ye,r as h,s as i,j as e,ah as we,ai as be,aj as C,a1 as _e,az as Ne,f as Pe,aO as Se,ak as E,b as x,x as g,y as v,a8 as j,e as y,o,B as d,X as Ce,I as m,d as ee,ay as Ee}from"./index-DIxCcwTo.js";import{S as De}from"./SEO-DRdgyEjE.js";import{S as M}from"./switch-Cu0j0zPN.js";import{S as q,a as R,b as B,c as z,d as p}from"./select-D5YEeGQh.js";import{T as ke}from"./textarea-QQPFZBv8.js";import{A as Fe,a as Te,b as Ue}from"./avatar-C_jNKov4.js";import{D as Ae,g as Me,a as qe,d as Re,c as Be,e as ze}from"./dialog-YYEI7PMn.js";import{C as se}from"./credit-card-CW0P80aF.js";import{G as Le}from"./globe-CnvpoBT7.js";import{C as Ie}from"./camera-DUJXmKo-.js";import{S as F}from"./save-MXRJQatm.js";import{E as Ye}from"./eye-off-BjvTbt_r.js";import{E as Oe}from"./eye-DkAcDlvf.js";import{T as Ge}from"./trash-2-2bzzvvn1.js";import{P as Ke}from"./plus-CBbazF2H.js";import"./index-DskgONLa.js";import"./index-BdQq_4o_.js";function cs(){const{toast:n}=ve(),ae=je(),L=ye(),[re,W]=h.useState(!0),[f,T]=h.useState(!1),[D,H]=h.useState(!1),[U,te]=h.useState(!1),[t,c]=h.useState({username:"",full_name:"",email:"",phone:"",whatsapp:"",location:"",bio:"",avatar_url:"",local_delivery_fee:200,outside_delivery_fee:350,business_location:"",payment_preference:"wallet",mpesa_phone:""}),[w,b]=h.useState({email_notifications:!0,push_notifications:!1,two_factor_auth:!1,dark_mode:!1,language:"en",currency:"ksh"}),[_,I]=h.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[Y,A]=h.useState([]),[V,ie]=h.useState([]),[N,ne]=h.useState(null),[k,O]=h.useState({type:"mpesa",phone:""});h.useEffect(()=>{le()},[]);const le=async()=>{try{W(!0);const{data:{session:s},error:a}=await i.auth.getSession();if(a)throw console.error("Session error:",a),a;if(!s){console.log("No active session");return}const{data:{user:r}}=await i.auth.getUser();console.log("ðŸ” Debug - User ID:",r?.id),r&&(await oe(r),await ce(r.id),await de(r.id))}catch(s){console.error("Error loading user data:",s),n({title:"Error loading settings",description:"Failed to load your settings. Please try again.",variant:"destructive"})}finally{W(!1)}},oe=async s=>{const{data:a,error:r}=await i.from("profiles").select("*").eq("id",s.id).single();if(r&&r.code==="PGRST116"){const{data:l,error:u}=await i.from("profiles").insert({id:s.id,email:s.email,username:"",full_name:s.user_metadata?.full_name||"",phone:"",whatsapp:"",location:"",bio:"",avatar_url:"",updated_at:null}).select().single();if(u)throw console.error("Error creating profile:",u),u;l&&c({username:l.username||"",full_name:l.full_name||"",email:l.email||s.email||"",phone:l.phone||"",whatsapp:l.whatsapp||"",location:l.location||"",bio:l.bio||"",avatar_url:l.avatar_url||"",local_delivery_fee:l.local_delivery_fee??200,outside_delivery_fee:l.outside_delivery_fee??350,business_location:l.business_location||"",payment_preference:l.payment_preference||"wallet",mpesa_phone:l.mpesa_phone||""})}else a&&c({username:a.username||"",full_name:a.full_name||"",email:a.email||s.email||"",phone:a.phone||"",whatsapp:a.whatsapp||"",location:a.location||"",bio:a.bio||"",avatar_url:a.avatar_url||"",local_delivery_fee:a.local_delivery_fee??200,outside_delivery_fee:a.outside_delivery_fee??350,business_location:a.business_location||"",payment_preference:a.payment_preference||"wallet",mpesa_phone:a.mpesa_phone||""})},ce=async s=>{try{const{data:a,error:r}=await i.from("user_preferences").select("*").eq("user_id",s).maybeSingle();r&&r.code!=="PGRST116"?console.warn("Error loading preferences:",r):a&&b(a)}catch(a){console.log("Preferences load failed, using defaults:",a)}},de=async s=>{try{const{data:a,error:r}=await i.from("payment_methods").select("*").eq("user_id",s).order("is_default",{ascending:!1}).order("created_at",{ascending:!1});r?console.warn("Error loading payment methods:",r):A(a||[]);const{data:l,error:u}=await i.from("billing_history").select("*").eq("user_id",s).order("created_at",{ascending:!1}).limit(10);u?console.warn("Error loading billing history:",u):ie(l||[]);const{data:P,error:S}=await i.from("subscriptions").select("*").eq("user_id",s).eq("status","active").maybeSingle();S&&S.code!=="PGRST116"?console.warn("Error loading subscription:",S):ne(P)}catch(a){console.error("Error loading billing data:",a)}},ue=async s=>{try{const a=s.target.files?.[0];if(!a)return;if(a.size>5*1024*1024){n({title:"File too large",description:"Please select an image smaller than 5MB",variant:"destructive"});return}if(!a.type.startsWith("image/")){n({title:"Invalid file type",description:"Please select an image file",variant:"destructive"});return}H(!0);const{data:{user:r}}=await i.auth.getUser();if(!r){n({title:"Authentication required",description:"Please sign in to upload images",variant:"destructive"});return}const l=a.name.split(".").pop(),u=`${r.id}/${Math.random().toString(36).substring(2,15)}.${l}`,{error:P}=await i.storage.from("avatars").upload(u,a,{upsert:!0});if(P)throw P;const{data:{publicUrl:S}}=i.storage.from("avatars").getPublicUrl(u),{error:Z}=await i.from("profiles").update({avatar_url:S,updated_at:new Date().toISOString()}).eq("id",r.id);if(Z)throw Z;c(ge=>({...ge,avatar_url:S})),n({title:"Profile image updated!",description:"Your profile picture has been updated successfully."}),G()}catch(a){console.error("Error uploading image:",a),n({title:"Upload failed",description:a.message||"There was an error uploading your image.",variant:"destructive"})}finally{H(!1),s.target.value=""}},me=async()=>{try{const{data:{user:s}}=await i.auth.getUser();if(!s)return;const{error:a}=await i.from("profiles").update({avatar_url:null,updated_at:new Date().toISOString()}).eq("id",s.id);if(a)throw a;c(r=>({...r,avatar_url:""})),n({title:"Profile image removed",description:"Your profile picture has been removed."}),G()}catch(s){console.error("Error removing image:",s),n({title:"Failed to remove image",description:s.message||"There was an error removing your image.",variant:"destructive"})}},G=async()=>{try{const{data:{user:s}}=await i.auth.getUser();if(!s)return;const{data:a}=await i.from("profiles").select("full_name, updated_at").eq("id",s.id).single();a&&a.full_name&&a.full_name.trim()!==""&&a.full_name!=="User"&&a.updated_at!==null&&L.state?.fromAuth&&setTimeout(()=>{ae("/",{replace:!0})},1500)}catch(s){console.error("Error checking profile completion:",s)}},$=async()=>{try{T(!0);const{data:{user:s}}=await i.auth.getUser();if(!s){n({title:"Authentication required",description:"Please sign in to update your profile.",variant:"destructive"});return}if(!t.full_name.trim()){n({title:"Full name required",description:"Please enter your full name to complete your profile.",variant:"destructive"});return}if(t.username){const{data:u,error:P}=await i.from("profiles").select("id").eq("username",t.username).neq("id",s.id).single();if(u&&!P){n({title:"Username taken",description:"This username is already taken. Please choose another one.",variant:"destructive"});return}}const{data:a}=await i.from("profiles").select("email, avatar_url").eq("id",s.id).single(),r={id:s.id,username:t.username||null,full_name:t.full_name.trim(),phone:t.phone,whatsapp:t.whatsapp,location:t.location,bio:t.bio,avatar_url:t.avatar_url||null,local_delivery_fee:Number(t.local_delivery_fee),outside_delivery_fee:Number(t.outside_delivery_fee),business_location:t.business_location,payment_preference:t.payment_preference,mpesa_phone:t.mpesa_phone,updated_at:new Date().toISOString()};a?.email?r.email=a.email:r.email=s.email;const{error:l}=await i.from("profiles").upsert(r);if(l)throw l;n({title:"Profile updated!",description:"Your profile information has been saved successfully."}),G()}catch(s){console.error("Error saving profile:",s),n({title:"Failed to save",description:s.message||"There was an error saving your profile.",variant:"destructive"})}finally{T(!1)}},J=async()=>{try{T(!0);const{data:{user:s}}=await i.auth.getUser();if(!s){n({title:"Authentication required",description:"Please sign in to save preferences.",variant:"destructive"});return}const{error:a}=await i.from("user_preferences").upsert({user_id:s.id,...w,updated_at:new Date().toISOString()},{onConflict:"user_id"});if(a)throw a;n({title:"Preferences saved!",description:"Your settings have been updated successfully."})}catch(s){console.error("Error saving preferences:",s),n({title:"Failed to save preferences",description:s.message||"There was an error saving your preferences.",variant:"destructive"})}finally{T(!1)}},he=async()=>{if(_.newPassword!==_.confirmPassword){n({title:"Passwords don't match",description:"New password and confirmation password must match.",variant:"destructive"});return}if(_.newPassword.length<6){n({title:"Password too short",description:"Password must be at least 6 characters long.",variant:"destructive"});return}try{const{error:s}=await i.auth.updateUser({password:_.newPassword});if(s)throw s;n({title:"Password updated!",description:"Your password has been changed successfully."}),I({currentPassword:"",newPassword:"",confirmPassword:""})}catch(s){console.error("Error changing password:",s),n({title:"Failed to update password",description:s.message||"There was an error changing your password.",variant:"destructive"})}},pe=async()=>{try{const{data:{user:s}}=await i.auth.getUser();if(!s){n({title:"Authentication required",description:"Please sign in to add payment methods.",variant:"destructive"});return}if(!k.phone.trim()){n({title:"Phone number required",description:"Please enter a valid phone number.",variant:"destructive"});return}const{data:a,error:r}=await i.from("payment_methods").insert({user_id:s.id,type:"mpesa",last_four:k.phone.slice(-4),is_default:Y.length===0,metadata:{phone:k.phone,provider:"M-Pesa"}}).select().single();if(r)throw r;A(l=>[a,...l]),O({type:"mpesa",phone:""}),n({title:"Payment method added!",description:"M-Pesa number has been added successfully."})}catch(s){console.error("Error adding payment method:",s),n({title:"Failed to add payment method",description:s.message||"There was an error adding your payment method.",variant:"destructive"})}},fe=async s=>{try{const{error:a}=await i.from("payment_methods").delete().eq("id",s);if(a)throw a;A(r=>r.filter(l=>l.id!==s)),n({title:"Payment method removed",description:"Payment method has been removed successfully."})}catch(a){console.error("Error removing payment method:",a),n({title:"Failed to remove payment method",description:a.message||"There was an error removing your payment method.",variant:"destructive"})}},xe=async s=>{try{const{data:{user:a}}=await i.auth.getUser();if(!a)return;await i.from("payment_methods").update({is_default:!1}).eq("user_id",a.id);const{error:r}=await i.from("payment_methods").update({is_default:!0}).eq("id",s);if(r)throw r;A(l=>l.map(u=>({...u,is_default:u.id===s}))),n({title:"Default payment updated!",description:"Your default payment method has been updated."})}catch(a){console.error("Error setting default payment:",a),n({title:"Failed to update default payment",description:a.message||"There was an error updating your default payment method.",variant:"destructive"})}},X=(s,a)=>new Intl.NumberFormat("en-KE",{style:"currency",currency:a.toUpperCase()}).format(s),K=s=>new Date(s).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"}),Q=s=>{const r={completed:{variant:"default",label:"Completed"},pending:{variant:"secondary",label:"Pending"},failed:{variant:"destructive",label:"Failed"},active:{variant:"default",label:"Active"},canceled:{variant:"secondary",label:"Canceled"},past_due:{variant:"destructive",label:"Past Due"}}[s]||{variant:"secondary",label:s};return e.jsx(ee,{variant:r.variant,children:r.label})};return re?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{children:"Loading settings..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx(De,{title:"Account Settings",description:"Manage your account settings, notifications, security preferences, billing information, and app preferences. Customize your marketplace experience.",keywords:"account settings, profile settings, notification preferences, security settings"}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-secondary/10",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"Settings"}),L.state?.fromAuth&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"text-blue-800 font-semibold mb-2",children:"ðŸ‘‹ Welcome to Connect!"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Please complete your profile setup to get started. You'll be redirected to the home page automatically once your profile is complete."})]}),e.jsxs(we,{defaultValue:"account",className:"space-y-6",children:[e.jsxs(be,{className:"grid grid-cols-2 md:grid-cols-5 w-full",children:[e.jsxs(C,{value:"account",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Account"]}),e.jsxs(C,{value:"notifications",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Notifications"]}),e.jsxs(C,{value:"security",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Security"]}),e.jsxs(C,{value:"billing",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Billing"]}),e.jsxs(C,{value:"preferences",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Preferences"]}),e.jsxs(C,{value:"shop",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Shop Settings"]})]}),e.jsx(E,{value:"account",children:e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(v,{children:"Account Information"}),e.jsx(j,{children:"Update your account details and profile information"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-6 mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(Fe,{className:"w-24 h-24 border-2 border-border",children:[e.jsx(Te,{src:t.avatar_url}),e.jsx(Ue,{className:"text-2xl bg-muted",children:t.full_name?.charAt(0)||t.username?.charAt(0)||"U"})]}),D&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"avatar-upload",className:"cursor-pointer",children:e.jsx(d,{variant:"outline",type:"button",disabled:D,asChild:!0,children:e.jsxs("span",{children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),D?"Uploading...":"Change Photo"]})})}),e.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",onChange:ue,className:"hidden",disabled:D}),t.avatar_url&&e.jsxs(d,{variant:"ghost",size:"sm",onClick:me,disabled:D,className:"text-destructive hover:text-destructive",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Remove Photo"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"JPG, PNG or WebP. Max 5MB."})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"username",children:"Username"}),e.jsx(m,{id:"username",value:t.username,onChange:s=>c(a=>({...a,username:s.target.value})),placeholder:"johndoe"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Your profile URL: connect.com/u/",t.username||"username"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"full_name",children:"Full Name *"}),e.jsx(m,{id:"full_name",value:t.full_name,onChange:s=>c(a=>({...a,full_name:s.target.value})),placeholder:"John Doe",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Required to complete your profile"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"email",children:"Email"}),e.jsx(m,{id:"email",type:"email",value:t.email,disabled:!0,className:"bg-muted"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Contact support to change your email"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"phone",children:"Phone Number"}),e.jsx(m,{id:"phone",value:t.phone,onChange:s=>c(a=>({...a,phone:s.target.value})),placeholder:"+254 700 000 000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"whatsapp",children:"WhatsApp"}),e.jsx(m,{id:"whatsapp",value:t.whatsapp,onChange:s=>c(a=>({...a,whatsapp:s.target.value})),placeholder:"+254 700 000 000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"location",children:"Location"}),e.jsx(m,{id:"location",value:t.location,onChange:s=>c(a=>({...a,location:s.target.value})),placeholder:"Nairobi, Kenya"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"bio",children:"Bio"}),e.jsx(ke,{id:"bio",value:t.bio,onChange:s=>c(a=>({...a,bio:s.target.value})),placeholder:"Tell us about yourself...",className:"min-h-[100px]"})]}),e.jsxs(d,{onClick:$,disabled:f,children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),f?"Saving...":"Save Changes"]}),L.state?.fromAuth&&e.jsx("p",{className:"text-xs text-green-600 mt-2",children:"âœ“ After saving your profile, you'll be redirected to the home page"})]})]})}),e.jsx(E,{value:"notifications",children:e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(v,{children:"Notification Preferences"}),e.jsx(j,{children:"Manage how you receive notifications"})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive notifications via email"})]}),e.jsx(M,{checked:w.email_notifications,onCheckedChange:s=>b(a=>({...a,email_notifications:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{children:"Push Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive push notifications on your device"})]}),e.jsx(M,{checked:w.push_notifications,onCheckedChange:s=>b(a=>({...a,push_notifications:s}))})]}),e.jsxs(d,{onClick:J,disabled:f,children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),f?"Saving...":"Save Preferences"]})]})]})}),e.jsx(E,{value:"security",children:e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(v,{children:"Security Settings"}),e.jsx(j,{children:"Manage your account security"})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{id:"newPassword",type:U?"text":"password",placeholder:"Enter new password",value:_.newPassword,onChange:s=>I(a=>({...a,newPassword:s.target.value}))}),e.jsx(d,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>te(!U),children:U?e.jsx(Ye,{className:"h-4 w-4"}):e.jsx(Oe,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsx(m,{id:"confirmPassword",type:U?"text":"password",placeholder:"Confirm new password",value:_.confirmPassword,onChange:s=>I(a=>({...a,confirmPassword:s.target.value}))})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add an extra layer of security"})]}),e.jsx(M,{checked:w.two_factor_auth,onCheckedChange:s=>b(a=>({...a,two_factor_auth:s}))})]}),e.jsxs(d,{onClick:he,disabled:f,children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),f?"Updating...":"Update Password"]})]})]})}),e.jsx(E,{value:"billing",children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(v,{children:"Subscription Plan"}),e.jsx(j,{children:"Your current subscription status and details"})]}),e.jsx(y,{children:N?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold capitalize",children:[N.plan_type," Plan"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[X(N.price,N.currency)," ","per month"]})]}),Q(N.status)]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Renews on"," ",K(N.current_period_end)]}),e.jsx(d,{variant:"outline",children:"Manage Subscription"})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No active subscription"}),e.jsx(d,{children:"Upgrade to Premium"})]})})]}),e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(v,{children:"Payment Methods"}),e.jsx(j,{children:"Manage your payment methods and billing preferences"})]}),e.jsxs(y,{className:"space-y-4",children:[Y.length>0?Y.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium capitalize",children:[s.type," â€¢â€¢â€¢â€¢ ",s.last_four]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Added ",K(s.created_at),s.is_default&&e.jsx(ee,{variant:"secondary",className:"ml-2",children:"Default"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!s.is_default&&e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>xe(s.id),children:"Set Default"}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>fe(s.id),className:"text-destructive hover:text-destructive",children:e.jsx(Ge,{className:"h-4 w-4"})})]})]},s.id)):e.jsx("div",{className:"text-center py-6",children:e.jsx("p",{className:"text-muted-foreground mb-4",children:"No payment methods added"})}),e.jsxs(Ae,{children:[e.jsx(Me,{asChild:!0,children:e.jsxs(d,{variant:"outline",className:"w-full",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),"Add Payment Method"]})}),e.jsxs(qe,{children:[e.jsxs(Re,{children:[e.jsx(Be,{children:"Add Payment Method"}),e.jsx(ze,{children:"Add a new payment method to your account"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Payment Type"}),e.jsxs(q,{value:k.type,onValueChange:s=>O(a=>({...a,type:s})),children:[e.jsx(R,{children:e.jsx(B,{})}),e.jsxs(z,{children:[e.jsx(p,{value:"mpesa",children:"M-Pesa"}),e.jsx(p,{value:"card",children:"Credit/Debit Card"}),e.jsx(p,{value:"bank",children:"Bank Transfer"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Phone Number"}),e.jsx(m,{placeholder:"+254 700 000 000",value:k.phone,onChange:s=>O(a=>({...a,phone:s.target.value}))})]}),e.jsx(d,{onClick:pe,className:"w-full",children:"Add Payment Method"})]})]})]})]})]}),e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(v,{children:"Billing History"}),e.jsx(j,{children:"Your recent transactions and invoices"})]}),e.jsx(y,{children:V.length>0?e.jsx("div",{className:"space-y-4",children:V.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-medium",children:s.description}),Q(s.status)]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsx("span",{children:K(s.created_at)}),e.jsx("span",{className:"font-semibold",children:X(s.amount,s.currency)})]})]}),s.invoice_url&&e.jsx(d,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx("a",{href:s.invoice_url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(Ee,{className:"h-4 w-4"})})})]},s.id))}):e.jsx("div",{className:"text-center py-6",children:e.jsx("p",{className:"text-muted-foreground",children:"No billing history available"})})})]})]})}),e.jsx(E,{value:"preferences",children:e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(v,{children:"App Preferences"}),e.jsx(j,{children:"Customize your experience"})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Language"}),e.jsxs(q,{value:w.language,onValueChange:s=>b(a=>({...a,language:s})),children:[e.jsx(R,{children:e.jsx(B,{})}),e.jsxs(z,{children:[e.jsx(p,{value:"en",children:"English"}),e.jsx(p,{value:"sw",children:"Swahili"}),e.jsx(p,{value:"fr",children:"French"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Currency"}),e.jsxs(q,{value:w.currency,onValueChange:s=>b(a=>({...a,currency:s})),children:[e.jsx(R,{children:e.jsx(B,{})}),e.jsxs(z,{children:[e.jsx(p,{value:"ksh",children:"KSh (Kenyan Shilling)"}),e.jsx(p,{value:"usd",children:"USD (US Dollar)"}),e.jsx(p,{value:"eur",children:"EUR (Euro)"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{children:"Dark Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Toggle dark mode theme"})]}),e.jsx(M,{checked:w.dark_mode,onCheckedChange:s=>b(a=>({...a,dark_mode:s}))})]}),e.jsxs(d,{onClick:J,disabled:f,children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),f?"Saving...":"Save Preferences"]})]})]})}),e.jsx(E,{value:"shop",children:e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(v,{children:"Shop & Delivery Settings"}),e.jsx(j,{children:"Manage your business location and delivery fees for customers"})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"business_location",children:"Business Base Location (e.g., Nairobi)"}),e.jsx(m,{id:"business_location",value:t.business_location,onChange:s=>c(a=>({...a,business_location:s.target.value})),placeholder:"e.g. Nairobi"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The city or region where your business is primarily located."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"local_fee",children:"Local Delivery Fee (KES)"}),e.jsx(m,{id:"local_fee",type:"number",value:t.local_delivery_fee,onChange:s=>c(a=>({...a,local_delivery_fee:Number(s.target.value)})),placeholder:"200"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Fee charged for deliveries within your base location."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"outside_fee",children:"Outside Delivery Fee (KES)"}),e.jsx(m,{id:"outside_fee",type:"number",value:t.outside_delivery_fee,onChange:s=>c(a=>({...a,outside_delivery_fee:Number(s.target.value)})),placeholder:"350"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Fee charged for deliveries outside your base location."})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Payment Preferences"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose how you want to receive payments from sales."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"payment_pref",children:"Preferred Payment Method"}),e.jsxs(q,{value:t.payment_preference,onValueChange:s=>c(a=>({...a,payment_preference:s})),children:[e.jsx(R,{id:"payment_pref",children:e.jsx(B,{placeholder:"Select method"})}),e.jsxs(z,{children:[e.jsx(p,{value:"wallet",children:"SellHub Wallet (Recommended)"}),e.jsx(p,{value:"mpesa",children:"M-Pesa (Direct to Phone)"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'"Wallet" keeps funds in your dashboard. "M-Pesa" attempts to send directly if supported, otherwise defaults to Wallet.'})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"mpesa_phone",children:"M-Pesa Phone Number"}),e.jsx(m,{id:"mpesa_phone",value:t.mpesa_phone,onChange:s=>c(a=>({...a,mpesa_phone:s.target.value})),placeholder:"2547..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Required if you select M-Pesa as your preferred payment method."})]})]}),e.jsxs(d,{onClick:$,disabled:f,children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),f?"Saving...":"Save Shop Settings"]})]})]})})]})]})})]})}export{cs as default};
