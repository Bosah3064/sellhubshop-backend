import{aw as P,ax as de,a_ as vt,r as b,K as jt,j as e,N as Nt,a$ as wt,O as Re,V as Ct,W as Pt,Q as At,au as St,s as W,al as E,q as be,t as Be,d as k,g as ye,B as M,T as Ie,b as z,e as G,aT as _t,aV as Ot,Z as Rt,ag as Et,S as ie,A as ve,I as kt,z as Dt,D as je,H as Ke,f as le,ac as $t,ah as Lt,ai as Ft,aj as Ne,X as ze,M as Tt}from"./index-DIxCcwTo.js";import{D as Mt,a as Bt,d as It,c as Kt,e as zt}from"./dialog-YYEI7PMn.js";import{C as Ve,P as Vt}from"./PriceDisplay-_QDTrlZ3.js";import{S as Wt}from"./SEO-DRdgyEjE.js";import{T as we}from"./target-9ZHqqCJy.js";import{P as Z}from"./plus-CBbazF2H.js";import{T as Gt}from"./trending-down-DBiRQaEc.js";import{f as Y,p as J,i as oe,D as Ht,L as Ce,A as qt,h as ce,j as Ut,m as Yt,G as Xt,g as We,y as Qt,c as Ge,t as Zt,v as Jt,R as Pe,C as He,X as qe,Y as Ue,T as Ae,B as er,q as tr,x as rr}from"./generateCategoricalChart-pUYUcWZP.js";import{B as ar}from"./BarChart-DHu18tOy.js";import{L as sr,a as nr}from"./LineChart-DBurkn6R.js";import{b as ir,P as rt,a as at}from"./PolarAngleAxis-Dkv-HGlv.js";import{F as lr}from"./filter-CcvaBCEE.js";import{P as Ye}from"./package-GtKN0b3_.js";var or=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function ee(s){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(s)}function cr(s,t){if(s==null)return{};var n=dr(s,t),a,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);for(i=0;i<l.length;i++)a=l[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(s,a)&&(n[a]=s[a])}return n}function dr(s,t){if(s==null)return{};var n={};for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a)){if(t.indexOf(a)>=0)continue;n[a]=s[a]}return n}function K(){return K=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(s[a]=n[a])}return s},K.apply(this,arguments)}function Xe(s,t){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),n.push.apply(n,a)}return n}function te(s){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Xe(Object(n),!0).forEach(function(a){mr(s,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(n,a))})}return s}function mr(s,t,n){return t=gr(t),t in s?Object.defineProperty(s,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[t]=n,s}function gr(s){var t=ur(s,"string");return ee(t)=="symbol"?t:t+""}function ur(s,t){if(ee(s)!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var a=n.call(s,t);if(ee(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var xr=function(t,n,a,i){var l="";return i.forEach(function(m,u){var p=J(n,a,t,m);u?l+="L ".concat(p.x,",").concat(p.y):l+="M ".concat(p.x,",").concat(p.y)}),l+="Z",l},hr=function(t){var n=t.cx,a=t.cy,i=t.innerRadius,l=t.outerRadius,m=t.polarAngles,u=t.radialLines;if(!m||!m.length||!u)return null;var p=te({stroke:"#ccc"},Y(t,!1));return P.createElement("g",{className:"recharts-polar-grid-angle"},m.map(function(y){var v=J(n,a,i,y),w=J(n,a,l,y);return P.createElement("line",K({},p,{key:"line-".concat(y),x1:v.x,y1:v.y,x2:w.x,y2:w.y}))}))},fr=function(t){var n=t.cx,a=t.cy,i=t.radius,l=t.index,m=te(te({stroke:"#ccc"},Y(t,!1)),{},{fill:"none"});return P.createElement("circle",K({},m,{className:de("recharts-polar-grid-concentric-circle",t.className),key:"circle-".concat(l),cx:n,cy:a,r:i}))},pr=function(t){var n=t.radius,a=t.index,i=te(te({stroke:"#ccc"},Y(t,!1)),{},{fill:"none"});return P.createElement("path",K({},i,{className:de("recharts-polar-grid-concentric-polygon",t.className),key:"path-".concat(a),d:xr(n,t.cx,t.cy,t.polarAngles)}))},br=function(t){var n=t.polarRadius,a=t.gridType;return!n||!n.length?null:P.createElement("g",{className:"recharts-polar-grid-concentric"},n.map(function(i,l){var m=l;return a==="circle"?P.createElement(fr,K({key:m},t,{radius:i,index:l})):P.createElement(pr,K({key:m},t,{radius:i,index:l}))}))},st=function(t){var n=t.cx,a=n===void 0?0:n,i=t.cy,l=i===void 0?0:i,m=t.innerRadius,u=m===void 0?0:m,p=t.outerRadius,y=p===void 0?0:p,v=t.gridType,w=v===void 0?"polygon":v,j=t.radialLines,A=j===void 0?!0:j,_=cr(t,or);return y<=0?null:P.createElement("g",{className:"recharts-polar-grid"},P.createElement(hr,K({cx:a,cy:l,innerRadius:u,outerRadius:y,gridType:w,radialLines:A},_)),P.createElement(br,K({cx:a,cy:l,innerRadius:u,outerRadius:y,gridType:w,radialLines:A},_)))};st.displayName="PolarGrid";var Se,Qe;function yr(){if(Qe)return Se;Qe=1;function s(t){return t&&t.length?t[0]:void 0}return Se=s,Se}var _e,Ze;function vr(){return Ze||(Ze=1,_e=yr()),_e}var jr=vr();const Nr=vt(jr);var wr=["key"];function X(s){"@babel/helpers - typeof";return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(s)}function Cr(s,t){if(s==null)return{};var n=Pr(s,t),a,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);for(i=0;i<l.length;i++)a=l[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(s,a)&&(n[a]=s[a])}return n}function Pr(s,t){if(s==null)return{};var n={};for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a)){if(t.indexOf(a)>=0)continue;n[a]=s[a]}return n}function me(){return me=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(s[a]=n[a])}return s},me.apply(this,arguments)}function Je(s,t){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),n.push.apply(n,a)}return n}function D(s){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Je(Object(n),!0).forEach(function(a){I(s,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(n,a))})}return s}function Ar(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function et(s,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(s,it(a.key),a)}}function Sr(s,t,n){return t&&et(s.prototype,t),n&&et(s,n),Object.defineProperty(s,"prototype",{writable:!1}),s}function _r(s,t,n){return t=ge(t),Or(s,nt()?Reflect.construct(t,n||[],ge(s).constructor):t.apply(s,n))}function Or(s,t){if(t&&(X(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rr(s)}function Rr(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function nt(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nt=function(){return!!s})()}function ge(s){return ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ge(s)}function Er(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&Oe(s,t)}function Oe(s,t){return Oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,i){return a.__proto__=i,a},Oe(s,t)}function I(s,t,n){return t=it(t),t in s?Object.defineProperty(s,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[t]=n,s}function it(s){var t=kr(s,"string");return X(t)=="symbol"?t:t+""}function kr(s,t){if(X(s)!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var a=n.call(s,t);if(X(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var re=(function(s){function t(){var n;Ar(this,t);for(var a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];return n=_r(this,t,[].concat(i)),I(n,"state",{isAnimationFinished:!1}),I(n,"handleAnimationEnd",function(){var m=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),oe(m)&&m()}),I(n,"handleAnimationStart",function(){var m=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),oe(m)&&m()}),I(n,"handleMouseEnter",function(m){var u=n.props.onMouseEnter;u&&u(n.props,m)}),I(n,"handleMouseLeave",function(m){var u=n.props.onMouseLeave;u&&u(n.props,m)}),n}return Er(t,s),Sr(t,[{key:"renderDots",value:function(a){var i=this.props,l=i.dot,m=i.dataKey,u=Y(this.props,!1),p=Y(l,!0),y=a.map(function(v,w){var j=D(D(D({key:"dot-".concat(w),r:3},u),p),{},{dataKey:m,cx:v.x,cy:v.y,index:w,payload:v});return t.renderDotItem(l,j)});return P.createElement(Ce,{className:"recharts-radar-dots"},y)}},{key:"renderPolygonStatically",value:function(a){var i=this.props,l=i.shape,m=i.dot,u=i.isRange,p=i.baseLinePoints,y=i.connectNulls,v;return P.isValidElement(l)?v=P.cloneElement(l,D(D({},this.props),{},{points:a})):oe(l)?v=l(D(D({},this.props),{},{points:a})):v=P.createElement(ir,me({},Y(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:a,baseLinePoints:u?p:null,connectNulls:y})),P.createElement(Ce,{className:"recharts-radar-polygon"},v,m?this.renderDots(a):null)}},{key:"renderPolygonWithAnimation",value:function(){var a=this,i=this.props,l=i.points,m=i.isAnimationActive,u=i.animationBegin,p=i.animationDuration,y=i.animationEasing,v=i.animationId,w=this.state.prevPoints;return P.createElement(qt,{begin:u,duration:p,isActive:m,easing:y,from:{t:0},to:{t:1},key:"radar-".concat(v),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var A=j.t,_=w&&w.length/l.length,$=l.map(function(S,L){var C=w&&w[Math.floor(L*_)];if(C){var N=ce(C.x,S.x),Q=ce(C.y,S.y);return D(D({},S),{},{x:N(A),y:Q(A)})}var ae=ce(S.cx,S.x),xe=ce(S.cy,S.y);return D(D({},S),{},{x:ae(A),y:xe(A)})});return a.renderPolygonStatically($)})}},{key:"renderPolygon",value:function(){var a=this.props,i=a.points,l=a.isAnimationActive,m=a.isRange,u=this.state.prevPoints;return l&&i&&i.length&&!m&&(!u||!Ut(u,i))?this.renderPolygonWithAnimation():this.renderPolygonStatically(i)}},{key:"render",value:function(){var a=this.props,i=a.hide,l=a.className,m=a.points,u=a.isAnimationActive;if(i||!m||!m.length)return null;var p=this.state.isAnimationFinished,y=de("recharts-radar",l);return P.createElement(Ce,{className:y},this.renderPolygon(),(!u||p)&&Yt.renderCallByParent(this.props,m))}}],[{key:"getDerivedStateFromProps",value:function(a,i){return a.animationId!==i.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,prevPoints:i.curPoints}:a.points!==i.curPoints?{curPoints:a.points}:null}},{key:"renderDotItem",value:function(a,i){var l;if(P.isValidElement(a))l=P.cloneElement(a,i);else if(oe(a))l=a(i);else{var m=i.key,u=Cr(i,wr);l=P.createElement(Ht,me({},u,{key:m,className:de("recharts-radar-dot",typeof a!="boolean"?a.className:"")}))}return l}}])})(b.PureComponent);I(re,"displayName","Radar");I(re,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!Xt.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});I(re,"getComposedData",function(s){var t=s.radiusAxis,n=s.angleAxis,a=s.displayedData,i=s.dataKey,l=s.bandSize,m=n.cx,u=n.cy,p=!1,y=[],v=n.type!=="number"?l??0:0;a.forEach(function(j,A){var _=We(j,n.dataKey,A),$=We(j,i),S=n.scale(_)+v,L=Array.isArray($)?Qt($):$,C=Ge(L)?void 0:t.scale(L);Array.isArray($)&&$.length>=2&&(p=!0),y.push(D(D({},J(m,u,C,S)),{},{name:_,value:$,cx:m,cy:u,radius:C,angle:S,payload:j}))});var w=[];return p&&y.forEach(function(j){if(Array.isArray(j.value)){var A=Nr(j.value),_=Ge(A)?void 0:t.scale(A);w.push(D(D({},j),{},{radius:_},J(m,u,_,j.angle)))}else w.push(j)}),{points:y,isRange:p,baseLinePoints:w}});var Dr=Zt({chartName:"RadarChart",GraphicalChild:re,axisComponents:[{axisType:"angleAxis",AxisComp:rt},{axisType:"radiusAxis",AxisComp:at}],formatAxisMap:Jt,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),ue="Collapsible",[$r]=Nt(ue),[Lr,Ee]=$r(ue),lt=b.forwardRef((s,t)=>{const{__scopeCollapsible:n,open:a,defaultOpen:i,disabled:l,onOpenChange:m,...u}=s,[p,y]=jt({prop:a,defaultProp:i??!1,onChange:m,caller:ue});return e.jsx(Lr,{scope:n,disabled:l,contentId:wt(),open:p,onOpenToggle:b.useCallback(()=>y(v=>!v),[y]),children:e.jsx(Re.div,{"data-state":De(p),"data-disabled":l?"":void 0,...u,ref:t})})});lt.displayName=ue;var ot="CollapsibleTrigger",ct=b.forwardRef((s,t)=>{const{__scopeCollapsible:n,...a}=s,i=Ee(ot,n);return e.jsx(Re.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":De(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...a,ref:t,onClick:Ct(s.onClick,i.onOpenToggle)})});ct.displayName=ot;var ke="CollapsibleContent",dt=b.forwardRef((s,t)=>{const{forceMount:n,...a}=s,i=Ee(ke,s.__scopeCollapsible);return e.jsx(Pt,{present:n||i.open,children:({present:l})=>e.jsx(Fr,{...a,ref:t,present:l})})});dt.displayName=ke;var Fr=b.forwardRef((s,t)=>{const{__scopeCollapsible:n,present:a,children:i,...l}=s,m=Ee(ke,n),[u,p]=b.useState(a),y=b.useRef(null),v=At(t,y),w=b.useRef(0),j=w.current,A=b.useRef(0),_=A.current,$=m.open||u,S=b.useRef($),L=b.useRef(void 0);return b.useEffect(()=>{const C=requestAnimationFrame(()=>S.current=!1);return()=>cancelAnimationFrame(C)},[]),St(()=>{const C=y.current;if(C){L.current=L.current||{transitionDuration:C.style.transitionDuration,animationName:C.style.animationName},C.style.transitionDuration="0s",C.style.animationName="none";const N=C.getBoundingClientRect();w.current=N.height,A.current=N.width,S.current||(C.style.transitionDuration=L.current.transitionDuration,C.style.animationName=L.current.animationName),p(a)}},[m.open,a]),e.jsx(Re.div,{"data-state":De(m.open),"data-disabled":m.disabled?"":void 0,id:m.contentId,hidden:!$,...l,ref:v,style:{"--radix-collapsible-content-height":j?`${j}px`:void 0,"--radix-collapsible-content-width":_?`${_}px`:void 0,...s.style},children:$&&i})});function De(s){return s?"open":"closed"}var Tr=lt;const Mr=Tr,Br=ct,Ir=dt,tt={Electronics:["Laptops","Smartphones","Tablets","Cameras","Audio","Gaming","Accessories"],Fashion:["Men","Women","Kids","Shoes","Accessories","Jewelry"],"Home & Garden":["Furniture","Kitchen","Decor","Garden","Tools","Appliances"],Vehicles:["Cars","Motorcycles","Bicycles","Parts","Accessories"],Sports:["Fitness","Outdoor","Team Sports","Water Sports","Cycling"],Books:["Fiction","Non-Fiction","Academic","Children","Textbooks"],Beauty:["Skincare","Makeup","Haircare","Fragrances","Wellness"],Toys:["Educational","Action Figures","Dolls","Puzzles","Outdoor"],Jewelry:["Rings","Necklaces","Earrings","Watches","Bracelets"],Health:["Supplements","Fitness","Medical","Personal Care","Wellness"],Food:["Groceries","Beverages","Snacks","Organic","Local"],Pets:["Dogs","Cats","Fish","Birds","Supplies"],Office:["Stationery","Furniture","Electronics","Supplies"],"Art & Crafts":["Painting","Drawing","Craft Supplies","Fabric","DIY"],Music:["Instruments","Records","Equipment","Accessories"],"Baby & Kids":["Clothing","Toys","Furniture","Safety","Feeding"],Travel:["Luggage","Accessories","Outdoor","Camping"],Industrial:["Tools","Equipment","Materials","Safety"],Collectibles:["Coins","Stamps","Art","Memorabilia","Antiques"]},H={green:"#00A650",blue:"#0077BE",purple:"#8B5CF6",orange:"#FF6B35"},V=[H.green,H.blue,H.purple,H.orange];function ta({initialProductIds:s=[]}){const[t,n]=b.useState([]),[a,i]=b.useState(""),[l,m]=b.useState("All"),[u,p]=b.useState("All"),[y,v]=b.useState([]),[w,j]=b.useState(!1),[A,_]=b.useState(!0),[$,S]=b.useState(!1),[L,C]=b.useState(new Set),[N,Q]=b.useState([]),[ae,xe]=b.useState(new Set),[x,q]=b.useState({category:null,subcategory:null}),[he,mt]=b.useState(!1),[se,gt]=b.useState("specs");b.useEffect(()=>{$e(),ut()},[]);const ut=async()=>{try{const{data:{user:r}}=await W.auth.getUser();if(!r)return;const{data:o,error:g}=await W.from("favorites").select("product_id").eq("user_id",r.id);if(g){console.error("Error loading favorites:",g);return}const c=new Set(o?.map(d=>d.product_id)||[]);C(c)}catch(r){console.error("Error loading favorites:",r)}},$e=async()=>{try{_(!0),console.log("ðŸ” Loading available products for comparison...");const{data:r,error:o}=await W.from("products").select(`
          id,
          name,
          description,
          price,
          original_price,
          category,
          subcategory,
          condition,
          location,
          images,
          properties,
          status,
          verified,
          featured,
          is_urgent,
          is_negotiable,
          created_at,
          user_id,
          owner_id,
          profiles:user_id (
            id,
            full_name,
            avatar_url,
            rating,
            total_ratings,
            location
          )
        `).in("status",["active","approved"]).order("created_at",{ascending:!1}).limit(50);if(o){console.error("âŒ Error loading products:",o),E.error("Failed to load products"),Q([]);return}console.log("âœ… Products loaded successfully:",r?.length);const g=(r||[]).map(c=>({id:c.id,name:c.name,description:c.description,price:c.price,original_price:c.original_price,category:c.category,subcategory:c.subcategory,condition:c.condition,location:c.location,images:c.images||[],verified:c.verified||!1,featured:c.featured||!1,is_urgent:c.is_urgent||!1,is_negotiable:c.is_negotiable||!1,created_at:c.created_at,status:c.status,user_id:c.user_id,owner_id:c.owner_id,profiles:c.profiles?{id:c.profiles.id,full_name:c.profiles.full_name,avatar_url:c.profiles.avatar_url,rating:c.profiles.rating,total_ratings:c.profiles.total_ratings,location:c.profiles.location}:null,properties:c.properties||{}}));if(Q(g),s.length>0){const c=g.filter(d=>s.includes(d.id));if(n(c),console.log("ðŸŽ¯ Loaded initial products:",c.length),c.length>0){const d=c[0];q({category:d.category,subcategory:d.subcategory})}}else if(g.length>=2&&t.length===0){const c=g.slice(0,2);if(n(c),c.length>0){const d=c[0];q({category:d.category,subcategory:d.subcategory})}console.log("ðŸ¤– Auto-selected products for comparison:",c.map(d=>d.name)),E.success(`Added ${c.length} products for comparison`)}else g.length===1&&t.length===0&&(n([g[0]]),q({category:g[0].category,subcategory:g[0].subcategory}),console.log("ðŸ¤– Auto-selected single product:",g[0].name),E.success("Added product for comparison"))}catch(r){console.error("ðŸ’¥ Error loading products:",r),E.error("Failed to load products"),Q([])}finally{_(!1)}},U=async(r,o="All",g="All")=>{i(r),m(o),p(g);const c=x.category&&o==="All"?x.category:o,d=x.subcategory&&g==="All"?x.subcategory:g;if(r.trim()===""&&c==="All"&&d==="All"){v(N.slice(0,12));return}try{S(!0);let h=W.from("products").select(`
          id,
          name,
          description,
          price,
          original_price,
          category,
          subcategory,
          condition,
          location,
          images,
          properties,
          status,
          verified,
          featured,
          is_urgent,
          is_negotiable,
          created_at,
          user_id,
          owner_id,
          profiles:user_id (
            id,
            full_name,
            avatar_url,
            rating,
            total_ratings,
            location
          )
        `).in("status",["active","approved"]);r.trim()&&(h=h.or(`name.ilike.%${r}%,category.ilike.%${r}%,subcategory.ilike.%${r}%,description.ilike.%${r}%`)),c!=="All"&&(h=h.eq("category",c)),d!=="All"&&c!=="All"&&(h=h.eq("subcategory",d)),h=h.limit(20);const{data:O,error:T}=await h;if(T){console.error("Search error, using client-side filtering:",T);const f=N.filter(R=>{const pt=!r.trim()||R.name.toLowerCase().includes(r.toLowerCase())||R.category?.toLowerCase().includes(r.toLowerCase())||R.subcategory?.toLowerCase().includes(r.toLowerCase())||R.description?.toLowerCase().includes(r.toLowerCase()),bt=c==="All"||R.category===c,yt=d==="All"||R.subcategory===d;return pt&&bt&&yt});v(f);return}const B=(O||[]).map(f=>({id:f.id,name:f.name,description:f.description,price:f.price,original_price:f.original_price,category:f.category,subcategory:f.subcategory,condition:f.condition,location:f.location,images:f.images||[],verified:f.verified||!1,featured:f.featured||!1,is_urgent:f.is_urgent||!1,is_negotiable:f.is_negotiable||!1,created_at:f.created_at,status:f.status,user_id:f.user_id,owner_id:f.owner_id,profiles:f.profiles?{id:f.profiles.id,full_name:f.profiles.full_name,avatar_url:f.profiles.avatar_url,rating:f.profiles.rating,total_ratings:f.profiles.total_ratings,location:f.profiles.location}:null,properties:f.properties||{}}));v(B)}catch(h){console.error("Error searching products:",h);const O=N.filter(T=>{const B=!a.trim()||T.name.toLowerCase().includes(a.toLowerCase())||T.category?.toLowerCase().includes(a.toLowerCase())||T.subcategory?.toLowerCase().includes(a.toLowerCase())||T.description?.toLowerCase().includes(a.toLowerCase()),f=c==="All"||T.category===c,R=d==="All"||T.subcategory===d;return B&&f&&R});v(O)}finally{S(!1)}},Le=async(r,o)=>{o?.stopPropagation();try{const{data:{user:g}}=await W.auth.getUser();if(!g){E.error("Please sign in to add favorites");return}if(L.has(r)){const{error:c}=await W.from("favorites").delete().eq("product_id",r).eq("user_id",g.id);if(c)throw c;C(d=>{const h=new Set(d);return h.delete(r),h}),E.success("Removed from favorites")}else{const{error:c}=await W.from("favorites").insert({product_id:r,user_id:g.id});if(c)throw c;C(d=>new Set(d).add(r)),E.success("Added to favorites")}}catch(g){console.error("Error toggling favorite:",g),E.error("Failed to update favorites")}},xt=r=>{n(o=>{const g=o.filter(c=>c.id!==r);return g.length===0&&q({category:null,subcategory:null}),g}),E.success("Product removed from comparison")},ht=r=>{if(t.length>=4){E.error("Maximum 4 products can be compared");return}if(t.find(o=>o.id===r.id)){E.error("Product already in comparison");return}if(t.length===0)q({category:r.category,subcategory:r.subcategory}),E.success(`Now comparing ${r.subcategory||r.category} products`);else if(!(r.category===x.category&&r.subcategory===x.subcategory)){E.error(`Please select ${x.subcategory||x.category} products for comparison`);return}n(o=>[...o,r]),j(!1),i(""),m("All"),p("All"),E.success("Product added to comparison")},Fe=r=>{const o=r?.toLowerCase();return o.includes("new")?"bg-green-100 text-green-800 border-green-200":o.includes("like new")||o.includes("excellent")?"bg-blue-100 text-blue-800 border-blue-200":o.includes("refurbished")?"bg-purple-100 text-purple-800 border-purple-200":o.includes("used")||o.includes("good")?"bg-orange-100 text-orange-800 border-orange-200":"bg-gray-100 text-gray-800 border-gray-200"},Te=()=>{const r=new Set;return t.forEach(o=>{o.properties&&typeof o.properties=="object"&&Object.keys(o.properties).forEach(g=>{o.properties[g]!==null&&o.properties[g]!==void 0&&r.add(g)})}),Array.from(r)},ne=r=>`KES ${r.toLocaleString()}`,fe=r=>!r?.rating||!r?.total_ratings?null:{rating:r.rating,totalRatings:r.total_ratings},ft=r=>{xe(o=>{const g=new Set(o);return g.has(r)?g.delete(r):g.add(r),g})},pe=["All",...new Set(N.map(r=>r.category).filter(Boolean))];l!=="All"&&[...tt[l]||[]],b.useEffect(()=>{w&&(x.category?(m(x.category),x.subcategory&&p(x.subcategory),U(a,x.category,x.subcategory||"All")):v(N.slice(0,12)))},[w,N]),b.useEffect(()=>{l==="All"&&p("All")},[l]);const Me=()=>{n([]),q({category:null,subcategory:null}),E.success("Comparison cleared")},F=(()=>{if(t.length<2)return null;const r=t.map((d,h)=>({name:d.name.substring(0,15)+(d.name.length>15?"...":""),price:d.price,originalPrice:d.original_price||d.price,savings:d.original_price?d.original_price-d.price:0,color:V[h%V.length]})),o=t.map((d,h)=>({name:d.name.substring(0,15)+(d.name.length>15?"...":""),rating:d.profiles?.rating||0,totalRatings:d.profiles?.total_ratings||0,color:V[h%V.length]})),g=t.map((d,h)=>{const O=d.profiles?.rating||1,T=d.price/O,B=Math.max(...t.map(R=>R.price)),f=Math.max(0,100-T/(B/100));return{name:d.name.substring(0,15)+(d.name.length>15?"...":""),valueScore:Math.min(100,f),price:d.price,rating:O,color:V[h%V.length]}}),c=["Price","Rating","Condition","Value","Popularity"].map(d=>{const h={subject:d};return t.forEach((O,T)=>{let B=0;switch(d){case"Price":B=Math.max(0,100-O.price/(Math.max(...t.map(R=>R.price))/100));break;case"Rating":B=(O.profiles?.rating||0)*20;break;case"Condition":B=O.condition.includes("new")?100:O.condition.includes("excellent")?80:O.condition.includes("good")?60:40;break;case"Value":const f=O.profiles?.rating||1;B=Math.max(0,100-O.price/f/(Math.max(...t.map(R=>R.price/(R.profiles?.rating||1)))/100));break;case"Popularity":B=Math.min(100,(O.profiles?.total_ratings||0)*2);break}h[`product${T}`]=Math.round(B)}),h});return{priceComparison:r,ratingComparison:o,valueAnalysis:g,radarData:c,bestValue:g.reduce((d,h)=>h.valueScore>d.valueScore?h:d),cheapest:r.reduce((d,h)=>h.price<d.price?h:d),highestRated:o.reduce((d,h)=>h.rating>d.rating?h:d)}})();return A?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-green-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(be,{className:"h-10 w-10 text-white animate-spin"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2 bg-gradient-to-r from-green-600 to-emerald-700 bg-clip-text text-transparent",children:"Loading Products..."}),e.jsx("p",{className:"text-muted-foreground",children:"Preparing your comparison experience"})]})}):e.jsxs(e.Fragment,{children:[e.jsx(Wt,{title:"Compare Prices | Kenya's Premium Marketplace",description:"Compare product prices and find the best deals, analyze value, and check seller ratings on SellHub Kenya.",keywords:"compare prices, price comparison kenya, best deals kenya, product comparison"}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-green-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-8 gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-xl",children:e.jsx(Be,{className:"w-6 h-6 text-green-600"})}),e.jsxs(k,{variant:"secondary",className:"bg-green-100 text-green-700 border-0",children:[e.jsx(ye,{className:"w-3 h-3 mr-1"}),"Smart Compare"]})]}),e.jsx("h1",{className:"text-3xl lg:text-4xl font-bold mb-2 bg-gradient-to-r from-green-600 to-emerald-700 bg-clip-text text-transparent",children:"Compare Products"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-2",children:"Smart side-by-side comparison with advanced analytics"}),N.length>0&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Found ",N.length," products across"," ",pe.length-1," categories"]}),x.category&&e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsxs(k,{variant:"secondary",className:"bg-blue-100 text-blue-700 text-sm",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Comparing:"," ",x.subcategory||x.category]}),t.length>0&&e.jsx(M,{variant:"outline",size:"sm",onClick:Me,className:"h-7 text-xs border-red-200 text-red-600 hover:bg-red-50",children:"Clear All"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[t.length>0&&e.jsxs(k,{variant:"secondary",className:"bg-green-100 text-green-700 text-sm",children:[t.length,"/4 Products"]}),t.length>=2&&e.jsxs(M,{onClick:()=>mt(!he),variant:"outline",className:"flex items-center gap-2 border-blue-200 text-blue-600 hover:bg-blue-50",children:[e.jsx(Ie,{className:"h-4 w-4"}),he?"Hide Analytics":"Show Analytics"]}),e.jsxs(M,{onClick:()=>j(!0),disabled:t.length>=4,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-500/25",children:[e.jsx(Z,{className:"h-4 w-4"}),"Add Product"]}),e.jsxs(M,{onClick:$e,variant:"outline",className:"flex items-center gap-2 border-green-200 text-green-600 hover:bg-green-50",children:[e.jsx(be,{className:"h-4 w-4"}),"Refresh"]})]})]}),he&&F&&e.jsx("div",{className:"mb-8 space-y-6",children:e.jsx(z,{className:"border-0 shadow-xl bg-gradient-to-br from-white to-blue-50",children:e.jsxs(G,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ie,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Comparison Analytics"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-100 rounded-2xl p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(_t,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"font-semibold text-green-700",children:"Best Value"})]}),e.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:F.bestValue.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ot,{value:F.bestValue.valueScore,className:"h-2 bg-green-200"}),e.jsxs("span",{className:"text-sm font-medium text-green-600",children:[F.bestValue.valueScore.toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-100 rounded-2xl p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Rt,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"font-semibold text-blue-700",children:"Lowest Price"})]}),e.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:F.cheapest.name}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:ne(F.cheapest.price)}),e.jsx(Ve,{kesAmount:F.cheapest.price})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-100 rounded-2xl p-4 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Et,{className:"h-5 w-5 text-purple-600"}),e.jsx("span",{className:"font-semibold text-purple-700",children:"Highest Rated"})]}),e.jsx("p",{className:"text-xl font-bold text-gray-900 mb-1",children:F.highestRated.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-lg font-semibold text-purple-600",children:F.highestRated.rating.toFixed(1)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-200 shadow-sm",children:[e.jsxs("h3",{className:"font-semibold mb-4 text-gray-900 flex items-center gap-2",children:[e.jsx(Gt,{className:"h-4 w-4 text-green-600"}),"Price Comparison"]}),e.jsx(Pe,{width:"100%",height:200,children:e.jsxs(ar,{data:F.priceComparison,children:[e.jsx(He,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(qe,{dataKey:"name",fontSize:12}),e.jsx(Ue,{fontSize:12,tickFormatter:r=>`KES ${r/1e3}k`}),e.jsx(Ae,{formatter:r=>[`KES ${r.toLocaleString()}`,"Price"],labelFormatter:r=>`Product: ${r}`}),e.jsx(er,{dataKey:"price",radius:[4,4,0,0],children:F.priceComparison.map((r,o)=>e.jsx(tr,{fill:r.color},`cell-${o}`))})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-200 shadow-sm",children:[e.jsxs("h3",{className:"font-semibold mb-4 text-gray-900 flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600"}),"Value Score Analysis"]}),e.jsx(Pe,{width:"100%",height:200,children:e.jsxs(sr,{data:F.valueAnalysis,children:[e.jsx(He,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(qe,{dataKey:"name",fontSize:12}),e.jsx(Ue,{fontSize:12,domain:[0,100]}),e.jsx(Ae,{formatter:r=>[`${r.toFixed(1)}%`,"Value Score"],labelFormatter:r=>`Product: ${r}`}),e.jsx(nr,{type:"monotone",dataKey:"valueScore",stroke:H.blue,strokeWidth:3,dot:{fill:H.blue,strokeWidth:2,r:4},activeDot:{r:6,fill:H.green}})]})})]})]}),e.jsxs("div",{className:"mt-6 bg-white rounded-2xl p-4 border border-gray-200 shadow-sm",children:[e.jsxs("h3",{className:"font-semibold mb-4 text-gray-900 flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4 text-purple-600"}),"Product Comparison Radar"]}),e.jsx(Pe,{width:"100%",height:300,children:e.jsxs(Dr,{data:F.radarData,children:[e.jsx(st,{}),e.jsx(rt,{dataKey:"subject"}),e.jsx(at,{domain:[0,100]}),t.map((r,o)=>e.jsx(re,{name:`Product ${o+1}`,dataKey:`product${o}`,stroke:V[o],fill:V[o],fillOpacity:.2},o)),e.jsx(rr,{}),e.jsx(Ae,{})]})})]})]})})}),e.jsx(Mt,{open:w,onOpenChange:j,children:e.jsxs(Bt,{className:"max-w-7xl max-h-[90vh] overflow-hidden border-0 shadow-2xl rounded-3xl",children:[e.jsxs(It,{className:"pb-4",children:[e.jsxs(Kt,{className:"flex items-center gap-3 text-2xl",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(ve,{className:"h-6 w-6 text-green-600"})}),x.category?`Compare ${x.subcategory||x.category}`:"Smart Product Search"]}),e.jsx(zt,{className:"text-base",children:x.category?`Select similar ${x.subcategory||x.category} products for meaningful comparison`:N.length===0?"No products available yet. Add some products to your marketplace first.":`Smart search across ${N.length} products with category filtering`})]}),e.jsxs("div",{className:"flex gap-6 h-[600px]",children:[e.jsx("div",{className:"w-80 flex-shrink-0 bg-gradient-to-b from-gray-50 to-white rounded-2xl p-4 border border-gray-200",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(kt,{placeholder:"Search products...",value:a,onChange:r=>U(r.target.value,l,u),className:"pl-10 border-2 border-gray-200 focus:border-green-500 rounded-xl"})]}),x.category&&e.jsxs("div",{className:"p-3 bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl",children:[e.jsxs("p",{className:"text-sm text-blue-800 font-medium flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Comparison Focus"]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:x.subcategory||x.category})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-semibold text-sm flex items-center gap-2 text-gray-700",children:[e.jsx(lr,{className:"h-4 w-4"}),"Smart Filters"]}),e.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-xl cursor-pointer transition-all ${l==="All"?"bg-green-100 text-green-700 border-2 border-green-200 shadow-sm":"hover:bg-gray-100 border-2 border-transparent"}`,onClick:()=>U(a,"All","All"),children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-current"}),e.jsx("span",{className:"text-sm font-medium",children:"All Categories"}),e.jsx(k,{variant:"secondary",className:"ml-auto bg-green-100 text-green-700",children:N.length})]}),pe.filter(r=>r!=="All").map(r=>e.jsxs(Mr,{open:ae.has(r),children:[e.jsx(Br,{className:"w-full",onClick:()=>ft(r),children:e.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-xl cursor-pointer transition-all ${l===r?"bg-blue-100 text-blue-700 border-2 border-blue-200 shadow-sm":"hover:bg-gray-100 border-2 border-transparent"}`,children:[e.jsx(Dt,{className:`h-4 w-4 transition-transform ${ae.has(r)?"rotate-0":"-rotate-90"}`}),e.jsx("span",{className:"text-sm font-medium",children:r}),e.jsx(k,{variant:"secondary",className:"ml-auto bg-blue-100 text-blue-700",children:N.filter(o=>o.category===r).length})]})}),e.jsx(Ir,{children:e.jsxs("div",{className:"ml-6 space-y-1 mt-1",children:[e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg cursor-pointer text-xs ${l===r&&u==="All"?"bg-blue-100 text-blue-700 border border-blue-200":"hover:bg-gray-100"}`,onClick:()=>U(a,r,"All"),children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-current"}),"All ",r,e.jsx(k,{variant:"outline",className:"ml-auto text-xs",children:N.filter(o=>o.category===r).length})]}),tt[r]?.map(o=>{const g=N.filter(c=>c.category===r&&c.subcategory===o).length;return g===0?null:e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg cursor-pointer text-xs ${l===r&&u===o?"bg-blue-100 text-blue-700 border border-blue-200":"hover:bg-gray-100"}`,onClick:()=>U(a,r,o),children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-current"}),o,e.jsx(k,{variant:"outline",className:"ml-auto text-xs",children:g})]},o)})]})})]},r))]})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-4",children:[e.jsxs("span",{children:["Showing ",y.length," products",a&&` for "${a}"`,l!=="All"&&` in ${l}`,u!=="All"&&` > ${u}`,x.category&&" (Filtered for comparison)"]}),e.jsxs("span",{children:[t.length,"/4 selected"]})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto pr-2",children:$?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(be,{className:"h-8 w-8 animate-spin text-green-600"})}):y.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:y.map(r=>{const o=fe(r.profiles),g=L.has(r.id),c=t.some(h=>h.id===r.id),d=!x.category||r.category===x.category&&r.subcategory===x.subcategory;return e.jsx(z,{className:`cursor-pointer transition-all border-2 group overflow-hidden ${c?"border-green-500 bg-green-50 shadow-lg scale-[0.98]":!d&&x.category?"border-orange-300 bg-orange-50 opacity-70":"border-gray-200 hover:border-green-300 hover:bg-green-50 hover:shadow-md"}`,onClick:()=>ht(r),children:e.jsxs("div",{className:"p-4",children:[!d&&x.category&&e.jsxs("div",{className:"mb-2 p-2 bg-orange-100 border border-orange-200 rounded-lg text-xs text-orange-800 flex items-center gap-2",children:[e.jsx(je,{className:"h-3 w-3"}),"Different category than current comparison"]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[r.images&&r.images.length>0?e.jsx("img",{src:r.images[0],alt:r.name,className:"w-16 h-16 object-cover rounded-xl border border-gray-200"}):e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-gray-100 to-gray-200 rounded-xl flex items-center justify-center",children:e.jsx(Ye,{className:"h-6 w-6 text-gray-400"})}),e.jsx(M,{size:"icon",variant:"secondary",className:"absolute -top-1 -right-1 h-6 w-6 opacity-0 group-hover:opacity-100 transition-all bg-white/80 backdrop-blur-sm border shadow-sm",onClick:h=>{h.stopPropagation(),Le(r.id,h)},children:e.jsx(Ke,{className:`h-3 w-3 transition-all ${g?"fill-red-500 text-red-500":"text-gray-600"}`})})]}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 leading-tight text-gray-900",children:r.name}),e.jsxs("div",{className:"mt-1",children:[e.jsx("p",{className:"text-lg font-bold text-green-600",children:ne(r.price)}),e.jsx(Ve,{kesAmount:r.price})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(k,{variant:"outline",className:Fe(r.condition),children:r.condition}),r.category&&e.jsx(k,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-700",children:r.category}),r.subcategory&&e.jsx(k,{variant:"outline",className:"text-xs",children:r.subcategory})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[o&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-medium",children:o.rating.toFixed(1)}),e.jsxs("span",{children:["(",o.totalRatings,")"]})]}),r.verified&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(le,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Verified"})]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:c?e.jsxs("div",{className:"flex items-center gap-1 text-green-600 bg-green-100 px-2 py-1 rounded-full",children:[e.jsx($t,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs font-medium",children:"Added"})]}):!d&&x.category?e.jsxs("div",{className:"flex items-center gap-1 text-orange-600 bg-orange-100 px-2 py-1 rounded-full",children:[e.jsx(je,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs font-medium",children:"Different"})]}):e.jsxs("div",{className:"flex items-center gap-1 text-blue-600 bg-blue-100 px-2 py-1 rounded-full",children:[e.jsx(Z,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs font-medium",children:"Add"})]})})]})]})},r.id)})}):N.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(je,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No products available"}),e.jsx("p",{className:"text-sm mb-6",children:"Add some products to your marketplace first"}),e.jsx(M,{onClick:()=>window.location.href="/products/upload",size:"lg",className:"bg-green-600 hover:bg-green-700",children:"Add New Product"})]}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(ve,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No products found"}),e.jsx("p",{className:"text-sm",children:"No products found matching your criteria"}),e.jsx("p",{className:"text-sm mt-1",children:"Try different keywords or categories"}),e.jsx(M,{onClick:()=>{i(""),m("All"),p("All"),U("","All","All")},variant:"outline",className:"mt-4 border-green-200 text-green-600 hover:bg-green-50",children:"Clear Filters"})]})})]})]})]})}),t.length>=1?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold bg-gradient-to-r from-green-600 to-emerald-700 bg-clip-text text-transparent",children:["Comparing ",t.length," ",x.subcategory||x.category," ","Products"]}),e.jsx("p",{className:"text-muted-foreground",children:"Side-by-side comparison with detailed analytics"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Lt,{value:se,onValueChange:gt,className:"w-auto",children:e.jsxs(Ft,{className:"bg-gray-100 p-1 rounded-xl",children:[e.jsx(Ne,{value:"specs",className:"rounded-lg data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"Specifications"}),e.jsx(Ne,{value:"details",className:"rounded-lg data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"Details"}),e.jsx(Ne,{value:"sellers",className:"rounded-lg data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"Sellers"})]})}),e.jsxs(M,{variant:"outline",onClick:Me,className:"flex items-center gap-2 border-red-200 text-red-600 hover:bg-red-50",children:[e.jsx(ze,{className:"h-4 w-4"}),"Clear Comparison"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-[800px]",children:e.jsxs("div",{className:"grid gap-6",style:{gridTemplateColumns:`repeat(${Math.max(t.length,1)}, minmax(300px, 1fr))`},children:[t.map((r,o)=>{const g=fe(r.profiles),c=L.has(r.id);return e.jsxs(z,{className:"relative group hover:shadow-xl transition-all duration-300 border-0 shadow-lg overflow-hidden",children:[e.jsx(M,{variant:"ghost",size:"sm",className:"absolute top-3 right-3 z-10 opacity-0 group-hover:opacity-100 transition-all bg-white/80 backdrop-blur border shadow-sm",onClick:()=>xt(r.id),children:e.jsx(ze,{className:"h-4 w-4"})}),e.jsxs("div",{className:"relative",children:[r.images&&r.images.length>0?e.jsx("img",{src:r.images[0],alt:r.name,className:"w-full h-48 object-cover"}):e.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:e.jsx(Ye,{className:"h-12 w-12 text-gray-400"})}),e.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-1",children:[e.jsx(k,{className:`${Fe(r.condition)} border-0`,children:r.condition}),r.featured&&e.jsx(k,{className:"bg-yellow-500 text-white border-0 text-xs",children:"Featured"}),r.verified&&e.jsxs(k,{className:"bg-green-500 text-white border-0 text-xs",children:[e.jsx(le,{className:"h-3 w-3 mr-1"}),"Verified"]})]}),e.jsx(M,{size:"icon",variant:"secondary",className:"absolute top-3 right-12 opacity-0 group-hover:opacity-100 transition-all bg-white/80 backdrop-blur border shadow-sm",onClick:d=>Le(r.id,d),children:e.jsx(Ke,{className:`h-4 w-4 transition-all ${c?"fill-red-500 text-red-500":"text-gray-600"}`})})]}),e.jsxs(G,{className:"p-5",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 line-clamp-2 text-gray-900",children:r.name}),e.jsxs("div",{className:"flex items-center justify-between mb-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"capitalize font-medium",children:r.category}),r.subcategory&&e.jsxs("span",{className:"block text-xs text-green-600 font-semibold",children:["â€º ",r.subcategory]})]}),e.jsxs("span",{className:"flex items-center gap-1 bg-gray-100 px-2 py-1 rounded-full",children:[e.jsx(Tt,{className:"h-3 w-3"}),r.location]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g?e.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 px-3 py-2 rounded-xl",children:[e.jsx(ie,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-gray-900",children:g.rating.toFixed(1)}),e.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["(",g.totalRatings,")"]})]})]}):e.jsx("div",{className:"text-sm text-muted-foreground bg-gray-100 px-3 py-2 rounded-xl",children:"No ratings"}),r.profiles&&e.jsx(k,{variant:"secondary",className:"bg-green-100 text-green-700 text-xs",children:r.profiles.full_name||"Seller"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:ne(r.price)}),e.jsx("div",{className:"mt-1",children:e.jsx(Vt,{kesAmount:r.price})}),r.original_price&&r.original_price>r.price&&e.jsx("p",{className:"text-sm text-muted-foreground line-through",children:ne(r.original_price)})]}),r.is_negotiable&&e.jsx(k,{variant:"outline",className:"mb-4 text-xs bg-orange-50 text-orange-700 border-orange-200",children:"Price Negotiable"}),e.jsx(M,{className:"w-full bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-500/25",onClick:()=>window.open(`/product/${r.id}`,"_blank"),children:"View Details"})]})]},r.id)}),t.length<4&&e.jsx(z,{className:"border-dashed border-2 border-gray-300 flex items-center justify-center min-h-[400px] cursor-pointer hover:border-green-400 transition-all hover:bg-green-50 group",onClick:()=>j(!0),children:e.jsxs(G,{className:"text-center p-6",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-green-200 transition-colors",children:e.jsx(Z,{className:"h-8 w-8 text-green-600"})}),e.jsxs("p",{className:"text-gray-700 font-medium",children:["Add another"," ",x.subcategory||x.category," ","product"]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[4-t.length," slot(s) remaining"]})]})})]})})}),se==="specs"&&Te().length>0&&e.jsx(z,{className:"border-0 shadow-xl",children:e.jsxs(G,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Be,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-xl text-gray-900",children:"Specifications Comparison"})]}),e.jsx("div",{className:"space-y-3",children:Te().map(r=>e.jsxs("div",{className:"grid gap-4 items-center py-4 border-b border-gray-100 last:border-b-0 hover:bg-blue-50 transition-all rounded-xl px-4",style:{gridTemplateColumns:`200px repeat(${t.length}, 1fr)`},children:[e.jsxs("span",{className:"font-semibold capitalize text-sm text-gray-700",children:[r.replace(/_/g," "),":"]}),t.map((o,g)=>e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-900 bg-white px-3 py-2 rounded-lg border border-gray-200 inline-block min-w-[120px]",children:o.properties?.[r]?String(o.properties[r]):"-"})},o.id))]},r))})]})}),se==="details"&&e.jsx(z,{className:"border-0 shadow-xl",children:e.jsxs(G,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(ye,{className:"w-5 h-5 text-green-600"})}),e.jsx("h3",{className:"font-bold text-xl text-gray-900",children:"Detailed Comparison"})]}),e.jsx("div",{className:"grid gap-6",style:{gridTemplateColumns:`repeat(${t.length}, 1fr)`},children:t.map(r=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-lg text-gray-900 border-b border-gray-200 pb-2",children:r.name}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded-lg border border-gray-200",children:r.description||"No description available."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Key Features"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),"Condition: ",r.condition]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),"Location: ",r.location]}),r.is_negotiable&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),"Price is negotiable"]})]})]})]})]},r.id))})]})}),se==="sellers"&&e.jsx(z,{className:"border-0 shadow-xl",children:e.jsxs(G,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(le,{className:"w-5 h-5 text-purple-600"})}),e.jsx("h3",{className:"font-bold text-xl text-gray-900",children:"Seller Comparison"})]}),e.jsx("div",{className:"grid gap-6",style:{gridTemplateColumns:`repeat(${t.length}, 1fr)`},children:t.map(r=>{const o=fe(r.profiles);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[r.profiles?.avatar_url?e.jsx("img",{src:r.profiles.avatar_url,alt:r.profiles.full_name||"Seller",className:"w-16 h-16 rounded-full mx-auto mb-3 border-2 border-green-200"}):e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-100 to-green-200 rounded-full flex items-center justify-center mx-auto mb-3 border-2 border-green-200",children:e.jsx("span",{className:"text-lg font-semibold text-green-600",children:(r.profiles?.full_name||"S").charAt(0).toUpperCase()})}),e.jsx("h4",{className:"font-semibold text-gray-900",children:r.profiles?.full_name||"Seller"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.location})]}),e.jsxs("div",{className:"space-y-3",children:[o?e.jsxs("div",{className:"bg-blue-50 p-3 rounded-xl text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[e.jsx(ie,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-bold text-lg",children:o.rating.toFixed(1)})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[o.totalRatings," ratings"]})]}):e.jsx("div",{className:"bg-gray-100 p-3 rounded-xl text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No ratings yet"})}),r.verified&&e.jsxs("div",{className:"bg-green-50 p-3 rounded-xl text-center border border-green-200",children:[e.jsx(le,{className:"h-5 w-5 text-green-600 mx-auto mb-1"}),e.jsx("p",{className:"text-xs font-medium text-green-700",children:"Verified Seller"})]})]})]},r.id)})})]})})]}):e.jsx(z,{className:"border-dashed border-2 border-gray-300 bg-gradient-to-br from-white to-green-50",children:e.jsxs(G,{className:"p-16 text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-green-100 to-green-200 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(Z,{className:"h-12 w-12 text-green-600"})}),e.jsx("h3",{className:"text-2xl font-bold mb-3 bg-gradient-to-r from-green-600 to-emerald-700 bg-clip-text text-transparent",children:"Start Comparing Products"}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-md mx-auto text-lg",children:N.length===0?"You need to add products to your marketplace first. Once you have products, you can compare them here.":`Found ${N.length} products across ${pe.length-1} categories. Select products to start comparing.`}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsxs(M,{onClick:()=>j(!0),size:"lg",className:"flex items-center gap-3 bg-green-600 hover:bg-green-700 text-white shadow-xl shadow-green-500/25 px-8 py-3 text-lg",disabled:N.length===0,children:[e.jsx(Z,{className:"h-5 w-5"}),N.length===0?"No Products Available":"Browse Products"]}),N.length===0&&e.jsx(M,{onClick:()=>window.location.href="/products/upload",size:"lg",variant:"outline",className:"border-green-200 text-green-600 hover:bg-green-50 px-8 py-3 text-lg",children:"Add Products to Marketplace"})]})]})})]})})]})}export{ta as default};
