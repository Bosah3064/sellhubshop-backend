import{c as Y,r as p,s as v,w as x,j as e,b as T,e as L,B as h,o as n,I as c,d as N,Z as $}from"./index-DIxCcwTo.js";import{T as Z}from"./textarea-QQPFZBv8.js";import{D as H,g as J,a as W,d as G,c as K,e as Q}from"./dialog-YYEI7PMn.js";import{S as F,a as D,b as I,c as E,d as m}from"./select-D5YEeGQh.js";import{S as M}from"./switch-Cu0j0zPN.js";import{P as O}from"./plus-CBbazF2H.js";import{V}from"./video-BUh911uE.js";import{S as X}from"./square-pen-D7UXfZ4O.js";import{T as ee}from"./trash-2-2bzzvvn1.js";import{I as te}from"./image-DUKzMe2-.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=Y("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]),ae=({banner:r,onEdit:w,onDelete:_})=>{const[y,f]=p.useState(!1),C=s=>{const u={active:"bg-green-100 text-green-800 border-green-200",inactive:"bg-gray-100 text-gray-800 border-gray-200",scheduled:"bg-blue-100 text-blue-800 border-blue-200"};return e.jsx(N,{variant:"outline",className:u[s],children:s})},g=s=>{const u={promotional:"bg-purple-100 text-purple-800 border-purple-200",seasonal:"bg-orange-100 text-orange-800 border-orange-200",emergency:"bg-red-100 text-red-800 border-red-200",informational:"bg-blue-100 text-blue-800 border-blue-200"};return e.jsx(N,{variant:"outline",className:u[s],children:s})},b=s=>{const u={image:"bg-green-100 text-green-800 border-green-200",video:"bg-blue-100 text-blue-800 border-blue-200",animation:"bg-purple-100 text-purple-800 border-purple-200"},S={image:e.jsx(te,{className:"h-3 w-3 mr-1"}),video:e.jsx(V,{className:"h-3 w-3 mr-1"}),animation:e.jsx($,{className:"h-3 w-3 mr-1"})};return e.jsxs(N,{variant:"outline",className:u[s],children:[S[s],s]})};return e.jsxs(T,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"h-32 bg-cover bg-center relative",style:{backgroundImage:y?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":`url(${r.image_url})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[e.jsx("div",{className:"absolute inset-0 bg-black/20"}),e.jsx("div",{className:"absolute top-2 left-2 flex gap-1",children:b(r.media_type)}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[C(r.status),g(r.type)]}),r.media_type==="image"&&e.jsx("img",{src:r.image_url,alt:"",className:"hidden",onError:()=>f(!0),onLoad:()=>f(!1)}),(r.media_type==="video"||r.media_type==="animation")&&r.video_url&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40",children:e.jsx(V,{className:"h-8 w-8 text-white opacity-70"})}),y&&r.media_type==="image"&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx(P,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Banner Image"})]})})]}),e.jsxs(L,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg leading-tight",children:r.title}),e.jsxs(N,{variant:"outline",children:["P",r.priority]})]}),r.description&&e.jsx("div",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:r.description}),e.jsxs("div",{className:"space-y-2 text-xs text-muted-foreground mb-3",children:[r.target_url&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Link:"}),e.jsx("span",{className:"truncate",children:r.target_url})]}),r.button_text&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Button:"}),e.jsx("span",{children:r.button_text})]}),(r.media_type==="video"||r.media_type==="animation")&&r.video_url&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Video:"}),e.jsx("span",{className:"truncate text-blue-600",children:r.video_url.split("/").pop()})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Created by:"}),e.jsx("span",{children:r.creator_display})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>w(r),className:"flex-1",children:[e.jsx(X,{className:"w-3 h-3 mr-1"}),"Edit"]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>_(r.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),"Delete"]})]})]})]},r.id)};function A({currentAdmin:r,permissions:w}){const[_,y]=p.useState([]),[f,C]=p.useState(!0),[g,b]=p.useState(!1),[s,u]=p.useState(null),[S,j]=p.useState(!1),[a,B]=p.useState({title:"",description:"",image_url:"",video_url:"",animation_url:"",media_type:"image",target_url:"",type:"promotional",status:"active",priority:1,button_text:"",button_color:"#000000",text_color:"#ffffff",start_date:"",end_date:"",autoplay:!0,muted:!0,loop:!0});p.useEffect(()=>{k()},[]),p.useEffect(()=>{B(s?{title:s.title||"",description:s.description||"",image_url:s.image_url||"",video_url:s.video_url||"",animation_url:s.animation_url||"",media_type:s.media_type||"image",target_url:s.target_url||"",type:s.type||"promotional",status:s.status||"active",priority:s.priority||1,button_text:s.button_text||"",button_color:s.button_color||"#000000",text_color:s.text_color||"#ffffff",start_date:s.start_date?s.start_date.slice(0,16):"",end_date:s.end_date?s.end_date.slice(0,16):"",autoplay:s.autoplay??!0,muted:s.muted??!0,loop:s.loop??!0}:{title:"",description:"",image_url:"",video_url:"",animation_url:"",media_type:"image",target_url:"",type:"promotional",status:"active",priority:1,button_text:"",button_color:"#000000",text_color:"#ffffff",start_date:"",end_date:"",autoplay:!0,muted:!0,loop:!0})},[s]);const k=async()=>{try{console.log("Loading banners...");const{data:t,error:i}=await v.from("banners").select("*").order("created_at",{ascending:!1});if(i)throw console.error("Supabase error:",i),i;console.log("Banners loaded successfully:",t?.map(o=>({id:o.id,title:o.title,image_url:o.image_url,media_type:o.media_type,status:o.status})));const d=t?.map(o=>({...o,creator_display:o.created_by?`User: ${o.created_by.substring(0,8)}...`:"Unknown"}))||[];y(d)}catch(t){console.error("Error loading banners:",t),x({variant:"destructive",title:"Failed to load banners",description:t.message||"Please try again later."})}finally{C(!1)}},l=(t,i)=>{B(d=>({...d,[t]:i}))},q=async t=>{t.preventDefault(),b(!0);try{console.log("Saving banner with data:",a);const i={title:a.title,description:a.description,image_url:a.image_url,video_url:a.video_url,animation_url:a.animation_url,media_type:a.media_type,target_url:a.target_url,type:a.type,status:a.status,priority:a.priority,button_text:a.button_text,button_color:a.button_color,text_color:a.text_color,start_date:a.start_date?new Date(a.start_date).toISOString():null,end_date:a.end_date?new Date(a.end_date).toISOString():null,autoplay:a.autoplay,muted:a.muted,loop:a.loop,updated_at:new Date().toISOString()};if(console.log("Processed banner data:",i),s){const{error:d}=await v.from("banners").update(i).eq("id",s.id);if(d)throw console.error("Supabase update error:",d),d;x({title:"Banner updated",description:"Banner has been updated successfully."})}else{const{data:{user:d}}=await v.auth.getUser();if(!d)throw new Error("User not authenticated");const{error:o}=await v.from("banners").insert([{...i,created_by:d.id}]);if(o)throw console.error("Supabase insert error:",o),o;x({title:"Banner created",description:"Banner has been created successfully."})}j(!1),u(null),await k()}catch(i){console.error("Error saving banner:",i),x({variant:"destructive",title:"Failed to save banner",description:i.message||"Please check the form and try again."})}finally{b(!1)}},R=async t=>{try{const{error:i}=await v.from("banners").delete().eq("id",t);if(i)throw i;x({title:"Banner deleted",description:"Banner has been deleted successfully."}),k()}catch(i){console.error("Error deleting banner:",i),x({variant:"destructive",title:"Failed to delete banner",description:i.message||"Please try again."})}},z=t=>{u(t),j(!0)},U=()=>{u(null),j(!0)};return w.canManageBanners?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-br from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Banner Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage promotional banners and campaigns with images, videos, and animations"})]}),e.jsxs(H,{open:S,onOpenChange:j,children:[e.jsx(J,{asChild:!0,children:e.jsxs(h,{onClick:U,className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Create Banner"]})}),e.jsxs(W,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(G,{children:[e.jsx(K,{children:s?"Edit Banner":"Create New Banner"}),e.jsx(Q,{children:s?"Update your banner details":"Create a new promotional banner with images, videos, or animations"})]}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"title",children:"Title *"}),e.jsx(c,{id:"title",name:"title",value:a.title,onChange:t=>l("title",t.target.value),placeholder:"Black Friday Sale",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"media_type",children:"Media Type *"}),e.jsxs(F,{value:a.media_type,onValueChange:t=>l("media_type",t),children:[e.jsx(D,{children:e.jsx(I,{})}),e.jsxs(E,{children:[e.jsx(m,{value:"image",children:"Image"}),e.jsx(m,{value:"video",children:"Video"}),e.jsx(m,{value:"animation",children:"Animation"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(Z,{id:"description",name:"description",value:a.description,onChange:t=>l("description",t.target.value),placeholder:"Up to 70% off on all electronics...",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"image_url",children:"Image URL *"}),e.jsx(c,{id:"image_url",name:"image_url",value:a.image_url,onChange:t=>l("image_url",t.target.value),placeholder:"https://example.com/banner.jpg",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Required for all media types (used as fallback and thumbnail)"})]}),(a.media_type==="video"||a.media_type==="animation")&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"video_url",children:[a.media_type==="video"?"Video URL":"Animation URL"," ","*"]}),e.jsx(c,{id:"video_url",name:"video_url",value:a.video_url,onChange:t=>l("video_url",t.target.value),placeholder:a.media_type==="video"?"https://example.com/video.mp4":"https://example.com/animation.json",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.media_type==="video"?"MP4 format recommended for best compatibility":"Lottie JSON format for animations"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"target_url",children:"Target URL"}),e.jsx(c,{id:"target_url",name:"target_url",value:a.target_url,onChange:t=>l("target_url",t.target.value),placeholder:"/deals/black-friday"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"button_text",children:"Button Text"}),e.jsx(c,{id:"button_text",name:"button_text",value:a.button_text,onChange:t=>l("button_text",t.target.value),placeholder:"Shop Now"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"priority",children:"Priority (1-10)"}),e.jsx(c,{id:"priority",name:"priority",type:"number",min:"1",max:"10",value:a.priority,onChange:t=>l("priority",parseInt(t.target.value)||1)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"type",children:"Banner Type"}),e.jsxs(F,{value:a.type,onValueChange:t=>l("type",t),children:[e.jsx(D,{children:e.jsx(I,{})}),e.jsxs(E,{children:[e.jsx(m,{value:"promotional",children:"Promotional"}),e.jsx(m,{value:"seasonal",children:"Seasonal"}),e.jsx(m,{value:"emergency",children:"Emergency"}),e.jsx(m,{value:"informational",children:"Informational"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"status",children:"Status"}),e.jsxs(F,{value:a.status,onValueChange:t=>l("status",t),children:[e.jsx(D,{children:e.jsx(I,{})}),e.jsxs(E,{children:[e.jsx(m,{value:"active",children:"Active"}),e.jsx(m,{value:"inactive",children:"Inactive"}),e.jsx(m,{value:"scheduled",children:"Scheduled"})]})]})]})]}),(a.media_type==="video"||a.media_type==="animation")&&e.jsxs("div",{className:"grid grid-cols-3 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:"autoplay",checked:a.autoplay,onCheckedChange:t=>l("autoplay",t)}),e.jsx(n,{htmlFor:"autoplay",className:"text-sm",children:"Autoplay"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:"muted",checked:a.muted,onCheckedChange:t=>l("muted",t)}),e.jsx(n,{htmlFor:"muted",className:"text-sm",children:"Muted"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:"loop",checked:a.loop,onCheckedChange:t=>l("loop",t)}),e.jsx(n,{htmlFor:"loop",className:"text-sm",children:"Loop"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"button_color",children:"Button Color"}),e.jsx(c,{id:"button_color",name:"button_color",type:"color",value:a.button_color,onChange:t=>l("button_color",t.target.value),className:"h-10"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"text_color",children:"Text Color"}),e.jsx(c,{id:"text_color",name:"text_color",type:"color",value:a.text_color,onChange:t=>l("text_color",t.target.value),className:"h-10"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"start_date",children:"Start Date"}),e.jsx(c,{id:"start_date",name:"start_date",type:"datetime-local",value:a.start_date,onChange:t=>l("start_date",t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"end_date",children:"End Date"}),e.jsx(c,{id:"end_date",name:"end_date",type:"datetime-local",value:a.end_date,onChange:t=>l("end_date",t.target.value)})]})]}),e.jsxs("div",{className:"flex gap-4 justify-end pt-4 border-t",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>j(!1),disabled:g,children:"Cancel"}),e.jsx(h,{type:"submit",className:"bg-purple-600 hover:bg-purple-700",disabled:g,children:g?"Saving...":s?"Update Banner":"Create Banner"})]})]})]})]})]}),f?e.jsx("div",{className:"flex justify-center items-center p-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:_.map(t=>e.jsx(ae,{banner:t,onEdit:z,onDelete:R},t.id))}),_.length===0&&e.jsx(T,{children:e.jsxs(L,{className:"p-12 text-center",children:[e.jsx(P,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground opacity-50"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Banners Yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first banner to start promoting campaigns and announcements."}),e.jsxs(h,{onClick:U,className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Create Your First Banner"]})]})})]})]}):e.jsx(T,{children:e.jsx(L,{className:"p-6",children:e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(P,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Banner Management"}),e.jsx("p",{children:"You don't have permission to manage banners."})]})})})}const pe=Object.freeze(Object.defineProperty({__proto__:null,AdminBannerManager:A,default:A},Symbol.toStringTag,{value:"Module"}));export{A,P as M,pe as a};
