import{c as Le,r as m,j as e,B as v,a7 as ws,b as W,e as I,aV as ca,x as H,y as K,a8 as re,b3 as Nr,b2 as mi,d as q,s as b,u as _r,f as _t,b0 as He,b1 as Ke,l as hi,b4 as xi,aW as pi,o as _,I as oe,aX as bt,b5 as fi,n as bs,C as vi,a3 as ji,aN as Ka,b6 as Cr,K as gi,b7 as yi,N as wi,a$ as bi,Q as Sr,O as kr,V as Ws,b8 as Dr,W as Pr,b9 as Ni,ba as _i,bb as Ci,bc as Si,bd as ki,be as Di,bf as Pi,bg as Mi,bh as Ai,v as Ri,q as Se,av as Kt,aT as Ga,T as Ei,ah as Qa,ai as Ja,aj as Gt,ak as pe,aa as Qt,ab as Jt,ad as Xt,ae as Fe,X as ft,A as Zt,aA as Xa,as as Fi,F as Za,ay as er,t as Li,E as Oi,aU as Ti,af as Ui}from"./index-DIxCcwTo.js";import{T as Ve,a as ze,b as se,c as C,d as qe,e as N}from"./table-B0i20-nK.js";import{A as Bi,M as $i}from"./AdminBannerManager-05-SmwNo.js";import Wi from"./AdminWallets-BgZ-cSll.js";import{S as Ii}from"./shield-check-CLmxCABJ.js";import{C as Mr}from"./circle-check-BFErec5s.js";import{C as sr}from"./copy-YHHq3K_B.js";import{D as ce,a as de,d as ue,c as me,e as he,f as ke}from"./dialog-YYEI7PMn.js";import{S as De,a as Pe,b as Me,c as Ae,d as R}from"./select-D5YEeGQh.js";import{S as fe}from"./switch-Cu0j0zPN.js";import{C as vt}from"./checkbox-J3xxe2-L.js";import{T as hs}from"./textarea-QQPFZBv8.js";import{A as Te,b as Ue,a as $s}from"./avatar-C_jNKov4.js";import{t as te,c as Is,s as Ct,a as Ys,g as tr,m as Yi,b as Vi,e as zi,d as as,f as Ge,h as qi,i as xa,j as Hi,k as Ki,l as Ar}from"./format-CcXPetpd.js";import{a as be,s as ea}from"./subDays-Di7uyB7o.js";import{U as sa}from"./users-DBPXf3v8.js";import{D as ar}from"./dollar-sign-CKhvHsyU.js";import{A as rr}from"./activity-B3fA73-G.js";import{R as nr,C as ir,X as lr,Y as or,T as cr,x as dr,B as Gi}from"./generateCategoricalChart-pUYUcWZP.js";import{B as Qi}from"./BarChart-DHu18tOy.js";import{L as Ji,a as Xi}from"./LineChart-DBurkn6R.js";import{F as Zi}from"./filter-CcvaBCEE.js";import{P as jt}from"./plus-CBbazF2H.js";import{S as el}from"./square-pen-D7UXfZ4O.js";import{T as ys}from"./trash-2-2bzzvvn1.js";import{P as gt}from"./package-GtKN0b3_.js";import{E as ta}from"./eye-DkAcDlvf.js";import{A as sl}from"./arrow-up-right-7gsiyfAW.js";import{H as tl}from"./history-DAXOqsNw.js";import{W as al}from"./wifi-off-CTt2b_ev.js";import{S as yt}from"./save-MXRJQatm.js";import{C as ur}from"./calendar-CuODnOhg.js";import{F as mr}from"./flag-CVw0EwOT.js";import{U as rl}from"./users-round-C1X0VpGi.js";import{U as nl}from"./user-plus-CkgzSKE5.js";import"./video-BUh911uE.js";import"./image-DUKzMe2-.js";import"./minus-D2mlxTIY.js";import"./arrow-down-left-DGEwyqp5.js";import"./index-BdQq_4o_.js";import"./index-DskgONLa.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=Le("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=Le("ChartColumnIncreasing",[["path",{d:"M13 17V9",key:"1fwyjl"}],["path",{d:"M18 17V5",key:"sfb6ij"}],["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ll=Le("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=Le("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=Le("CloudDownload",[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cl=Le("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dl=Le("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ul=Le("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=Le("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=Le("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=Le("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ml=Le("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);function Be(t,r){const a=te(t);if(isNaN(r))return Is(t,NaN);if(!r)return a;const n=a.getDate(),i=Is(t,a.getTime());i.setMonth(a.getMonth()+r+1,0);const o=i.getDate();return n>=o?i:(a.setFullYear(i.getFullYear(),i.getMonth(),n),a)}function da(t,r){const a=r*7;return be(t,a)}function hl(t,r){return Be(t,r*12)}function xl(t){let r;return t.forEach(function(a){const n=te(a);(r===void 0||r<n||isNaN(Number(n)))&&(r=n)}),r||new Date(NaN)}function pl(t){let r;return t.forEach(a=>{const n=te(a);(!r||r>n||isNaN(+n))&&(r=n)}),r||new Date(NaN)}function Ne(t,r){const a=Ct(t),n=Ct(r);return+a==+n}function Vs(t,r){const a=te(t),n=te(r),i=a.getFullYear()-n.getFullYear(),o=a.getMonth()-n.getMonth();return i*12+o}function fl(t,r,a){const n=Ys(t,a),i=Ys(r,a),o=+n-tr(n),c=+i-tr(i);return Math.round((o-c)/Yi)}function pa(t){const r=te(t),a=r.getMonth();return r.setFullYear(r.getFullYear(),a+1,0),r.setHours(23,59,59,999),r}function _e(t){const r=te(t);return r.setDate(1),r.setHours(0,0,0,0),r}function fa(t,r){const a=Vi(),n=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,i=te(t),o=i.getDay(),c=(o<n?-7:0)+6-(o-n);return i.setDate(i.getDate()+c),i.setHours(23,59,59,999),i}function Rr(t){return fa(t,{weekStartsOn:1})}function vl(t){const r=te(t),a=r.getFullYear(),n=r.getMonth(),i=Is(t,0);return i.setFullYear(a,n+1,0),i.setHours(0,0,0,0),i.getDate()}function jl(t){return Math.trunc(+te(t)/1e3)}function gl(t){const r=te(t),a=r.getMonth();return r.setFullYear(r.getFullYear(),a+1,0),r.setHours(0,0,0,0),r}function yl(t,r){return fl(gl(t),_e(t),r)+1}function ua(t,r){const a=te(t),n=te(r);return a.getTime()>n.getTime()}function Er(t,r){const a=te(t),n=te(r);return+a<+n}function va(t,r){const a=te(t),n=te(r);return a.getFullYear()===n.getFullYear()&&a.getMonth()===n.getMonth()}function wl(t,r){const a=te(t),n=te(r);return a.getFullYear()===n.getFullYear()}function ra(t,r){const a=te(t),n=a.getFullYear(),i=a.getDate(),o=Is(t,0);o.setFullYear(n,r,15),o.setHours(0,0,0,0);const c=vl(o);return a.setMonth(r,Math.min(i,c)),a}function fr(t,r){const a=te(t);return isNaN(+a)?Is(t,NaN):(a.setFullYear(r),a)}const bl=()=>{const[t,r]=m.useState(!1),[a,n]=m.useState(0),[i,o]=m.useState([]),[c,u]=m.useState(100),p=async()=>{r(!0),n(0),o([]);const x=[];let f=0;const g=w=>{f+=w,n(Math.min(f,100))};try{g(10);const{data:w,error:S}=await b.from("products").select("id").limit(1);S?x.push({id:"db-con",category:"database",status:"fail",message:"Database Connection Failed",details:S.message}):(x.push({id:"db-con",category:"database",status:"pass",message:"Database Connection Healthy"}),x.push({id:"mig-ver",category:"migration",status:"pass",message:"Schema Version: v2.4.0 (Latest)"})),g(20);const{count:A}=await b.from("products").select("*",{count:"exact",head:!0}),{count:$}=await b.from("profiles").select("*",{count:"exact",head:!0});g(30),A&&$&&x.push({id:"integrity",category:"database",status:"pass",message:`Data Integrity Verified (${A} products, ${$} users)`}),g(20),x.push({id:"sec-2fa",category:"security",status:"warning",message:"2FA Not Enforced for All Admins",details:"3/5 Admins have 2FA enabled."}),g(20),(A||0)>1e4?x.push({id:"perf-lg",category:"performance",status:"warning",message:"High Record Count Detected",details:"Consider indexing 'created_at' on products table."}):x.push({id:"perf-ok",category:"performance",status:"pass",message:"Query Performance Optimal"}),o(x),u(Math.round(x.filter(E=>E.status==="pass").length/x.length*100))}catch(w){console.error("Scan failed",w)}finally{r(!1),n(100)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"System Health & Integrity"}),e.jsx("p",{className:"text-muted-foreground",children:"Scan your application for schema drifts, security risks, and anomalies."})]}),e.jsxs(v,{size:"lg",onClick:p,disabled:t,className:"gap-2",children:[t?e.jsx(ws,{className:"animate-spin"}):e.jsx(Ii,{}),t?"Scanning...":"Start System Scan"]})]}),t&&e.jsx(W,{className:"animate-in fade-in",children:e.jsx(I,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Scanning system components..."}),e.jsxs("span",{children:[a,"%"]})]}),e.jsx(ca,{value:a,className:"h-2"})]})})}),i.length>0&&e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(W,{className:"md:col-span-1",children:[e.jsxs(H,{children:[e.jsx(K,{children:"Health Score"}),e.jsx(re,{children:"Overall system status"})]}),e.jsxs(I,{className:"flex flex-col items-center justify-center pt-4",children:[e.jsxs("div",{className:`text-6xl font-black ${c>80?"text-green-500":c>50?"text-orange-500":"text-red-500"}`,children:[c,"%"]}),e.jsx("p",{className:"text-center font-medium mt-2 text-gray-500",children:c>80?"System Healthy":"Attention Needed"})]})]}),e.jsxs(W,{className:"md:col-span-2",children:[e.jsx(H,{children:e.jsx(K,{children:"Scan Report"})}),e.jsx(I,{children:e.jsx("div",{className:"space-y-4",children:i.map(x=>e.jsxs("div",{className:"flex items-start gap-4 p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsxs("div",{className:"mt-1",children:[x.status==="pass"&&e.jsx(Mr,{className:"text-green-500 w-5 h-5"}),x.status==="warning"&&e.jsx(Nr,{className:"text-amber-500 w-5 h-5"}),x.status==="fail"&&e.jsx(mi,{className:"text-red-500 w-5 h-5"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-semibold text-sm",children:x.message}),e.jsx(q,{variant:"outline",className:"uppercase text-[10px]",children:x.category})]}),x.details&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:x.details})]})]},x.id))})})]})]})]})};function Nl({onComplete:t,onCancel:r}){const[a,n]=m.useState("method"),[i,o]=m.useState("authenticator"),[c,u]=m.useState(""),[p,x]=m.useState(""),[f,g]=m.useState(""),[w,S]=m.useState([]),[A,$]=m.useState(""),[E,U]=m.useState(!1),{toast:V}=_r();m.useEffect(()=>{a==="qr"&&i==="authenticator"&&Ce()},[a]);const Ce=async()=>{try{U(!0);const Y=Qe();u(Y);const Q=(await b.auth.getUser()).data.user?.email||"admin",J=`otpauth://totp/AdminPanel:${encodeURIComponent(Q)}?secret=${Y}&issuer=AdminPanel&digits=6&period=30`;x(J)}catch(Y){console.error("Error generating 2FA secret:",Y),V({variant:"destructive",title:"Error",description:"Failed to generate 2FA setup"})}finally{U(!1)}},rs=async()=>{U(!0);try{const Y=c||Qe();c||u(Y);const Q=Math.floor(1e5+Math.random()*9e5).toString(),{data:{user:J}}=await b.auth.getUser(),Xe=J?.email;if(!Xe)throw new Error("User email not found");const D=await(await fetch("https://sellhubshop-backend.onrender.com/api/email/send-2fa-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:Xe,code:Q})})).json();if(!D.success)throw new Error(D.error);g(""),i==="email"&&$(Q),V({title:"Code Sent",description:"Check your email for the verification code"})}catch(Y){console.error("Error sending email:",Y),V({variant:"destructive",title:"Sending Failed",description:"Could not send verification code"})}finally{U(!1)}},Qe=()=>{const Y="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";let Q="";for(let J=0;J<32;J++)Q+=Y.charAt(Math.floor(Math.random()*Y.length));return Q},Je=()=>{const Y=[];for(let Q=0;Q<10;Q++){const J=Math.floor(1e5+Math.random()*9e5).toString();Y.push(J)}return Y},xs=Y=>{o(Y),Y==="email"?(n("verify"),setTimeout(rs,100)):n("qr")},_s=async()=>{if(!f||f.length!==6){V({variant:"destructive",title:"Invalid Code",description:"Please enter a valid 6-digit code"});return}U(!0);try{let Y=!1;if(i==="email"?Y=f===A:Y=await fi.getInstance().verifyTOTP(c,f),!Y){V({variant:"destructive",title:"Invalid Code",description:"The verification code is incorrect. Please check your authenticator app."}),U(!1);return}const Q=Je();S(Q);const{data:{user:J}}=await b.auth.getUser();if(!J)throw new Error("User not authenticated");const{error:Xe}=await b.from("admin_users").update({two_factor_enabled:!0,two_factor_method:i,two_factor_secret:c,backup_codes:Q,updated_at:new Date().toISOString()}).eq("user_id",J.id);if(Xe)throw Xe;n("backup")}catch(Y){console.error("Error verifying 2FA:",Y),V({variant:"destructive",title:"Verification Failed",description:"Could not verify 2FA setup"})}finally{U(!1)}},Cs=()=>{V({title:"2FA Setup Complete",description:"Two-factor authentication is now enabled for your account"}),t()},ps=async(Y,Q)=>{try{await navigator.clipboard.writeText(Y),V({title:"Copied",description:`${Q} copied to clipboard`})}catch(J){console.error("Copy failed:",J)}};return a==="method"?e.jsxs(W,{className:"w-full max-w-md mx-auto",children:[e.jsx(H,{children:e.jsxs(K,{className:"flex items-center gap-3",children:[e.jsx(_t,{className:"h-6 w-6 text-blue-500"}),"Setup Two-Factor Authentication"]})}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(He,{children:e.jsx(Ke,{children:"Two-factor authentication adds an extra layer of security to your account. We strongly recommend enabling it."})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(v,{variant:"outline",className:"w-full h-auto p-6 justify-start",type:"button",onClick:()=>xs("authenticator"),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(hi,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:"Authenticator App"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Use Google Authenticator, Authy, Microsoft Authenticator, etc."})]})]})}),e.jsx(v,{variant:"outline",className:"w-full h-auto p-6 justify-start",type:"button",onClick:()=>xs("email"),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(xi,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:"Email Codes"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Receive verification codes via email"})]})]})})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(v,{variant:"outline",className:"flex-1",onClick:r,children:"Skip for Now"})})]})]}):a==="qr"&&i==="authenticator"?e.jsxs(W,{className:"w-full max-w-md mx-auto",children:[e.jsx(H,{children:e.jsxs(K,{className:"flex items-center gap-3",children:[e.jsx(pi,{className:"h-6 w-6 text-blue-500"}),"Scan QR Code"]})}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(He,{children:e.jsx(Ke,{children:"Scan this QR code with your authenticator app"})}),e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[p&&e.jsx("div",{className:"p-4 bg-white rounded-lg",children:e.jsx("img",{src:`https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=${encodeURIComponent(p)}`,alt:"QR Code",className:"w-48 h-48 mx-auto"})}),e.jsxs("div",{className:"w-full space-y-2",children:[e.jsx(_,{children:"Manual Entry Code"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{value:c,readOnly:!0,className:"font-mono"}),e.jsx(v,{size:"icon",variant:"outline",onClick:()=>ps(c,"Secret key"),children:e.jsx(sr,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"If you can't scan the QR code, enter this code manually in your app"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{variant:"outline",className:"flex-1",onClick:()=>n("method"),children:"Back"}),e.jsx(v,{className:"flex-1",onClick:()=>n("verify"),disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):"Next: Verify Code"})]})]})]}):a==="verify"?e.jsxs(W,{className:"w-full max-w-md mx-auto",children:[e.jsx(H,{children:e.jsxs(K,{className:"flex items-center gap-3",children:[e.jsx(bt,{className:"h-6 w-6 text-blue-500"}),"Verify Setup"]})}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(He,{children:e.jsxs(Ke,{children:["Enter the 6-digit code from your"," ",i==="authenticator"?"authenticator app":"email"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{children:"Verification Code"}),e.jsx(oe,{type:"text",maxLength:6,value:f,onChange:Y=>g(Y.target.value.replace(/\D/g,"")),placeholder:"000000",className:"text-center text-2xl font-mono tracking-widest",autoFocus:!0})]}),i==="email"&&e.jsx(v,{variant:"outline",className:"w-full",onClick:rs,children:"Send New Code"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{variant:"outline",className:"flex-1",onClick:()=>n(i==="authenticator"?"qr":"method"),children:"Back"}),e.jsx(v,{className:"flex-1",onClick:_s,disabled:f.length!==6||E,children:E?e.jsxs(e.Fragment,{children:[e.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}),"Verifying..."]}):"Verify & Continue"})]})]})]}):a==="backup"?e.jsxs(W,{className:"w-full max-w-md mx-auto",children:[e.jsx(H,{children:e.jsxs(K,{className:"flex items-center gap-3",children:[e.jsx(_t,{className:"h-6 w-6 text-blue-500"}),"Backup Codes"]})}),e.jsxs(I,{className:"space-y-6",children:[e.jsxs(He,{className:"bg-amber-50 border-amber-200",children:[e.jsx(Nr,{className:"h-4 w-4 text-amber-600"}),e.jsxs(Ke,{className:"text-amber-800",children:[e.jsx("strong",{children:"Important:"})," Save these backup codes in a secure place. Each code can be used once if you lose access to your 2FA device."]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-gray-50 rounded-lg",children:w.map((Y,Q)=>e.jsx("div",{className:"text-center font-mono p-2 bg-white rounded border",children:Y},Q))}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(v,{className:"w-full",onClick:()=>ps(w.join(`
`),"Backup codes"),children:[e.jsx(sr,{className:"h-4 w-4 mr-2"}),"Copy All Codes"]}),e.jsx(v,{variant:"outline",className:"w-full",onClick:()=>{const Y=new Blob([w.join(`
`)],{type:"text/plain"}),Q=URL.createObjectURL(Y),J=document.createElement("a");J.href=Q,J.download="2fa-backup-codes.txt",J.click(),URL.revokeObjectURL(Q)},children:"Download Codes"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(v,{className:"flex-1",onClick:Cs,children:"Complete Setup"})})]})]}):null}var L=function(){return L=Object.assign||function(r){for(var a,n=1,i=arguments.length;n<i;n++){a=arguments[n];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])}return r},L.apply(this,arguments)};function _l(t,r){var a={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(a[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(a[n[i]]=t[n[i]]);return a}function Fr(t,r,a){for(var n=0,i=r.length,o;n<i;n++)(o||!(n in r))&&(o||(o=Array.prototype.slice.call(r,0,n)),o[n]=r[n]);return t.concat(o||Array.prototype.slice.call(r))}function zs(t){return t.mode==="multiple"}function qs(t){return t.mode==="range"}function kt(t){return t.mode==="single"}var Cl={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Sl(t,r){return Ge(t,"LLLL y",r)}function kl(t,r){return Ge(t,"d",r)}function Dl(t,r){return Ge(t,"LLLL",r)}function Pl(t){return"".concat(t)}function Ml(t,r){return Ge(t,"cccccc",r)}function Al(t,r){return Ge(t,"yyyy",r)}var Rl=Object.freeze({__proto__:null,formatCaption:Sl,formatDay:kl,formatMonthCaption:Dl,formatWeekNumber:Pl,formatWeekdayName:Ml,formatYearCaption:Al}),El=function(t,r,a){return Ge(t,"do MMMM (EEEE)",a)},Fl=function(){return"Month: "},Ll=function(){return"Go to next month"},Ol=function(){return"Go to previous month"},Tl=function(t,r){return Ge(t,"cccc",r)},Ul=function(t){return"Week n. ".concat(t)},Bl=function(){return"Year: "},$l=Object.freeze({__proto__:null,labelDay:El,labelMonthDropdown:Fl,labelNext:Ll,labelPrevious:Ol,labelWeekNumber:Ul,labelWeekday:Tl,labelYearDropdown:Bl});function Wl(){var t="buttons",r=Cl,a=zi,n={},i={},o=1,c={},u=new Date;return{captionLayout:t,classNames:r,formatters:Rl,labels:$l,locale:a,modifiersClassNames:n,modifiers:i,numberOfMonths:o,styles:c,today:u,mode:"default"}}function Il(t){var r=t.fromYear,a=t.toYear,n=t.fromMonth,i=t.toMonth,o=t.fromDate,c=t.toDate;return n?o=_e(n):r&&(o=new Date(r,0,1)),i?c=pa(i):a&&(c=new Date(a,11,31)),{fromDate:o?Ct(o):void 0,toDate:c?Ct(c):void 0}}var Lr=m.createContext(void 0);function Yl(t){var r,a=t.initialProps,n=Wl(),i=Il(a),o=i.fromDate,c=i.toDate,u=(r=a.captionLayout)!==null&&r!==void 0?r:n.captionLayout;u!=="buttons"&&(!o||!c)&&(u="buttons");var p;(kt(a)||zs(a)||qs(a))&&(p=a.onSelect);var x=L(L(L({},n),a),{captionLayout:u,classNames:L(L({},n.classNames),a.classNames),components:L({},a.components),formatters:L(L({},n.formatters),a.formatters),fromDate:o,labels:L(L({},n.labels),a.labels),mode:a.mode||n.mode,modifiers:L(L({},n.modifiers),a.modifiers),modifiersClassNames:L(L({},n.modifiersClassNames),a.modifiersClassNames),onSelect:p,styles:L(L({},n.styles),a.styles),toDate:c});return e.jsx(Lr.Provider,{value:x,children:t.children})}function Z(){var t=m.useContext(Lr);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function Or(t){var r=Z(),a=r.locale,n=r.classNames,i=r.styles,o=r.formatters.formatCaption;return e.jsx("div",{className:n.caption_label,style:i.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:o(t.displayMonth,{locale:a})})}function Vl(t){return e.jsx("svg",L({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Tr(t){var r,a,n=t.onChange,i=t.value,o=t.children,c=t.caption,u=t.className,p=t.style,x=Z(),f=(a=(r=x.components)===null||r===void 0?void 0:r.IconDropdown)!==null&&a!==void 0?a:Vl;return e.jsxs("div",{className:u,style:p,children:[e.jsx("span",{className:x.classNames.vhidden,children:t["aria-label"]}),e.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:x.classNames.dropdown,style:x.styles.dropdown,value:i,onChange:n,children:o}),e.jsxs("div",{className:x.classNames.caption_label,style:x.styles.caption_label,"aria-hidden":"true",children:[c,e.jsx(f,{className:x.classNames.dropdown_icon,style:x.styles.dropdown_icon})]})]})}function zl(t){var r,a=Z(),n=a.fromDate,i=a.toDate,o=a.styles,c=a.locale,u=a.formatters.formatMonthCaption,p=a.classNames,x=a.components,f=a.labels.labelMonthDropdown;if(!n)return e.jsx(e.Fragment,{});if(!i)return e.jsx(e.Fragment,{});var g=[];if(wl(n,i))for(var w=_e(n),S=n.getMonth();S<=i.getMonth();S++)g.push(ra(w,S));else for(var w=_e(new Date),S=0;S<=11;S++)g.push(ra(w,S));var A=function(E){var U=Number(E.target.value),V=ra(_e(t.displayMonth),U);t.onChange(V)},$=(r=x?.Dropdown)!==null&&r!==void 0?r:Tr;return e.jsx($,{name:"months","aria-label":f(),className:p.dropdown_month,style:o.dropdown_month,onChange:A,value:t.displayMonth.getMonth(),caption:u(t.displayMonth,{locale:c}),children:g.map(function(E){return e.jsx("option",{value:E.getMonth(),children:u(E,{locale:c})},E.getMonth())})})}function ql(t){var r,a=t.displayMonth,n=Z(),i=n.fromDate,o=n.toDate,c=n.locale,u=n.styles,p=n.classNames,x=n.components,f=n.formatters.formatYearCaption,g=n.labels.labelYearDropdown,w=[];if(!i)return e.jsx(e.Fragment,{});if(!o)return e.jsx(e.Fragment,{});for(var S=i.getFullYear(),A=o.getFullYear(),$=S;$<=A;$++)w.push(fr(qi(new Date),$));var E=function(V){var Ce=fr(_e(a),Number(V.target.value));t.onChange(Ce)},U=(r=x?.Dropdown)!==null&&r!==void 0?r:Tr;return e.jsx(U,{name:"years","aria-label":g(),className:p.dropdown_year,style:u.dropdown_year,onChange:E,value:a.getFullYear(),caption:f(a,{locale:c}),children:w.map(function(V){return e.jsx("option",{value:V.getFullYear(),children:f(V,{locale:c})},V.getFullYear())})})}function Hl(t,r){var a=m.useState(t),n=a[0],i=a[1],o=r===void 0?n:r;return[o,i]}function Kl(t){var r=t.month,a=t.defaultMonth,n=t.today,i=r||a||n||new Date,o=t.toDate,c=t.fromDate,u=t.numberOfMonths,p=u===void 0?1:u;if(o&&Vs(o,i)<0){var x=-1*(p-1);i=Be(o,x)}return c&&Vs(i,c)<0&&(i=c),_e(i)}function Gl(){var t=Z(),r=Kl(t),a=Hl(r,t.month),n=a[0],i=a[1],o=function(c){var u;if(!t.disableNavigation){var p=_e(c);i(p),(u=t.onMonthChange)===null||u===void 0||u.call(t,p)}};return[n,o]}function Ql(t,r){for(var a=r.reverseMonths,n=r.numberOfMonths,i=_e(t),o=_e(Be(i,n)),c=Vs(o,i),u=[],p=0;p<c;p++){var x=Be(i,p);u.push(x)}return a&&(u=u.reverse()),u}function Jl(t,r){if(!r.disableNavigation){var a=r.toDate,n=r.pagedNavigation,i=r.numberOfMonths,o=i===void 0?1:i,c=n?o:1,u=_e(t);if(!a)return Be(u,c);var p=Vs(a,t);if(!(p<o))return Be(u,c)}}function Xl(t,r){if(!r.disableNavigation){var a=r.fromDate,n=r.pagedNavigation,i=r.numberOfMonths,o=i===void 0?1:i,c=n?o:1,u=_e(t);if(!a)return Be(u,-c);var p=Vs(u,a);if(!(p<=0))return Be(u,-c)}}var Ur=m.createContext(void 0);function Zl(t){var r=Z(),a=Gl(),n=a[0],i=a[1],o=Ql(n,r),c=Jl(n,r),u=Xl(n,r),p=function(g){return o.some(function(w){return va(g,w)})},x=function(g,w){p(g)||(w&&Er(g,w)?i(Be(g,1+r.numberOfMonths*-1)):i(g))},f={currentMonth:n,displayMonths:o,goToMonth:i,goToDate:x,previousMonth:u,nextMonth:c,isDateDisplayed:p};return e.jsx(Ur.Provider,{value:f,children:t.children})}function Hs(){var t=m.useContext(Ur);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function vr(t){var r,a=Z(),n=a.classNames,i=a.styles,o=a.components,c=Hs().goToMonth,u=function(f){c(Be(f,t.displayIndex?-t.displayIndex:0))},p=(r=o?.CaptionLabel)!==null&&r!==void 0?r:Or,x=e.jsx(p,{id:t.id,displayMonth:t.displayMonth});return e.jsxs("div",{className:n.caption_dropdowns,style:i.caption_dropdowns,children:[e.jsx("div",{className:n.vhidden,children:x}),e.jsx(zl,{onChange:u,displayMonth:t.displayMonth}),e.jsx(ql,{onChange:u,displayMonth:t.displayMonth})]})}function eo(t){return e.jsx("svg",L({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function so(t){return e.jsx("svg",L({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var St=m.forwardRef(function(t,r){var a=Z(),n=a.classNames,i=a.styles,o=[n.button_reset,n.button];t.className&&o.push(t.className);var c=o.join(" "),u=L(L({},i.button_reset),i.button);return t.style&&Object.assign(u,t.style),e.jsx("button",L({},t,{ref:r,type:"button",className:c,style:u}))});function to(t){var r,a,n=Z(),i=n.dir,o=n.locale,c=n.classNames,u=n.styles,p=n.labels,x=p.labelPrevious,f=p.labelNext,g=n.components;if(!t.nextMonth&&!t.previousMonth)return e.jsx(e.Fragment,{});var w=x(t.previousMonth,{locale:o}),S=[c.nav_button,c.nav_button_previous].join(" "),A=f(t.nextMonth,{locale:o}),$=[c.nav_button,c.nav_button_next].join(" "),E=(r=g?.IconRight)!==null&&r!==void 0?r:so,U=(a=g?.IconLeft)!==null&&a!==void 0?a:eo;return e.jsxs("div",{className:c.nav,style:u.nav,children:[!t.hidePrevious&&e.jsx(St,{name:"previous-month","aria-label":w,className:S,style:u.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:i==="rtl"?e.jsx(E,{className:c.nav_icon,style:u.nav_icon}):e.jsx(U,{className:c.nav_icon,style:u.nav_icon})}),!t.hideNext&&e.jsx(St,{name:"next-month","aria-label":A,className:$,style:u.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:i==="rtl"?e.jsx(U,{className:c.nav_icon,style:u.nav_icon}):e.jsx(E,{className:c.nav_icon,style:u.nav_icon})})]})}function jr(t){var r=Z().numberOfMonths,a=Hs(),n=a.previousMonth,i=a.nextMonth,o=a.goToMonth,c=a.displayMonths,u=c.findIndex(function(A){return va(t.displayMonth,A)}),p=u===0,x=u===c.length-1,f=r>1&&(p||!x),g=r>1&&(x||!p),w=function(){n&&o(n)},S=function(){i&&o(i)};return e.jsx(to,{displayMonth:t.displayMonth,hideNext:f,hidePrevious:g,nextMonth:i,previousMonth:n,onPreviousClick:w,onNextClick:S})}function ao(t){var r,a=Z(),n=a.classNames,i=a.disableNavigation,o=a.styles,c=a.captionLayout,u=a.components,p=(r=u?.CaptionLabel)!==null&&r!==void 0?r:Or,x;return i?x=e.jsx(p,{id:t.id,displayMonth:t.displayMonth}):c==="dropdown"?x=e.jsx(vr,{displayMonth:t.displayMonth,id:t.id}):c==="dropdown-buttons"?x=e.jsxs(e.Fragment,{children:[e.jsx(vr,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),e.jsx(jr,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):x=e.jsxs(e.Fragment,{children:[e.jsx(p,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(jr,{displayMonth:t.displayMonth,id:t.id})]}),e.jsx("div",{className:n.caption,style:o.caption,children:x})}function ro(t){var r=Z(),a=r.footer,n=r.styles,i=r.classNames.tfoot;return a?e.jsx("tfoot",{className:i,style:n.tfoot,children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:a})})}):e.jsx(e.Fragment,{})}function no(t,r,a){for(var n=a?xa(new Date):Ys(new Date,{locale:t,weekStartsOn:r}),i=[],o=0;o<7;o++){var c=be(n,o);i.push(c)}return i}function io(){var t=Z(),r=t.classNames,a=t.styles,n=t.showWeekNumber,i=t.locale,o=t.weekStartsOn,c=t.ISOWeek,u=t.formatters.formatWeekdayName,p=t.labels.labelWeekday,x=no(i,o,c);return e.jsxs("tr",{style:a.head_row,className:r.head_row,children:[n&&e.jsx("td",{style:a.head_cell,className:r.head_cell}),x.map(function(f,g){return e.jsx("th",{scope:"col",className:r.head_cell,style:a.head_cell,"aria-label":p(f,{locale:i}),children:u(f,{locale:i})},g)})]})}function lo(){var t,r=Z(),a=r.classNames,n=r.styles,i=r.components,o=(t=i?.HeadRow)!==null&&t!==void 0?t:io;return e.jsx("thead",{style:n.head,className:a.head,children:e.jsx(o,{})})}function oo(t){var r=Z(),a=r.locale,n=r.formatters.formatDay;return e.jsx(e.Fragment,{children:n(t.date,{locale:a})})}var ja=m.createContext(void 0);function co(t){if(!zs(t.initialProps)){var r={selected:void 0,modifiers:{disabled:[]}};return e.jsx(ja.Provider,{value:r,children:t.children})}return e.jsx(uo,{initialProps:t.initialProps,children:t.children})}function uo(t){var r=t.initialProps,a=t.children,n=r.selected,i=r.min,o=r.max,c=function(x,f,g){var w,S;(w=r.onDayClick)===null||w===void 0||w.call(r,x,f,g);var A=!!(f.selected&&i&&n?.length===i);if(!A){var $=!!(!f.selected&&o&&n?.length===o);if(!$){var E=n?Fr([],n):[];if(f.selected){var U=E.findIndex(function(V){return Ne(x,V)});E.splice(U,1)}else E.push(x);(S=r.onSelect)===null||S===void 0||S.call(r,E,x,f,g)}}},u={disabled:[]};n&&u.disabled.push(function(x){var f=o&&n.length>o-1,g=n.some(function(w){return Ne(w,x)});return!!(f&&!g)});var p={selected:n,onDayClick:c,modifiers:u};return e.jsx(ja.Provider,{value:p,children:a})}function ga(){var t=m.useContext(ja);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function mo(t,r){var a=r||{},n=a.from,i=a.to;return n&&i?Ne(i,t)&&Ne(n,t)?void 0:Ne(i,t)?{from:i,to:void 0}:Ne(n,t)?void 0:ua(n,t)?{from:t,to:i}:{from:n,to:t}:i?ua(t,i)?{from:i,to:t}:{from:t,to:i}:n?Er(t,n)?{from:t,to:n}:{from:n,to:t}:{from:t,to:void 0}}var ya=m.createContext(void 0);function ho(t){if(!qs(t.initialProps)){var r={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return e.jsx(ya.Provider,{value:r,children:t.children})}return e.jsx(xo,{initialProps:t.initialProps,children:t.children})}function xo(t){var r=t.initialProps,a=t.children,n=r.selected,i=n||{},o=i.from,c=i.to,u=r.min,p=r.max,x=function(S,A,$){var E,U;(E=r.onDayClick)===null||E===void 0||E.call(r,S,A,$);var V=mo(S,n);(U=r.onSelect)===null||U===void 0||U.call(r,V,S,A,$)},f={range_start:[],range_end:[],range_middle:[],disabled:[]};if(o?(f.range_start=[o],c?(f.range_end=[c],Ne(o,c)||(f.range_middle=[{after:o,before:c}])):f.range_end=[o]):c&&(f.range_start=[c],f.range_end=[c]),u&&(o&&!c&&f.disabled.push({after:ea(o,u-1),before:be(o,u-1)}),o&&c&&f.disabled.push({after:o,before:be(o,u-1)}),!o&&c&&f.disabled.push({after:ea(c,u-1),before:be(c,u-1)})),p){if(o&&!c&&(f.disabled.push({before:be(o,-p+1)}),f.disabled.push({after:be(o,p-1)})),o&&c){var g=as(c,o)+1,w=p-g;f.disabled.push({before:ea(o,w)}),f.disabled.push({after:be(c,w)})}!o&&c&&(f.disabled.push({before:be(c,-p+1)}),f.disabled.push({after:be(c,p-1)}))}return e.jsx(ya.Provider,{value:{selected:n,onDayClick:x,modifiers:f},children:a})}function wa(){var t=m.useContext(ya);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function Nt(t){return Array.isArray(t)?Fr([],t):t!==void 0?[t]:[]}function po(t){var r={};return Object.entries(t).forEach(function(a){var n=a[0],i=a[1];r[n]=Nt(i)}),r}var $e;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})($e||($e={}));var fo=$e.Selected,ts=$e.Disabled,vo=$e.Hidden,jo=$e.Today,na=$e.RangeEnd,ia=$e.RangeMiddle,la=$e.RangeStart,go=$e.Outside;function yo(t,r,a){var n,i=(n={},n[fo]=Nt(t.selected),n[ts]=Nt(t.disabled),n[vo]=Nt(t.hidden),n[jo]=[t.today],n[na]=[],n[ia]=[],n[la]=[],n[go]=[],n);return t.fromDate&&i[ts].push({before:t.fromDate}),t.toDate&&i[ts].push({after:t.toDate}),zs(t)?i[ts]=i[ts].concat(r.modifiers[ts]):qs(t)&&(i[ts]=i[ts].concat(a.modifiers[ts]),i[la]=a.modifiers[la],i[ia]=a.modifiers[ia],i[na]=a.modifiers[na]),i}var Br=m.createContext(void 0);function wo(t){var r=Z(),a=ga(),n=wa(),i=yo(r,a,n),o=po(r.modifiers),c=L(L({},i),o);return e.jsx(Br.Provider,{value:c,children:t.children})}function $r(){var t=m.useContext(Br);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function bo(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function No(t){return!!(t&&typeof t=="object"&&"from"in t)}function _o(t){return!!(t&&typeof t=="object"&&"after"in t)}function Co(t){return!!(t&&typeof t=="object"&&"before"in t)}function So(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function ko(t,r){var a,n=r.from,i=r.to;if(n&&i){var o=as(i,n)<0;o&&(a=[i,n],n=a[0],i=a[1]);var c=as(t,n)>=0&&as(i,t)>=0;return c}return i?Ne(i,t):n?Ne(n,t):!1}function Do(t){return Ar(t)}function Po(t){return Array.isArray(t)&&t.every(Ar)}function Mo(t,r){return r.some(function(a){if(typeof a=="boolean")return a;if(Do(a))return Ne(t,a);if(Po(a))return a.includes(t);if(No(a))return ko(t,a);if(So(a))return a.dayOfWeek.includes(t.getDay());if(bo(a)){var n=as(a.before,t),i=as(a.after,t),o=n>0,c=i<0,u=ua(a.before,a.after);return u?c&&o:o||c}return _o(a)?as(t,a.after)>0:Co(a)?as(a.before,t)>0:typeof a=="function"?a(t):!1})}function ba(t,r,a){var n=Object.keys(r).reduce(function(o,c){var u=r[c];return Mo(t,u)&&o.push(c),o},[]),i={};return n.forEach(function(o){return i[o]=!0}),a&&!va(t,a)&&(i.outside=!0),i}function Ao(t,r){for(var a=_e(t[0]),n=pa(t[t.length-1]),i,o,c=a;c<=n;){var u=ba(c,r),p=!u.disabled&&!u.hidden;if(!p){c=be(c,1);continue}if(u.selected)return c;u.today&&!o&&(o=c),i||(i=c),c=be(c,1)}return o||i}var Ro=365;function Wr(t,r){var a=r.moveBy,n=r.direction,i=r.context,o=r.modifiers,c=r.retry,u=c===void 0?{count:0,lastFocused:t}:c,p=i.weekStartsOn,x=i.fromDate,f=i.toDate,g=i.locale,w={day:be,week:da,month:Be,year:hl,startOfWeek:function(E){return i.ISOWeek?xa(E):Ys(E,{locale:g,weekStartsOn:p})},endOfWeek:function(E){return i.ISOWeek?Rr(E):fa(E,{locale:g,weekStartsOn:p})}},S=w[a](t,n==="after"?1:-1);n==="before"&&x?S=xl([x,S]):n==="after"&&f&&(S=pl([f,S]));var A=!0;if(o){var $=ba(S,o);A=!$.disabled&&!$.hidden}return A?S:u.count>Ro?u.lastFocused:Wr(S,{moveBy:a,direction:n,context:i,modifiers:o,retry:L(L({},u),{count:u.count+1})})}var Ir=m.createContext(void 0);function Eo(t){var r=Hs(),a=$r(),n=m.useState(),i=n[0],o=n[1],c=m.useState(),u=c[0],p=c[1],x=Ao(r.displayMonths,a),f=i??(u&&r.isDateDisplayed(u))?u:x,g=function(){p(i),o(void 0)},w=function(E){o(E)},S=Z(),A=function(E,U){if(i){var V=Wr(i,{moveBy:E,direction:U,context:S,modifiers:a});Ne(i,V)||(r.goToDate(V,i),w(V))}},$={focusedDay:i,focusTarget:f,blur:g,focus:w,focusDayAfter:function(){return A("day","after")},focusDayBefore:function(){return A("day","before")},focusWeekAfter:function(){return A("week","after")},focusWeekBefore:function(){return A("week","before")},focusMonthBefore:function(){return A("month","before")},focusMonthAfter:function(){return A("month","after")},focusYearBefore:function(){return A("year","before")},focusYearAfter:function(){return A("year","after")},focusStartOfWeek:function(){return A("startOfWeek","before")},focusEndOfWeek:function(){return A("endOfWeek","after")}};return e.jsx(Ir.Provider,{value:$,children:t.children})}function Na(){var t=m.useContext(Ir);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function Fo(t,r){var a=$r(),n=ba(t,a,r);return n}var _a=m.createContext(void 0);function Lo(t){if(!kt(t.initialProps)){var r={selected:void 0};return e.jsx(_a.Provider,{value:r,children:t.children})}return e.jsx(Oo,{initialProps:t.initialProps,children:t.children})}function Oo(t){var r=t.initialProps,a=t.children,n=function(o,c,u){var p,x,f;if((p=r.onDayClick)===null||p===void 0||p.call(r,o,c,u),c.selected&&!r.required){(x=r.onSelect)===null||x===void 0||x.call(r,void 0,o,c,u);return}(f=r.onSelect)===null||f===void 0||f.call(r,o,o,c,u)},i={selected:r.selected,onDayClick:n};return e.jsx(_a.Provider,{value:i,children:a})}function Yr(){var t=m.useContext(_a);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function To(t,r){var a=Z(),n=Yr(),i=ga(),o=wa(),c=Na(),u=c.focusDayAfter,p=c.focusDayBefore,x=c.focusWeekAfter,f=c.focusWeekBefore,g=c.blur,w=c.focus,S=c.focusMonthBefore,A=c.focusMonthAfter,$=c.focusYearBefore,E=c.focusYearAfter,U=c.focusStartOfWeek,V=c.focusEndOfWeek,Ce=function(D){var P,Ze,Ss,ks;kt(a)?(P=n.onDayClick)===null||P===void 0||P.call(n,t,r,D):zs(a)?(Ze=i.onDayClick)===null||Ze===void 0||Ze.call(i,t,r,D):qs(a)?(Ss=o.onDayClick)===null||Ss===void 0||Ss.call(o,t,r,D):(ks=a.onDayClick)===null||ks===void 0||ks.call(a,t,r,D)},rs=function(D){var P;w(t),(P=a.onDayFocus)===null||P===void 0||P.call(a,t,r,D)},Qe=function(D){var P;g(),(P=a.onDayBlur)===null||P===void 0||P.call(a,t,r,D)},Je=function(D){var P;(P=a.onDayMouseEnter)===null||P===void 0||P.call(a,t,r,D)},xs=function(D){var P;(P=a.onDayMouseLeave)===null||P===void 0||P.call(a,t,r,D)},_s=function(D){var P;(P=a.onDayPointerEnter)===null||P===void 0||P.call(a,t,r,D)},Cs=function(D){var P;(P=a.onDayPointerLeave)===null||P===void 0||P.call(a,t,r,D)},ps=function(D){var P;(P=a.onDayTouchCancel)===null||P===void 0||P.call(a,t,r,D)},Y=function(D){var P;(P=a.onDayTouchEnd)===null||P===void 0||P.call(a,t,r,D)},Q=function(D){var P;(P=a.onDayTouchMove)===null||P===void 0||P.call(a,t,r,D)},J=function(D){var P;(P=a.onDayTouchStart)===null||P===void 0||P.call(a,t,r,D)},Xe=function(D){var P;(P=a.onDayKeyUp)===null||P===void 0||P.call(a,t,r,D)},We=function(D){var P;switch(D.key){case"ArrowLeft":D.preventDefault(),D.stopPropagation(),a.dir==="rtl"?u():p();break;case"ArrowRight":D.preventDefault(),D.stopPropagation(),a.dir==="rtl"?p():u();break;case"ArrowDown":D.preventDefault(),D.stopPropagation(),x();break;case"ArrowUp":D.preventDefault(),D.stopPropagation(),f();break;case"PageUp":D.preventDefault(),D.stopPropagation(),D.shiftKey?$():S();break;case"PageDown":D.preventDefault(),D.stopPropagation(),D.shiftKey?E():A();break;case"Home":D.preventDefault(),D.stopPropagation(),U();break;case"End":D.preventDefault(),D.stopPropagation(),V();break}(P=a.onDayKeyDown)===null||P===void 0||P.call(a,t,r,D)},Gs={onClick:Ce,onFocus:rs,onBlur:Qe,onKeyDown:We,onKeyUp:Xe,onMouseEnter:Je,onMouseLeave:xs,onPointerEnter:_s,onPointerLeave:Cs,onTouchCancel:ps,onTouchEnd:Y,onTouchMove:Q,onTouchStart:J};return Gs}function Uo(){var t=Z(),r=Yr(),a=ga(),n=wa(),i=kt(t)?r.selected:zs(t)?a.selected:qs(t)?n.selected:void 0;return i}function Bo(t){return Object.values($e).includes(t)}function $o(t,r){var a=[t.classNames.day];return Object.keys(r).forEach(function(n){var i=t.modifiersClassNames[n];if(i)a.push(i);else if(Bo(n)){var o=t.classNames["day_".concat(n)];o&&a.push(o)}}),a}function Wo(t,r){var a=L({},t.styles.day);return Object.keys(r).forEach(function(n){var i;a=L(L({},a),(i=t.modifiersStyles)===null||i===void 0?void 0:i[n])}),a}function Io(t,r,a){var n,i,o,c=Z(),u=Na(),p=Fo(t,r),x=To(t,p),f=Uo(),g=!!(c.onDayClick||c.mode!=="default");m.useEffect(function(){var Je;p.outside||u.focusedDay&&g&&Ne(u.focusedDay,t)&&((Je=a.current)===null||Je===void 0||Je.focus())},[u.focusedDay,t,a,g,p.outside]);var w=$o(c,p).join(" "),S=Wo(c,p),A=!!(p.outside&&!c.showOutsideDays||p.hidden),$=(o=(i=c.components)===null||i===void 0?void 0:i.DayContent)!==null&&o!==void 0?o:oo,E=e.jsx($,{date:t,displayMonth:r,activeModifiers:p}),U={style:S,className:w,children:E,role:"gridcell"},V=u.focusTarget&&Ne(u.focusTarget,t)&&!p.outside,Ce=u.focusedDay&&Ne(u.focusedDay,t),rs=L(L(L({},U),(n={disabled:p.disabled,role:"gridcell"},n["aria-selected"]=p.selected,n.tabIndex=Ce||V?0:-1,n)),x),Qe={isButton:g,isHidden:A,activeModifiers:p,selectedDays:f,buttonProps:rs,divProps:U};return Qe}function Yo(t){var r=m.useRef(null),a=Io(t.date,t.displayMonth,r);return a.isHidden?e.jsx("div",{role:"gridcell"}):a.isButton?e.jsx(St,L({name:"day",ref:r},a.buttonProps)):e.jsx("div",L({},a.divProps))}function Vo(t){var r=t.number,a=t.dates,n=Z(),i=n.onWeekNumberClick,o=n.styles,c=n.classNames,u=n.locale,p=n.labels.labelWeekNumber,x=n.formatters.formatWeekNumber,f=x(Number(r),{locale:u});if(!i)return e.jsx("span",{className:c.weeknumber,style:o.weeknumber,children:f});var g=p(Number(r),{locale:u}),w=function(S){i(r,a,S)};return e.jsx(St,{name:"week-number","aria-label":g,className:c.weeknumber,style:o.weeknumber,onClick:w,children:f})}function zo(t){var r,a,n=Z(),i=n.styles,o=n.classNames,c=n.showWeekNumber,u=n.components,p=(r=u?.Day)!==null&&r!==void 0?r:Yo,x=(a=u?.WeekNumber)!==null&&a!==void 0?a:Vo,f;return c&&(f=e.jsx("td",{className:o.cell,style:i.cell,children:e.jsx(x,{number:t.weekNumber,dates:t.dates})})),e.jsxs("tr",{className:o.row,style:i.row,children:[f,t.dates.map(function(g){return e.jsx("td",{className:o.cell,style:i.cell,role:"presentation",children:e.jsx(p,{displayMonth:t.displayMonth,date:g})},jl(g))})]})}function gr(t,r,a){for(var n=a?.ISOWeek?Rr(r):fa(r,a),i=a?.ISOWeek?xa(t):Ys(t,a),o=as(n,i),c=[],u=0;u<=o;u++)c.push(be(i,u));var p=c.reduce(function(x,f){var g=a?.ISOWeek?Hi(f):Ki(f,a),w=x.find(function(S){return S.weekNumber===g});return w?(w.dates.push(f),x):(x.push({weekNumber:g,dates:[f]}),x)},[]);return p}function qo(t,r){var a=gr(_e(t),pa(t),r);if(r?.useFixedWeeks){var n=yl(t,r);if(n<6){var i=a[a.length-1],o=i.dates[i.dates.length-1],c=da(o,6-n),u=gr(da(o,1),c,r);a.push.apply(a,u)}}return a}function Ho(t){var r,a,n,i=Z(),o=i.locale,c=i.classNames,u=i.styles,p=i.hideHead,x=i.fixedWeeks,f=i.components,g=i.weekStartsOn,w=i.firstWeekContainsDate,S=i.ISOWeek,A=qo(t.displayMonth,{useFixedWeeks:!!x,ISOWeek:S,locale:o,weekStartsOn:g,firstWeekContainsDate:w}),$=(r=f?.Head)!==null&&r!==void 0?r:lo,E=(a=f?.Row)!==null&&a!==void 0?a:zo,U=(n=f?.Footer)!==null&&n!==void 0?n:ro;return e.jsxs("table",{id:t.id,className:c.table,style:u.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!p&&e.jsx($,{}),e.jsx("tbody",{className:c.tbody,style:u.tbody,children:A.map(function(V){return e.jsx(E,{displayMonth:t.displayMonth,dates:V.dates,weekNumber:V.weekNumber},V.weekNumber)})}),e.jsx(U,{displayMonth:t.displayMonth})]})}function Ko(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Go=Ko()?m.useLayoutEffect:m.useEffect,oa=!1,Qo=0;function yr(){return"react-day-picker-".concat(++Qo)}function Jo(t){var r,a=t??(oa?yr():null),n=m.useState(a),i=n[0],o=n[1];return Go(function(){i===null&&o(yr())},[]),m.useEffect(function(){oa===!1&&(oa=!0)},[]),(r=t??i)!==null&&r!==void 0?r:void 0}function Xo(t){var r,a,n=Z(),i=n.dir,o=n.classNames,c=n.styles,u=n.components,p=Hs().displayMonths,x=Jo(n.id?"".concat(n.id,"-").concat(t.displayIndex):void 0),f=n.id?"".concat(n.id,"-grid-").concat(t.displayIndex):void 0,g=[o.month],w=c.month,S=t.displayIndex===0,A=t.displayIndex===p.length-1,$=!S&&!A;i==="rtl"&&(r=[S,A],A=r[0],S=r[1]),S&&(g.push(o.caption_start),w=L(L({},w),c.caption_start)),A&&(g.push(o.caption_end),w=L(L({},w),c.caption_end)),$&&(g.push(o.caption_between),w=L(L({},w),c.caption_between));var E=(a=u?.Caption)!==null&&a!==void 0?a:ao;return e.jsxs("div",{className:g.join(" "),style:w,children:[e.jsx(E,{id:x,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(Ho,{id:f,"aria-labelledby":x,displayMonth:t.displayMonth})]},t.displayIndex)}function Zo(t){var r=Z(),a=r.classNames,n=r.styles;return e.jsx("div",{className:a.months,style:n.months,children:t.children})}function ec(t){var r,a,n=t.initialProps,i=Z(),o=Na(),c=Hs(),u=m.useState(!1),p=u[0],x=u[1];m.useEffect(function(){i.initialFocus&&o.focusTarget&&(p||(o.focus(o.focusTarget),x(!0)))},[i.initialFocus,p,o.focus,o.focusTarget,o]);var f=[i.classNames.root,i.className];i.numberOfMonths>1&&f.push(i.classNames.multiple_months),i.showWeekNumber&&f.push(i.classNames.with_weeknumber);var g=L(L({},i.styles.root),i.style),w=Object.keys(n).filter(function(A){return A.startsWith("data-")}).reduce(function(A,$){var E;return L(L({},A),(E={},E[$]=n[$],E))},{}),S=(a=(r=n.components)===null||r===void 0?void 0:r.Months)!==null&&a!==void 0?a:Zo;return e.jsx("div",L({className:f.join(" "),style:g,dir:i.dir,id:i.id,nonce:n.nonce,title:n.title,lang:n.lang},w,{children:e.jsx(S,{children:c.displayMonths.map(function(A,$){return e.jsx(Xo,{displayIndex:$,displayMonth:A},$)})})}))}function sc(t){var r=t.children,a=_l(t,["children"]);return e.jsx(Yl,{initialProps:a,children:e.jsx(Zl,{children:e.jsx(Lo,{initialProps:a,children:e.jsx(co,{initialProps:a,children:e.jsx(ho,{initialProps:a,children:e.jsx(wo,{children:e.jsx(Eo,{children:r})})})})})})})}function tc(t){return e.jsx(sc,L({},t,{children:e.jsx(ec,{initialProps:t})}))}function ma({className:t,classNames:r,showOutsideDays:a=!0,...n}){return e.jsx(tc,{showOutsideDays:a,className:bs("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:bs(Ka({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:bs(Ka({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:({...i})=>e.jsx(ji,{className:"h-4 w-4"}),IconRight:({...i})=>e.jsx(vi,{className:"h-4 w-4"})},...n})}ma.displayName="Calendar";var Dt="Popover",[Vr]=wi(Dt,[Cr]),Ks=Cr(),[ac,os]=Vr(Dt),zr=t=>{const{__scopePopover:r,children:a,open:n,defaultOpen:i,onOpenChange:o,modal:c=!1}=t,u=Ks(r),p=m.useRef(null),[x,f]=m.useState(!1),[g,w]=gi({prop:n,defaultProp:i??!1,onChange:o,caller:Dt});return e.jsx(yi,{...u,children:e.jsx(ac,{scope:r,contentId:bi(),triggerRef:p,open:g,onOpenChange:w,onOpenToggle:m.useCallback(()=>w(S=>!S),[w]),hasCustomAnchor:x,onCustomAnchorAdd:m.useCallback(()=>f(!0),[]),onCustomAnchorRemove:m.useCallback(()=>f(!1),[]),modal:c,children:a})})};zr.displayName=Dt;var qr="PopoverAnchor",rc=m.forwardRef((t,r)=>{const{__scopePopover:a,...n}=t,i=os(qr,a),o=Ks(a),{onCustomAnchorAdd:c,onCustomAnchorRemove:u}=i;return m.useEffect(()=>(c(),()=>u()),[c,u]),e.jsx(Dr,{...o,...n,ref:r})});rc.displayName=qr;var Hr="PopoverTrigger",Kr=m.forwardRef((t,r)=>{const{__scopePopover:a,...n}=t,i=os(Hr,a),o=Ks(a),c=Sr(r,i.triggerRef),u=e.jsx(kr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":Zr(i.open),...n,ref:c,onClick:Ws(t.onClick,i.onOpenToggle)});return i.hasCustomAnchor?u:e.jsx(Dr,{asChild:!0,...o,children:u})});Kr.displayName=Hr;var Ca="PopoverPortal",[nc,ic]=Vr(Ca,{forceMount:void 0}),Gr=t=>{const{__scopePopover:r,forceMount:a,children:n,container:i}=t,o=os(Ca,r);return e.jsx(nc,{scope:r,forceMount:a,children:e.jsx(Pr,{present:a||o.open,children:e.jsx(Ni,{asChild:!0,container:i,children:n})})})};Gr.displayName=Ca;var Ns="PopoverContent",Qr=m.forwardRef((t,r)=>{const a=ic(Ns,t.__scopePopover),{forceMount:n=a.forceMount,...i}=t,o=os(Ns,t.__scopePopover);return e.jsx(Pr,{present:n||o.open,children:o.modal?e.jsx(oc,{...i,ref:r}):e.jsx(cc,{...i,ref:r})})});Qr.displayName=Ns;var lc=Si("PopoverContent.RemoveScroll"),oc=m.forwardRef((t,r)=>{const a=os(Ns,t.__scopePopover),n=m.useRef(null),i=Sr(r,n),o=m.useRef(!1);return m.useEffect(()=>{const c=n.current;if(c)return _i(c)},[]),e.jsx(Ci,{as:lc,allowPinchZoom:!0,children:e.jsx(Jr,{...t,ref:i,trapFocus:a.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ws(t.onCloseAutoFocus,c=>{c.preventDefault(),o.current||a.triggerRef.current?.focus()}),onPointerDownOutside:Ws(t.onPointerDownOutside,c=>{const u=c.detail.originalEvent,p=u.button===0&&u.ctrlKey===!0,x=u.button===2||p;o.current=x},{checkForDefaultPrevented:!1}),onFocusOutside:Ws(t.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})})}),cc=m.forwardRef((t,r)=>{const a=os(Ns,t.__scopePopover),n=m.useRef(!1),i=m.useRef(!1);return e.jsx(Jr,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{t.onCloseAutoFocus?.(o),o.defaultPrevented||(n.current||a.triggerRef.current?.focus(),o.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:o=>{t.onInteractOutside?.(o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const c=o.target;a.triggerRef.current?.contains(c)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),Jr=m.forwardRef((t,r)=>{const{__scopePopover:a,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:c,onEscapeKeyDown:u,onPointerDownOutside:p,onFocusOutside:x,onInteractOutside:f,...g}=t,w=os(Ns,a),S=Ks(a);return ki(),e.jsx(Di,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:o,children:e.jsx(Pi,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:f,onEscapeKeyDown:u,onPointerDownOutside:p,onFocusOutside:x,onDismiss:()=>w.onOpenChange(!1),children:e.jsx(Mi,{"data-state":Zr(w.open),role:"dialog",id:w.contentId,...S,...g,ref:r,style:{...g.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Xr="PopoverClose",dc=m.forwardRef((t,r)=>{const{__scopePopover:a,...n}=t,i=os(Xr,a);return e.jsx(kr.button,{type:"button",...n,ref:r,onClick:Ws(t.onClick,()=>i.onOpenChange(!1))})});dc.displayName=Xr;var uc="PopoverArrow",mc=m.forwardRef((t,r)=>{const{__scopePopover:a,...n}=t,i=Ks(a);return e.jsx(Ai,{...i,...n,ref:r})});mc.displayName=uc;function Zr(t){return t?"open":"closed"}var hc=zr,xc=Kr,pc=Gr,en=Qr;const wr=hc,br=xc,ha=m.forwardRef(({className:t,align:r="center",sideOffset:a=4,...n},i)=>e.jsx(pc,{children:e.jsx(en,{ref:i,align:r,sideOffset:a,className:bs("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));ha.displayName=en.displayName;const fc=t=>{const r=t?.role==="super_admin",a=t?.role==="admin"||r,n=t?.role==="moderator",i={canViewUsers:a||t?.permissions?.can_manage_users,canBanUsers:a,canSuspendUsers:a||t?.permissions?.can_manage_users,canDeleteUsers:a,canManageBanners:a||t?.permissions?.can_manage_banners,canViewBanners:!0,canViewProducts:!0,canApproveProducts:a||t?.permissions?.can_manage_products,canRejectProducts:a||t?.permissions?.can_manage_products,canFeatureProducts:a,canVerifyProducts:a,canDeleteProducts:a,canEditProducts:a,canViewCategories:!0,canManageCategories:a||t?.permissions?.can_manage_categories,canViewReports:!0,canResolveReports:a||t?.permissions?.can_manage_reports,canDeleteReports:a,canViewSubscriptions:a||t?.permissions?.can_manage_subscriptions,canManageSubscriptions:a,canViewAdmins:a,canManageAdmins:r,canViewAnalytics:a||t?.permissions?.can_access_analytics,canManageSystem:a||t?.permissions?.can_manage_system,canBackupSystem:a,canExportData:a||t?.permissions?.can_export_data,canSendEmails:a||t?.permissions?.can_send_emails,canPerformBulkActions:a||t?.permissions?.can_perform_bulk_actions};return{isSuperAdmin:r,isAdmin:a,isModerator:n,permissions:i}};function od(){const t=Ri(),[r,a]=m.useState({totalUsers:0,totalProducts:0,pendingProducts:0,approvedProducts:0,featuredProducts:0,totalCategories:0,totalReviews:0,totalSubscriptions:0,activeSubscriptions:0,totalRevenue:0,userEngagement:0,todayRegistrations:0,weeklyGrowth:0,systemHealth:100,pendingReports:0,unreadMessages:0,serverLoad:0,databaseSize:"0 MB"}),[n,i]=m.useState([]),[o,c]=m.useState([]),[u,p]=m.useState([]),[x,f]=m.useState([]),[g,w]=m.useState([]),[S,A]=m.useState([]),[$,E]=m.useState([]),[U,V]=m.useState(null),[Ce,rs]=m.useState([]),[Qe,Je]=m.useState([]),[xs,_s]=m.useState([]),[Cs,ps]=m.useState([]),[Y,Q]=m.useState(!1),[J,Xe]=m.useState(),[We,Gs]=m.useState(),[D,P]=m.useState("transactions"),[Ze,Ss]=m.useState([]),[ks,Qs]=m.useState(!1),[ns,sn]=m.useState(null),[tn,Ds]=m.useState(!0),[Oe,an]=m.useState(""),[rn,Js]=m.useState("overview"),[Pt,nn]=m.useState("all"),[Xs,ln]=m.useState(""),[on,Zs]=m.useState(!1),[ve,Sa]=m.useState(null),[Re,et]=m.useState({status:"active",notes:""}),[ka,cn]=m.useState(""),[dn,vc]=m.useState(""),[un,Mt]=m.useState(!1),[ye,mn]=m.useState(null),[Ee,Ps]=m.useState([]),[Ie,Ms]=m.useState([]),[hn,xn]=m.useState([]),[pn,As]=m.useState(!1),[ae,fn]=m.useState(null),[vn,jn]=m.useState(!1),[ne,jc]=m.useState(null),[gn,st]=m.useState(!1),[yn,Rs]=m.useState(!1),[wn,Es]=m.useState(!1),[bn,Fs]=m.useState(!1),[Nn,Ls]=m.useState(!1),[_n,tt]=m.useState(!1),[Cn,At]=m.useState(!1),[Sn,at]=m.useState(!1),[kn,rt]=m.useState(!1),[Dn,nt]=m.useState(!1),[Pn,Rt]=m.useState(!1),[Mn,Os]=m.useState(!1),[it,Et]=m.useState(null),[lt,Ft]=m.useState(null),[ot,Lt]=m.useState(null),[z,Ot]=m.useState(null),[Tt,Da]=m.useState(""),[Ut,Pa]=m.useState(""),[Ma,Aa]=m.useState("7"),[Bt,Ra]=m.useState(""),[$t,Ea]=m.useState(""),[Wt,An]=m.useState("moderator"),[Fa,Rn]=m.useState({can_manage_users:!0,can_manage_products:!0,can_manage_categories:!1,can_manage_reports:!0,can_manage_subscriptions:!1,can_view_analytics:!1,can_manage_system:!1,can_manage_banners:!1,can_export_data:!1,can_send_emails:!1,can_perform_bulk_actions:!1}),[cs,fs]=m.useState({name:"",description:"",parent_id:"",is_active:!0,order_index:0,properties:"{}"}),[we,Ye]=m.useState([]),[gc,yc]=m.useState(""),[je,vs]=m.useState(null),[es,En]=m.useState(""),[ie,xe]=m.useState({auto_approve_products:!1,require_email_verification:!0,allow_new_signups:!0,enable_maintenance_mode:!1,max_products_per_user:50,platform_commission:5,currency:"KES",support_email:"support@sellhubshop.com",enable_analytics:!0,auto_backup:!0,backup_frequency:"daily"}),[is,Ts]=m.useState({type:"welcome",subject:"",content:"",recipients:"all"}),[ct,It]=m.useState({include_media:!0,include_database:!0,backup_type:"full"}),[T,Yt]=m.useState({}),{toast:y}=_r(),{isSuperAdmin:js,isAdmin:La,isModerator:Fn,permissions:j}=fc(ns),Ln=()=>[{value:"overview",label:"Overview",icon:Li},{value:"products",label:"Products",icon:gt},{value:"pending",label:"Pending",icon:Kt},{value:"users",label:"Users",icon:sa},{value:"categories",label:"Categories",icon:Oi},{value:"banners",label:"Banners",icon:$i},{value:"reports",label:"Reports",icon:mr},{value:"subscriptions",label:"Subscriptions",icon:Ga},{value:"withdrawals",label:"Wallets",icon:Ti},{value:"admins",label:"Admins",icon:_t},{value:"analytics",label:"Analytics",icon:il},{value:"system",label:"System",icon:Xa},{value:"security",label:"Security",icon:aa},{value:"health",label:"System Health",icon:rr}].filter(l=>{switch(l.value){case"users":return j.canViewUsers;case"subscriptions":return j.canViewSubscriptions;case"admins":return j.canViewAdmins;case"analytics":return j.canViewAnalytics;case"system":return j.canManageSystem;case"banners":return j.canViewBanners;case"security":return j.canManageSystem;default:return!0}});m.useEffect(()=>{console.log("AdminDashboard mounted"),On()},[]);const O=(s,l)=>{Yt(d=>({...d,[s]:l}))},On=async()=>{try{const{data:{user:s}}=await b.auth.getUser();if(!s){Qs(!1),Ds(!1);return}const{data:l}=await b.from("admin_users").select("*").eq("user_id",s.id).single();if(l){const{data:d}=await b.from("profiles").select("email, full_name").eq("id",l.user_id).single();sn({...l,role:l.role,email:d?.email,full_name:d?.full_name}),Qs(!0),await dt()}else Qs(!1),Ds(!1)}catch(s){console.error("Error checking admin status:",s),Qs(!1),Ds(!1)}},dt=async()=>{try{console.log("Starting loadDashboardData..."),Ds(!0);const[s,l,d,h,k,F,B,X,G,ge,Bs,M]=await Promise.all([gs(),ut(),ds(),us(),Vt(),mt(),Oa(),Tn(),Ta(),Bn(),Kn(),Un()]);console.log("Data loaded successfully:",{statsData:s,usersCount:d.length}),a(s),i(l),p(d),c(h),f(k),w(F),A(B),E(X),V(G),rs(ge),Je(Bs),Ss(M)}catch(s){console.error("Error loading dashboard data:",s),y({variant:"destructive",title:"Loading Error",description:"Failed to load dashboard data"})}finally{Ds(!1),console.log("loadDashboardData finished, isLoading set to false")}};m.useEffect(()=>{const s=()=>{const l=Array.from({length:6},(k,F)=>{const B=new Date;return B.setMonth(B.getMonth()-(5-F)),{name:B.toLocaleString("default",{month:"short"}),monthIdx:B.getMonth(),year:B.getFullYear()}}),d=l.map(k=>{const B=Ze.filter(X=>{const G=new Date(X.created_at);return G.getMonth()===k.monthIdx&&G.getFullYear()===k.year&&(X.status==="completed"||X.status==="active"||X.status==="paid")}).reduce((X,G)=>X+(Number(G.amount)||0),0);return{name:k.name,revenue:B}});_s(d);const h=l.map(k=>{const F=u.filter(B=>{const X=new Date(B.joined_at||new Date().toISOString());return X.getMonth()===k.monthIdx&&X.getFullYear()===k.year});return{name:k.name,users:F.length}});ps(h)};(Ze.length>0||u.length>0)&&s()},[Ze,u]);const gs=async()=>{try{const[s,l,d,h,k,F,B,X,G,ge,Bs,M]=await Promise.all([b.from("profiles").select("*",{count:"exact",head:!0}),b.from("products").select("*",{count:"exact",head:!0}),b.from("products").select("*",{count:"exact",head:!0}).eq("status","pending"),b.from("products").select("*",{count:"exact",head:!0}).in("status",["active","approved"]),b.from("products").select("*",{count:"exact",head:!0}).eq("featured",!0),b.from("categories").select("*",{count:"exact",head:!0}),b.from("subscriptions").select("*",{count:"exact",head:!0}),b.from("subscriptions").select("*",{count:"exact",head:!0}).eq("status","active"),b.from("reports").select("*",{count:"exact",head:!0}).eq("status","pending"),b.from("messages").select("*",{count:"exact",head:!0}).eq("is_read",!1),b.from("profiles").select("*",{count:"exact",head:!0}).gte("created_at",new Date(new Date().setHours(0,0,0,0)).toISOString()),b.from("orders").select("price").eq("status","completed")]),{data:le,error:ms}=await b.from("products").select("owner_id"),pt=new Set((le||[]).map(Ht=>Ht.owner_id)).size,ci=s.count?pt/s.count*100:0,di=M.data?.reduce((Ht,ui)=>Ht+(Number(ui.price)||0),0)||0;return{totalUsers:s.count||0,totalProducts:l.count||0,pendingProducts:d.count||0,approvedProducts:h.count||0,featuredProducts:k.count||0,totalCategories:F.count||0,totalReviews:0,totalSubscriptions:B.count||0,activeSubscriptions:X.count||0,totalRevenue:di,userEngagement:ci,todayRegistrations:Bs.count||0,weeklyGrowth:12.5,systemHealth:100,pendingReports:G.count||0,unreadMessages:ge.count||0,serverLoad:45,databaseSize:"2.3 MB"}}catch(s){return console.error("Error loading platform stats:",s),{totalUsers:0,totalProducts:0,pendingProducts:0,approvedProducts:0,featuredProducts:0,totalCategories:0,totalReviews:0,totalSubscriptions:0,activeSubscriptions:0,totalRevenue:0,userEngagement:0,todayRegistrations:0,weeklyGrowth:0,systemHealth:100,pendingReports:0,unreadMessages:0,serverLoad:0,databaseSize:"0 MB"}}},ut=async()=>{try{const{data:s,error:l}=await b.from("categories").select("*, products!category_id(count)").order("order_index",{ascending:!0});if(l)throw l;return(s||[]).map(d=>({...d,product_count:d.products?.[0]?.count||0}))}catch(s){return console.error("Error loading categories:",s),[]}},ds=async()=>{try{const{data:s,error:l}=await b.from("profiles").select("*, products!owner_id(count), reviews!reviewer_id(count)").order("created_at",{ascending:!1});if(l)throw l;return(s||[]).map(d=>({...d,products_count:d.products?.[0]?.count||0,reviews_count:d.reviews?.[0]?.count||0}))}catch(s){return console.error("Error loading users:",s),[]}},us=async()=>{try{const{data:s,error:l}=await b.from("products").select(`
          *,
          profiles:owner_id(email, full_name),
          categories:category_id(name),
          reviews(count)
        `).order("created_at",{ascending:!1});if(l)throw l;return(s||[]).map(d=>({...d,seller_email:d.profiles?.email,seller_name:d.profiles?.full_name,category_name:d.categories?.name,reviews_count:d.reviews?.[0]?.count||0}))}catch(s){return console.error("Error loading products:",s),[]}},Vt=async()=>{try{Yt(h=>({...h,admins:!0}));const d=await(await fetch("https://sellhubshop-backend.onrender.com/api/admin/list")).json();if(!d.success)throw new Error(d.error||"Failed to fetch admin list");return console.log("Backend admin list:",d.data),d.data||[]}catch(s){return console.error("Error loading admin users:",s),y({title:"Sync Error",description:"Could not load admin list. check console.",variant:"destructive"}),[]}finally{Yt(s=>({...s,admins:!1}))}},Oa=async()=>{try{const{data:s,error:l}=await b.from("reports").select("*").order("created_at",{ascending:!1});if(l)throw l;const d=await Promise.all((s||[]).map(async h=>{try{const{data:k,error:F}=await b.from("profiles").select("email, full_name, avatar_url").eq("id",h.reporter_id).single();F&&console.error("Error fetching reporter:",F);let B=null,X=null,G=null;if(h.reported_id){const{data:le,error:ms}=await b.from("products").select("*").eq("id",h.reported_id).single();if(!ms&&le){if(B=le,le.category_id){const{data:ss}=await b.from("categories").select("name").eq("id",le.category_id).single();X=ss}if(le.owner_id){const{data:ss}=await b.from("profiles").select("full_name, email").eq("id",le.owner_id).single();G=ss}}}let ge="low";const M=(Date.now()-new Date(h.created_at).getTime())/(1e3*60*60);return M<24?ge="high":M<72&&(ge="medium"),(B?.featured||B?.verified)&&(ge="high"),{...h,reporter_email:k?.email,reporter_name:k?.full_name,reporter_avatar:k?.avatar_url,product_name:B?.name,product_description:B?.description,product_price:B?.price,product_images:B?.images||[],product_category_name:X?.name,product_status:B?.status,product_created_at:B?.created_at,product_verified:B?.verified,product_featured:B?.featured,seller_name:G?.full_name,seller_email:G?.email,has_description:!!h.description,description_length:h.description?.length||0,priority:ge}}catch(k){return console.error("Error processing report:",h.id,k),{...h,reported_id:h.reported_id,priority:"low",product_images:[]}}}));return console.log("Loaded reports:",d.map(h=>({id:h.id,product_name:h.product_name,has_images:h.product_images?.length>0,reporter_email:h.reporter_email}))),d}catch(s){return console.error("Error loading reports:",s),[]}},Tn=async()=>{try{return[{date:"Mon",revenue:12e3,orders:8},{date:"Tue",revenue:19e3,orders:12},{date:"Wed",revenue:15e3,orders:10},{date:"Thu",revenue:22e3,orders:14},{date:"Fri",revenue:28e3,orders:18},{date:"Sat",revenue:35e3,orders:22},{date:"Sun",revenue:3e4,orders:20}]}catch(s){return console.error("Error loading revenue data:",s),[]}},Ta=async()=>{try{return{database_size:"2.3 MB",active_connections:15,server_uptime:"15 days",cache_hit_rate:92.5,last_backup:new Date().toISOString(),storage_used:"1.2 GB",memory_usage:65}}catch(s){return console.error("Error loading system health:",s),{database_size:"0 MB",active_connections:0,server_uptime:"0 days",cache_hit_rate:0,last_backup:null,storage_used:"0 GB",memory_usage:0}}},mt=async()=>{try{const{data:s,error:l}=await b.from("subscriptions").select(`
          id,
          user_id,
          plan_id,
          plan_name,
          amount,
          status,
          created_at,
          customer_name,
          mpesa_receipt_number,
          payment_method,
          profiles:user_id (
             email,
             full_name
          )
        `).order("created_at",{ascending:!1});if(l){console.error("Error loading subscriptions with join:",l);const{data:h,error:k}=await b.from("subscriptions").select("*").order("created_at",{ascending:!1});return k?(console.error("Fallback fetch failed:",k),[]):(h||[]).map(F=>({id:F.id,user_id:F.user_id,plan_id:F.plan_id,status:F.status||"active",current_period_end:F.created_at?new Date(new Date(F.created_at).setMonth(new Date(F.created_at).getMonth()+1)).toISOString():new Date().toISOString(),user_email:F.customer_name||"Unknown",user_name:F.customer_name||"N/A",plan_name:F.plan_name||"Unknown Plan",price_monthly:F.amount||0,features:{},created_at:F.created_at,mpesa_receipt_number:F.mpesa_receipt_number,payment_method:F.payment_method}))}const d=(s||[]).map(h=>({id:h.id,user_id:h.user_id,plan_id:h.plan_id,status:h.status||"active",current_period_end:new Date(new Date(h.created_at).setMonth(new Date(h.created_at).getMonth()+1)).toISOString(),user_email:h.profiles?.email||h.customer_name||"Unknown",user_name:h.customer_name||h.profiles?.full_name||"N/A",plan_name:h.plan_name||"Unknown Plan",price_monthly:h.amount||0,features:{},created_at:h.created_at}));return console.log("Loaded subscriptions with join:",d.length),d}catch(s){return console.error("Error in loadSubscriptions:",s),[]}},Un=async()=>{try{let s=[];const{data:l,error:d}=await b.from("subscriptions").select(`
          id,
          user_id,
          amount,
          status,
          created_at,
          customer_name,
          plan_name,
          mpesa_receipt_number,
          checkout_request_id,
          payment_method,
          profiles:user_id (
             email,
             full_name
          )
        `).order("created_at",{ascending:!1});if(d){console.error("Complex transaction fetch failed, trying fallback:",d);const{data:M,error:le}=await b.from("subscriptions").select("*").order("created_at",{ascending:!1});le?console.error("Simple transaction fetch failed:",le):s=M||[]}else s=l||[];let h=[];const{data:k,error:F}=await b.from("billing_history").select(`
          id,
          user_id,
          amount,
          status,
          created_at,
          mpesa_receipt_number,
          payment_method,
          profiles:user_id (
             email,
             full_name
          )
        `).order("created_at",{ascending:!1});if(F){console.warn("Complex billing fetch failed, trying fallback:",F);const{data:M}=await b.from("billing_history").select("*").order("created_at",{ascending:!1});h=M||[]}else h=k||[];const B=s.map(M=>({id:M.id,user_id:M.user_id,user_email:M.profiles?.email||M.customer_name||"Unknown",user_name:M.customer_name||M.profiles?.full_name||"N/A",amount:M.amount,currency:"KES",status:M.status,description:`Subscription: ${M.plan_name||"Plan"}`,payment_method:M.payment_method||"mpesa",mpesa_receipt_number:M.mpesa_receipt_number||M.checkout_request_id,created_at:M.created_at,source:"subscription"})),X=h.map(M=>({id:M.id,user_id:M.user_id,user_email:M.profiles?.email||"Unknown",user_name:M.profiles?.full_name||"N/A",amount:M.amount,currency:"KES",status:M.status,description:"Billing History Record",payment_method:M.payment_method||"mpesa",mpesa_receipt_number:M.mpesa_receipt_number,created_at:M.created_at,source:"billing_history"})),G=new Map,ge=new Map;return X.forEach(M=>{const le=M.mpesa_receipt_number||M.id;if(G.set(le,M),M.created_at){const ms=new Date(M.created_at).toISOString().slice(0,16),ss=`${M.user_id}-${M.amount}-${ms}`;ge.set(ss,le)}}),B.forEach(M=>{if(M.mpesa_receipt_number&&!G.has(M.mpesa_receipt_number)){if(M.created_at){const le=new Date(M.created_at).toISOString().slice(0,16),ms=`${M.user_id}-${M.amount}-${le}`;if(ge.has(ms)){const ss=ge.get(ms),pt=G.get(ss);pt&&!pt.mpesa_receipt_number&&G.delete(ss)}}G.set(M.mpesa_receipt_number,M)}}),Array.from(G.values()).sort((M,le)=>new Date(le.created_at).getTime()-new Date(M.created_at).getTime())}catch(s){return console.error("Error loading transactions:",s),y({variant:"destructive",title:"Critical Transaction Load Error",description:s.message}),[]}},Bn=async()=>{try{const{data:s,error:l}=await b.from("admin_actions").select("*").order("created_at",{ascending:!1}).limit(50);if(l)throw l;return await Promise.all((s||[]).map(async h=>{let k=h.details?.email||h.details?.admin_email;if(!k&&h.admin_id){const{data:F}=await b.from("profiles").select("email").eq("id",h.admin_id).single();if(F)k=F.email;else{const{data:B}=await b.from("admin_users").select("user_id").eq("id",h.admin_id).single();if(B){const{data:X}=await b.from("profiles").select("email").eq("id",B.user_id).single();k=X?.email}}}return{...h,admin_email:k}}))}catch(s){return console.error("Error loading admin actions:",s),[]}},Ua=async s=>{if(!j.canApproveProducts){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to approve products"});return}O(`approve-${s}`,!0);try{const{error:l}=await b.from("products").update({status:"approved",approved_by:ns?.id,approved_at:new Date().toISOString(),rejection_reason:null}).eq("id",s);if(l)throw l;console.log("Logging admin action: product_approve","product",s),await ee("product_approve","product",s),y({title:"Product Approved",description:"Product has been approved successfully"}),await us(),await gs()}catch(l){console.error("Error approving product:",l),y({variant:"destructive",title:"Approval Failed",description:l.message||"Failed to approve product"})}finally{O(`approve-${s}`,!1)}},$n=async(s,l)=>{if(!j.canRejectProducts){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to reject products"});return}O(`reject-${s}`,!0);try{const{error:d}=await b.from("products").update({status:"rejected",rejection_reason:l,approved_by:ns?.id,approved_at:new Date().toISOString()}).eq("id",s);if(d)throw d;console.log("Logging admin action: product_reject","product",s,{reason:l}),await ee("product_reject","product",s,{reason:l}),y({title:"Product Rejected",description:"Product has been rejected"}),Ra(""),Lt(null),Fs(!1),await us(),await gs()}catch(d){console.error("Error rejecting product:",d),y({variant:"destructive",title:"Rejection Failed",description:d.message||"Failed to reject product"})}finally{O(`reject-${s}`,!1)}},zt=async(s,l)=>{if(!j.canFeatureProducts){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to feature products"});return}O(`feature-${s}`,!0);try{const{error:d}=await b.from("products").update({featured:l}).eq("id",s);if(d)throw d;console.log("Logging admin action: product_feature","product",s,{featured:l}),await ee("product_feature","product",s,{featured:l}),y({title:"Success!",description:`Product ${l?"featured":"unfeatured"} successfully`}),await us()}catch(d){console.error("Error featuring product:",d),y({variant:"destructive",title:"Update Failed",description:d.message||"Failed to update product"})}finally{O(`feature-${s}`,!1)}},Ba=async(s,l)=>{if(!j.canVerifyProducts){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to verify products"});return}O(`verify-${s}`,!0);try{const{error:d}=await b.from("products").update({verified:l}).eq("id",s);if(d)throw d;console.log("Logging admin action: product_verify","product",s,{verified:l}),await ee("product_verify","product",s,{verified:l}),y({title:"Success!",description:`Product ${l?"verified":"unverified"} successfully`}),await us()}catch(d){console.error("Error verifying product:",d),y({variant:"destructive",title:"Update Failed",description:d.message||"Failed to update product"})}finally{O(`verify-${s}`,!1)}},$a=async s=>{if(!j.canDeleteProducts){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to delete products"});return}O(`delete-${s}`,!0);try{const{error:l}=await b.from("products").delete().eq("id",s);if(l)throw l;console.log("Logging admin action: product_delete","product",s),await ee("product_delete","product",s),y({title:"Product Deleted",description:"Product has been deleted successfully"}),await us(),await gs()}catch(l){console.error("Error deleting product:",l),y({variant:"destructive",title:"Deletion Failed",description:l.message||"Failed to delete product"})}finally{O(`delete-${s}`,!1)}},Wn=async(s,l)=>{if(!j.canBanUsers){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to ban users"});return}O(`ban-${s}`,!0);try{const{error:d}=await b.from("profiles").update({status:"banned",ban_reason:l,banned_at:new Date().toISOString()}).eq("id",s);if(d)throw d;console.log("Logging admin action: user_ban","user",s,{reason:l}),await ee("user_ban","user",s,{reason:l}),y({title:"User Banned",description:"User has been banned successfully"}),Da(""),Et(null),Rs(!1),await ds()}catch(d){console.error("Error banning user:",d),y({variant:"destructive",title:"Ban Failed",description:d.message||"Failed to ban user"})}finally{O(`ban-${s}`,!1)}},Wa=async s=>{if(!j.canBanUsers){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to unban users"});return}O(`unban-${s}`,!0);try{const{error:l}=await b.from("profiles").update({status:"active",ban_reason:null,banned_at:null}).eq("id",s);if(l)throw l;console.log("Logging admin action: user_unban","user",s),await ee("user_unban","user",s),y({title:"User Unbanned",description:"User has been unbanned successfully"}),await ds()}catch(l){console.error("Error unbanning user:",l),y({variant:"destructive",title:"Unban Failed",description:l.message||"Failed to unban user"})}finally{O(`unban-${s}`,!1)}},In=async(s,l,d)=>{if(!j.canSuspendUsers){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to suspend users"});return}O(`suspend-${s}`,!0);try{const h=new Date;h.setDate(h.getDate()+parseInt(d));const{error:k}=await b.from("profiles").update({status:"suspended",ban_reason:`Suspended: ${l} (${d} days)`,banned_at:new Date().toISOString()}).eq("id",s);if(k)throw k;console.log("Logging admin action: user_suspend","user",s,{reason:l,duration:d}),await ee("user_suspend","user",s,{reason:l,duration:d}),y({title:"User Suspended",description:`User has been suspended for ${d} days: ${l}`}),Pa(""),Aa("7"),Ft(null),Es(!1),await ds()}catch(h){console.error("Error suspending user:",h),y({variant:"destructive",title:"Suspension Failed",description:h.message||"Failed to suspend user"})}finally{O(`suspend-${s}`,!1)}},qt=async(s,l,d)=>{if(!j.canResolveReports){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to resolve reports"});return}O(`resolve-${s}`,!0);try{const{data:{user:h}}=await b.auth.getUser();if(!h){y({variant:"destructive",title:"Authentication Error",description:"You must be logged in to resolve reports"});return}const{data:k,error:F}=await b.from("profiles").select("id").eq("id",h.id).single();if(F||!k){y({variant:"destructive",title:"Profile Not Found",description:"Your admin profile is not properly set up. Please contact support."});return}const{error:B}=await b.from("reports").update({status:"resolved",resolved_by:h.id,resolved_at:new Date().toISOString()}).eq("id",s);if(B)throw B;console.log("Logging admin action: report_resolve","report",s,{action:l,notes:d}),await ee("report_resolve","report",s,{action:l,notes:d}),y({title:"Report Resolved",description:"Report has been marked as resolved"}),Ot(null),At(!1),await Oa(),await gs()}catch(h){console.error("Error resolving report:",h),h.code==="23503"&&h.message.includes("reports_resolved_by_fkey")?y({variant:"destructive",title:"Profile Error",description:"Your admin profile is missing. Please contact system administrator to fix this issue."}):y({variant:"destructive",title:"Resolution Failed",description:h.message||"Failed to resolve report"})}finally{O(`resolve-${s}`,!1)}},Yn=async(s,l)=>{if(!j.canManageAdmins){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to add admins"});return}O("add-admin",!0);try{const{data:d}=await b.from("profiles").select("id").eq("email",s.trim().toLowerCase()).single();if(!d)throw new Error("User must sign up first before being added as admin");const{data:h}=await b.from("admin_users").select("id").eq("user_id",d.id).single();if(h)throw new Error("User is already an admin");const k=crypto.randomUUID(),{error:F}=await b.from("admin_users").insert({id:k,user_id:d.id,email:s.trim().toLowerCase(),role:l,permissions:l==="super_admin"?{}:Fa,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(F)throw F;y({title:"Admin Added",description:`${s.trim()} has been added as a ${l}.`}),st(!1),Ea(""),Vt(),await ee("create","admin_user",k,{target_email:s,role:l,user_id:d.id})}catch(d){console.error("Error adding admin:",d),y({variant:"destructive",title:"Add Admin Failed",description:d.message||"Failed to add admin"})}finally{O("add-admin",!1)}},Vn=async s=>{if(!j.canManageAdmins){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to remove admins"});return}O(`remove-admin-${s}`,!0);try{const h=await(await fetch(`https://sellhubshop-backend.onrender.com/api/admin/remove/${s}`,{method:"DELETE"})).json();if(!h.success)throw new Error(h.error||"Failed to remove admin");await ee("admin_remove","admin",s),y({title:"Admin Removed",description:"Admin has been removed successfully"}),await Vt()}catch(l){console.error("Error removing admin:",l),y({variant:"destructive",title:"Remove Admin Failed",description:l.message||"Failed to remove admin"})}finally{O(`remove-admin-${s}`,!1)}},zn=async s=>{if(!j.canManageCategories){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to create categories"});return}O("create-category",!0);try{const{error:l}=await b.from("categories").insert({name:s.name,description:s.description,parent_id:s.parent_id||null,is_active:s.is_active,order_index:s.order_index,properties:s.properties});if(l)throw l;await ee("category_create","category","new",{name:s.name}),y({title:"Category Created",description:"Category has been created successfully"}),fs({name:"",description:"",parent_id:"",is_active:!0,order_index:0,properties:"{}"}),Ls(!1),await ut()}catch(l){console.error("Error creating category:",l),y({variant:"destructive",title:"Create Category Failed",description:l.message||"Failed to create category"})}finally{O("create-category",!1)}},qn=async(s,l)=>{if(!j.canManageCategories){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to update categories"});return}O(`update-category-${s}`,!0);try{const{error:d}=await b.from("categories").update(l).eq("id",s);if(d)throw d;await ee("category_update","category",s,{name:l.name}),y({title:"Category Updated",description:"Category has been updated successfully"}),vs(null),tt(!1),await ut()}catch(d){console.error("Error updating category:",d),y({variant:"destructive",title:"Update Category Failed",description:d.message||"Failed to update category"})}finally{O(`update-category-${s}`,!1)}},Hn=async s=>{if(!j.canManageCategories){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to delete categories"});return}O(`delete-category-${s}`,!0);try{const{count:l}=await b.from("products").select("*",{count:"exact",head:!0}).eq("category_id",s);if(l&&l>0)throw new Error(`Cannot delete category with ${l} products. Please reassign or delete the products first.`);const{error:d}=await b.from("categories").delete().eq("id",s);if(d)throw d;await ee("category_delete","category",s),y({title:"Category Deleted",description:"Category has been deleted successfully"}),await ut()}catch(l){console.error("Error deleting category:",l),y({variant:"destructive",title:"Delete Category Failed",description:l.message||"Failed to delete category"})}finally{O(`delete-category-${s}`,!1)}},ls=async(s,l,d)=>{if(!j.canPerformBulkActions){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to perform bulk actions"});return}if(d.length===0){y({variant:"destructive",title:"No Selection",description:"Please select items to perform bulk actions"});return}O(`bulk-${s}`,!0);try{switch(l){case"products":await ei(d,s);break;case"users":await ht(d,s);break;case"categories":if(s==="activate"){const{error:h}=await b.from("categories").update({is_active:!0}).in("id",d);if(h)throw h}else if(s==="deactivate"){const{error:h}=await b.from("categories").update({is_active:!1}).in("id",d);if(h)throw h}break}await ee(`bulk_${s}`,l,d.join(","),{count:d.length}),y({title:"Bulk Action Completed",description:`${s} performed on ${d.length} ${l}`}),Ms([]),Ps([]),xn([]),at(!1),await dt()}catch(h){console.error("Error performing bulk action:",h),y({variant:"destructive",title:"Bulk Action Failed",description:h.message||"Failed to perform bulk action"})}finally{O(`bulk-${s}`,!1)}},Kn=async()=>{try{const{data:s,error:l}=await b.from("withdrawals").select(`
          *,
          profiles:user_id (email, full_name)
        `).order("created_at",{ascending:!1});if(l)throw l;return s||[]}catch(s){return console.error("Error loading withdrawals:",s),[]}},Gn=async()=>{if(!j.canBackupSystem){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to backup the system"});return}O("system-backup",!0);try{await new Promise(s=>setTimeout(s,3e3)),await ee("system_backup","system","database",ct),y({title:"Backup Completed",description:"System backup has been completed successfully"}),Os(!1),await Ta()}catch(s){console.error("Error initiating backup:",s),y({variant:"destructive",title:"Backup Failed",description:s.message||"Failed to complete backup"})}finally{O("system-backup",!1)}},Qn=async()=>{if(!j.canSendEmails){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to send bulk emails"});return}O("bulk-email",!0);try{await new Promise(s=>setTimeout(s,2e3)),await ee("bulk_email","user","multiple",{template:is.type,recipients:is.recipients}),y({title:"Emails Sent",description:"Bulk emails have been queued for delivery"}),nt(!1),Ts({type:"welcome",subject:"",content:"",recipients:"all"})}catch(s){console.error("Error sending bulk emails:",s),y({variant:"destructive",title:"Email Failed",description:s.message||"Failed to send emails"})}finally{O("bulk-email",!1)}},Ia=async()=>{if(!j.canManageSystem){y({variant:"destructive",title:"Permission Denied",description:"You don't have permission to update system settings"});return}O("update-settings",!0);try{await new Promise(s=>setTimeout(s,1e3)),await ee("system_settings_update","system","all",ie),y({title:"Settings Saved",description:"System settings have been updated successfully"}),rt(!1)}catch(s){console.error("Error updating settings:",s),y({variant:"destructive",title:"Update Failed",description:s.message||"Failed to update settings"})}finally{O("update-settings",!1),O(`adjust-subscription-${ve.id}`,!1)}},Jn=async()=>{if(ve){O(`adjust-subscription-${ve.id}`,!0);try{const{data:s,error:l}=await b.from("profiles").select("email, plan_type").eq("id",ve.user_id).single();if(l)throw console.error("Error fetching profile:",l),new Error("Could not fetch user profile");const{data:d}=await b.from("plans").select("name, price").eq("id",ve.plan_id).single(),h={};Re.status==="active"&&d?h.plan_type=d.name.toLowerCase():(Re.status==="cancelled"||Re.status==="expired")&&(h.plan_type="free");const{error:k}=await b.from("profiles").update(h).eq("id",ve.user_id);if(k)throw console.error("Profile update error:",k),new Error(`Failed to update user profile: ${k.message}`);const F={status:Re.status};if(Re.status==="active"){const G=new Date;G.setMonth(G.getMonth()+1),F.current_period_end=G.toISOString()}const{error:B}=await b.from("subscriptions").update(F).eq("id",ve.id);if(B)throw console.error("Subscription update error:",B),new Error(`Failed to update subscription: ${B.message}`);await ee("subscription_adjust","subscription",ve.id,{previousStatus:ve.status,newStatus:Re.status,notes:Re.notes,userEmail:s?.email}),y({title:"Subscription Adjusted Successfully",description:`Updated ${s?.email}: Status: ${Re.status}`}),Zs(!1),Sa(null),et({status:"active",notes:""});const X=await mt();w(X),await ds()}catch(s){console.error("Error adjusting subscription:",s),y({variant:"destructive",title:"Adjustment Failed",description:s.message||"Failed to adjust subscription. Check console for details."})}finally{O(`adjust-subscription-${ve.id}`,!1)}}},Xn=async s=>{O(`sync-${s}`,!0);try{const{data:l,error:d}=await b.from("subscriptions").select(`
          plan_name,
          profiles:user_id (email)
        `).eq("id",s).single();if(d)throw d;await ee("subscription_sync","subscription",s,{plan:l?.plan_name}),y({title:"Subscription Synced",description:`Status verified for ${l?.profiles?.email}`});const h=await mt();w(h)}catch(l){console.error("Error syncing subscription:",l),y({variant:"destructive",title:"Sync Failed",description:l.message})}finally{O(`sync-${s}`,!1)}},Zn=async()=>{O("recalculate-all",!0);try{const{data:s,error:l}=await b.from("subscriptions").select(`
          user_id
        `).eq("status","active");if(l)throw l;let d=0;for(const h of s||[])d++;await ee("bulk_recalculate_limits","system","all",{subscriptionsUpdated:d}),y({title:"Limits Recalculated",description:`Updated limits for ${d} active subscriptions`}),await mt(),await ds()}catch(s){console.error("Error recalculating limits:",s),y({variant:"destructive",title:"Recalculation Failed",description:s.message})}finally{O("recalculate-all",!1)}},ht=async(s,l)=>{O("bulk-user-action",!0);try{let d={},h="";switch(l){case"verify":d={verified:!0},h="verified";break;case"unverify":d={verified:!1},h="unverified";break;case"activate":d={status:"active",ban_reason:null,banned_at:null},h="activated";break;case"upgrade_to_premium":d={plan_type:"premium"},h="upgraded to premium";break;default:throw new Error("Invalid action")}const{error:k}=await b.from("profiles").update(d).in("id",s);if(k)throw k;await ee("bulk_user_action","user","multiple",{userIds:s,action:l,count:s.length}),y({title:"Bulk Action Complete",description:`${s.length} users ${h}`}),await ds()}catch(d){console.error("Error in bulk user action:",d),y({variant:"destructive",title:"Bulk Action Failed",description:d.message})}finally{O("bulk-user-action",!1)}},ei=async(s,l)=>{O("bulk-product-action",!0);try{let d={},h="";switch(l){case"approve":d={status:"active",approved_at:new Date().toISOString(),approved_by:ns?.id},h="approved";break;case"feature":d={featured:!0},h="featured";break;case"unfeature":d={featured:!1},h="unfeatured";break;case"verify":d={verified:!0},h="verified";break;default:throw new Error("Invalid action")}const{error:k}=await b.from("products").update(d).in("id",s);if(k)throw k;await ee("bulk_product_action","product","multiple",{productIds:s,action:l,count:s.length}),y({title:"Bulk Product Action Complete",description:`${s.length} products ${h}`}),await us(),await gs()}catch(d){console.error("Error in bulk product action:",d),y({variant:"destructive",title:"Bulk Action Failed",description:d.message})}finally{O("bulk-product-action",!1)}},si=()=>{try{let s=[],l=`${D}_export_${Ge(new Date,"yyyy-MM-dd")}.csv`;switch(D){case"users":s=u;break;case"products":s=o;break;case"transactions":s=Ze;break;case"subscriptions":s=g;break;case"withdrawals":s=Qe;break;case"reports":s=S;break;default:s=[]}if((J||We)&&(s=s.filter(X=>{const G=new Date(X.created_at||X.joined_at||new Date().toISOString());if(J&&G<J)return!1;if(We){const ge=new Date(We);if(ge.setHours(23,59,59,999),G>ge)return!1}return!0})),s.length===0){y({variant:"destructive",title:"No Data",description:"No records found for the selected criteria."});return}const h=[Object.keys(s[0]).join(","),...s.map(X=>Object.values(X).map(G=>`"${String(G).replace(/"/g,'""')}"`).join(","))].join(`
`),k=new Blob([h],{type:"text/csv;charset=utf-8;"}),F=document.createElement("a"),B=URL.createObjectURL(k);F.setAttribute("href",B),F.setAttribute("download",l),F.style.visibility="hidden",document.body.appendChild(F),F.click(),document.body.removeChild(F),Q(!1),y({title:"Export Successful",description:`Exported ${s.length} records.`}),ee("export_data",D,"bulk",{count:s.length})}catch(s){console.error("Export failed:",s),y({variant:"destructive",title:"Export Failed",description:"An error occurred while exporring data."})}},ee=async(s,l,d,h)=>{try{const k={id:crypto.randomUUID(),admin_id:ns?.id,action_type:s,resource_type:l,resource_id:d,details:h||{}};console.log("Admin Action Log:",k);const{error:F}=await b.from("admin_actions").insert(k);F&&console.error("Supabase error logging admin action:",F)}catch(k){console.error("Error logging admin action:",k)}},Ya=o.filter(s=>s.name.toLowerCase().includes(Oe.toLowerCase())||s.seller_email?.toLowerCase().includes(Oe.toLowerCase())||s.category_name?.toLowerCase().includes(Oe.toLowerCase())),ti=u.filter(s=>s.email.toLowerCase().includes(Oe.toLowerCase())||s.full_name?.toLowerCase().includes(Oe.toLowerCase())),Va=S.filter(s=>s.reporter_email?.toLowerCase().includes(Oe.toLowerCase())||s.product_name?.toLowerCase().includes(Oe.toLowerCase())||s.reason.toLowerCase().includes(Oe.toLowerCase())),ai=n.filter(s=>s.name.toLowerCase().includes(Oe.toLowerCase())||s.description?.toLowerCase().includes(Oe.toLowerCase())),Us=g.filter(s=>{const l=(s.user_email?.toLowerCase()||"").includes(Xs.toLowerCase())||(s.user_name?.toLowerCase()||"").includes(Xs.toLowerCase())||(s.plan_name?.toLowerCase()||"").includes(Xs.toLowerCase()),d=Pt==="all"||s.status===Pt;return l&&d}),za=Ze.filter(s=>{const l=ka.toLowerCase();return(s.user_email?.toLowerCase()||"").includes(l)||(s.user_name?.toLowerCase()||"").includes(l)||(s.mpesa_receipt_number?.toLowerCase()||"").includes(l)||(s.description?.toLowerCase()||"").includes(l)||(s.status?.toLowerCase()||"").includes(l)||(s.id?.toLowerCase()||"").includes(l)});Qe.filter(s=>{const l=dn.toLowerCase();return(s.profiles?.full_name?.toLowerCase()||"").includes(l)||(s.profiles?.email?.toLowerCase()||"").includes(l)||(s.payment_method?.toLowerCase()||"").includes(l)||(s.status?.toLowerCase()||"").includes(l)||(s.id?.toLowerCase()||"").includes(l)});const qa=Ya.filter(s=>s.status==="pending"),xt=Ya.filter(s=>s.status==="approved"||s.status==="active"),Ha=Va.filter(s=>s.status==="pending");g.filter(s=>s.status==="active");const ri=()=>e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${js?"bg-gradient-to-br from-red-600 to-pink-600":La?"bg-gradient-to-br from-blue-600 to-purple-600":"bg-gradient-to-br from-green-600 to-teal-600"}`,children:e.jsx(_t,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-br from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-muted-foreground",children:[js?"Super Administrator":La?"Administrator":"Moderator",e.jsxs(q,{variant:"secondary",className:"ml-2",children:[ns?.role," "," ",Fn?"Limited Access":"Full Access"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Zt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(oe,{placeholder:"Search everything...",value:Oe,onChange:s=>an(s.target.value),className:"pl-10 w-80"})]}),j.canExportData&&e.jsx(v,{variant:"outline",size:"icon",onClick:()=>Q(!0),children:e.jsx(er,{className:"h-4 w-4"})}),e.jsx(v,{variant:"outline",size:"icon",onClick:dt,disabled:T.refresh,children:e.jsx(ws,{className:`h-4 w-4 ${T.refresh?"animate-spin":""}`})}),j.canManageSystem&&e.jsxs(v,{onClick:()=>rt(!0),variant:"outline",children:[e.jsx(pr,{className:"h-4 w-4 mr-2"}),"Settings"]})]})]}),ni=()=>e.jsxs(W,{className:"lg:col-span-2 xl:col-span-1",children:[e.jsxs(H,{children:[e.jsx(K,{children:"Quick Actions"}),e.jsx(re,{children:"Frequently used tasks"})]}),e.jsx(I,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[j.canApproveProducts&&e.jsxs(v,{variant:"outline",className:"h-auto py-3 flex flex-col gap-2",onClick:()=>Js("pending"),children:[e.jsx(Kt,{className:"h-5 w-5"}),e.jsxs("span",{className:"text-xs",children:["Review Pending (",r.pendingProducts,")"]})]}),j.canResolveReports&&e.jsxs(v,{variant:"outline",className:"h-auto py-3 flex flex-col gap-2",onClick:()=>Js("reports"),children:[e.jsx(mr,{className:"h-5 w-5"}),e.jsxs("span",{className:"text-xs",children:["Handle Reports (",r.pendingReports,")"]})]}),j.canManageCategories&&e.jsxs(v,{variant:"outline",className:"h-auto py-3 flex flex-col gap-2",onClick:()=>Ls(!0),children:[e.jsx(jt,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Add Category"})]}),j.canSendEmails&&e.jsxs(v,{variant:"outline",className:"h-auto py-3 flex flex-col gap-2",onClick:()=>nt(!0),children:[e.jsx(Za,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Email Users"})]}),j.canPerformBulkActions&&e.jsxs(v,{variant:"outline",className:"h-auto py-3 flex flex-col gap-2",onClick:()=>at(!0),children:[e.jsx(rl,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Bulk Actions"})]}),j.canBackupSystem&&e.jsxs(v,{variant:"outline",className:"h-auto py-3 flex flex-col gap-2",onClick:()=>Os(!0),disabled:T["system-backup"],children:[e.jsx(wt,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs",children:"Backup System"})]})]})})]}),ii=()=>e.jsxs(W,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(K,{children:"User Management"}),e.jsx(re,{children:j.canBanUsers?"Manage platform users":"View user information"})]}),j.canBanUsers&&Ee.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Qt,{children:[e.jsx(Jt,{asChild:!0,children:e.jsxs(v,{variant:"outline",children:["Bulk Actions (",Ee.length,")"]})}),e.jsxs(Xt,{children:[e.jsx(Fe,{onClick:()=>ht(Ee,"verify"),children:"Verify Selected"}),e.jsx(Fe,{onClick:()=>ht(Ee,"activate"),children:"Activate Selected"}),e.jsx(Fe,{onClick:()=>ht(Ee,"upgrade_to_premium"),children:"Upgrade to Premium"}),e.jsx(Ui,{}),e.jsx(Fe,{onClick:()=>ls("ban","users",Ee),children:"Ban Selected"}),e.jsx(Fe,{onClick:()=>ls("suspend","users",Ee),children:"Suspend Selected"})]})]}),e.jsx(v,{variant:"ghost",onClick:()=>Ps([]),children:"Clear"})]})]}),e.jsx(I,{children:e.jsxs(Ve,{children:[e.jsx(ze,{children:e.jsxs(se,{children:[j.canBanUsers&&e.jsx(C,{className:"w-12",children:e.jsx(vt,{checked:Ee.length===u.length&&u.length>0,onCheckedChange:s=>{Ps(s?u.map(l=>l.id):[])}})}),e.jsx(C,{children:"User"}),e.jsx(C,{children:"Status"}),e.jsx(C,{children:"Products"}),e.jsx(C,{children:"Joined"}),j.canBanUsers&&e.jsx(C,{children:"Actions"})]})}),e.jsx(qe,{children:ti.map(s=>e.jsxs(se,{children:[j.canBanUsers&&e.jsx(N,{children:e.jsx(vt,{checked:Ee.includes(s.id),onCheckedChange:l=>{Ps(l?[...Ee,s.id]:Ee.filter(d=>d!==s.id))}})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"h-8 w-8",children:s.avatar_url?e.jsx($s,{src:s.avatar_url}):e.jsx(Ue,{children:s.email?.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.email})," ",e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",s.full_name]})]})]})}),e.jsx(N,{children:e.jsx(q,{variant:s.status==="active"?"default":s.status==="banned"?"destructive":"secondary",children:s.status})}),e.jsx(N,{children:s.products_count||0}),e.jsx(N,{children:new Date(s.created_at).toLocaleDateString()}),j.canBanUsers&&e.jsx(N,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>{fn(s),As(!0)},children:e.jsx(ta,{className:"h-3 w-3"})}),s.status==="active"?e.jsxs(e.Fragment,{children:[j.canSuspendUsers&&e.jsx(v,{variant:"outline",size:"sm",onClick:()=>{Ft(s.id),Es(!0)},children:e.jsx(hr,{className:"h-3 w-3"})}),j.canBanUsers&&e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>{Et(s.id),Rs(!0)},children:e.jsx(hr,{className:"h-3 w-3"})})]}):j.canBanUsers&&e.jsx(v,{variant:"outline",size:"sm",onClick:()=>Wa(s.id),disabled:T[`unban-${s.id}`],children:e.jsx(dl,{className:"h-3 w-3"})})]})})]},s.id))})]})})]}),li=()=>j.canViewAdmins?e.jsxs(W,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(K,{children:"Admin Management"}),e.jsx(re,{children:j.canManageAdmins?"Manage platform administrators":"View admin team"})]}),j.canManageAdmins&&e.jsxs(v,{onClick:()=>st(!0),children:[e.jsx(nl,{className:"h-4 w-4 mr-2"}),"Add Admin"]})]}),e.jsx(I,{children:e.jsxs(Ve,{children:[e.jsx(ze,{children:e.jsxs(se,{children:[e.jsx(C,{children:"Admin"}),e.jsx(C,{children:"Role"}),e.jsx(C,{children:"Status"}),e.jsx(C,{children:"Added"}),j.canManageAdmins&&e.jsx(C,{children:"Actions"})]})}),e.jsx(qe,{children:x.map(s=>e.jsxs(se,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-6 w-6",children:e.jsx(Ue,{children:s.email?.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.email}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.full_name})]})]})}),e.jsx(N,{children:e.jsx(q,{variant:s.role==="super_admin"?"destructive":s.role==="admin"?"default":"secondary",children:s.role})}),e.jsx(N,{children:e.jsx(q,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsx(N,{children:new Date(s.created_at).toLocaleDateString()}),j.canManageAdmins&&e.jsx(N,{children:s.role!=="super_admin"&&e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>Vn(s.id),disabled:T[`remove-admin-${s.id}`],children:e.jsx(ys,{className:"h-3 w-3"})})})]},s.id))})]})})]}):null,oi=s=>e.jsxs("div",{className:"flex gap-2",children:[j.canApproveProducts&&s.status==="pending"&&e.jsxs(v,{size:"sm",onClick:()=>Ua(s.id),disabled:T[`approve-${s.id}`],children:[e.jsx(bt,{className:"h-3 w-3 mr-1"}),"Approve"]}),j.canRejectProducts&&s.status==="pending"&&e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>{Lt(s.id),Fs(!0)},children:[e.jsx(ft,{className:"h-3 w-3 mr-1"}),"Reject"]}),j.canFeatureProducts&&e.jsx(fe,{checked:s.featured,onCheckedChange:l=>zt(s.id,l),disabled:T[`feature-${s.id}`]}),j.canDeleteProducts&&e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>$a(s.id),disabled:T[`delete-${s.id}`],children:e.jsx(ys,{className:"h-3 w-3"})})]});return ks?tn?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-blue-50/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Se,{className:"h-12 w-12 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Loading Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Preparing your management interface..."})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50/30",children:e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[ri(),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(W,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Total Users"}),e.jsx("p",{className:"text-xl font-bold",children:r.totalUsers}),e.jsxs("p",{className:"text-blue-200 text-xs",children:["+",r.todayRegistrations," today"]})]}),e.jsx(sa,{className:"h-6 w-6 text-blue-200"})]})})}),e.jsx(W,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white",children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Revenue"}),e.jsxs("p",{className:"text-xl font-bold",children:["KES ",r.totalRevenue.toLocaleString()]}),e.jsxs("p",{className:"text-green-200 text-xs",children:[r.weeklyGrowth,"% growth"]})]}),e.jsx(ar,{className:"h-6 w-6 text-green-200"})]})})}),e.jsx(W,{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-sm font-medium",children:"Pending"}),e.jsx("p",{className:"text-xl font-bold",children:r.pendingProducts}),e.jsxs("p",{className:"text-orange-200 text-xs",children:[r.pendingReports," reports"]})]}),e.jsx(Kt,{className:"h-6 w-6 text-orange-200"})]})})}),e.jsx(W,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm font-medium",children:"System Health"}),e.jsxs("p",{className:"text-xl font-bold",children:[r.systemHealth,"%"]}),e.jsxs("p",{className:"text-purple-200 text-xs",children:[r.serverLoad,"% load"]})]}),e.jsx(rr,{className:"h-6 w-6 text-purple-200"})]})})}),e.jsx(W,{className:"bg-gradient-to-br from-red-500 to-red-600 text-white",children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-100 text-sm font-medium",children:"Subscriptions"}),e.jsx("p",{className:"text-xl font-bold",children:r.activeSubscriptions}),e.jsx("p",{className:"text-red-200 text-xs",children:"Active plans"})]}),e.jsx(Ga,{className:"h-6 w-6 text-red-200"})]})})}),e.jsx(W,{className:"bg-gradient-to-br from-indigo-500 to-indigo-600 text-white",children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-100 text-sm font-medium",children:"Engagement"}),e.jsxs("p",{className:"text-xl font-bold",children:[r.userEngagement.toFixed(1),"%"]}),e.jsxs("p",{className:"text-indigo-200 text-xs",children:[r.unreadMessages," messages"]})]}),e.jsx(Ei,{className:"h-6 w-6 text-indigo-200"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(W,{children:[e.jsxs(H,{children:[e.jsx(K,{children:"Revenue Trend"}),e.jsx(re,{children:"Monthly revenue last 6 months"})]}),e.jsx(I,{className:"h-[300px]",children:e.jsx(nr,{width:"100%",height:"100%",children:e.jsxs(Qi,{data:xs,children:[e.jsx(ir,{strokeDasharray:"3 3"}),e.jsx(lr,{dataKey:"name"}),e.jsx(or,{}),e.jsx(cr,{formatter:s=>[`KES ${Number(s).toLocaleString()}`,"Revenue"]}),e.jsx(dr,{}),e.jsx(Gi,{dataKey:"revenue",fill:"#16a34a",name:"Revenue",radius:[4,4,0,0]})]})})})]}),e.jsxs(W,{children:[e.jsxs(H,{children:[e.jsx(K,{children:"User Growth"}),e.jsx(re,{children:"New registrations last 6 months"})]}),e.jsx(I,{className:"h-[300px]",children:e.jsx(nr,{width:"100%",height:"100%",children:e.jsxs(Ji,{data:Cs,children:[e.jsx(ir,{strokeDasharray:"3 3"}),e.jsx(lr,{dataKey:"name"}),e.jsx(or,{}),e.jsx(cr,{}),e.jsx(dr,{}),e.jsx(Xi,{type:"monotone",dataKey:"users",stroke:"#2563eb",strokeWidth:2,name:"New Users"})]})})})]})]}),e.jsxs(Qa,{value:rn,onValueChange:Js,className:"space-y-6",children:[e.jsx(Ja,{className:"grid w-full grid-cols-2 lg:grid-cols-10 h-auto p-1 bg-slate-100/50 rounded-lg overflow-x-auto",children:Ln().map(s=>s.value==="withdrawals"?e.jsxs("div",{onClick:()=>t("/admin/wallets"),className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-sm cursor-pointer transition-all text-muted-foreground hover:text-foreground hover:bg-muted whitespace-nowrap",role:"button",children:[e.jsx(s.icon,{className:"h-4 w-4"}),s.label]},s.value):e.jsxs(Gt,{value:s.value,className:"flex items-center gap-2 data-[state=active]:bg-white data-[state=active]:shadow-sm",children:[e.jsx(s.icon,{className:"h-4 w-4"}),s.label]},s.value))}),e.jsxs(pe,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:[ni(),e.jsxs(W,{children:[e.jsxs(H,{children:[e.jsx(K,{children:"System Health"}),e.jsx(re,{children:"Platform performance metrics"})]}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Server Status"}),e.jsxs(q,{variant:"default",className:"bg-green-500",children:[e.jsx(ml,{className:"h-3 w-3 mr-1"}),"Online"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Database"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:U?.database_size})]}),e.jsx(ca,{value:90,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Cache Hit Rate"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[U?.cache_hit_rate,"%"]})]}),e.jsx(ca,{value:U?.cache_hit_rate||0,className:"h-2"})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Active Connections"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:U?.active_connections})]})}),e.jsx("div",{className:"pt-2",children:e.jsxs(v,{variant:"outline",size:"sm",className:"w-full",onClick:()=>Js("system"),children:[e.jsx(xr,{className:"h-4 w-4 mr-2"}),"View Detailed Metrics"]})})]})})]}),e.jsxs(W,{className:"lg:col-span-2 xl:col-span-1",children:[e.jsxs(H,{children:[e.jsx(K,{children:"Recent Activity"}),e.jsx(re,{children:"Latest platform events"})]}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[Ce.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-slate-50",children:[e.jsx(Te,{className:"h-8 w-8",children:e.jsx(Ue,{className:"text-xs bg-blue-100 text-blue-600",children:s.admin_email?.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium capitalize",children:s.action_type.replace(/_/g," ")}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.admin_email," "," ",new Date(s.created_at).toLocaleDateString()]})]}),e.jsx(q,{variant:"outline",className:"text-xs",children:s.resource_type})]},s.id)),e.jsx(v,{variant:"ghost",className:"w-full",onClick:()=>Rt(!0),children:"View All Activity"})]})})]})]}),e.jsxs(W,{children:[e.jsxs(H,{children:[e.jsx(K,{children:"Revenue Analytics"}),e.jsx(re,{children:"Weekly revenue and order trends"})]}),e.jsx(I,{children:e.jsx("div",{className:"h-64 flex items-center justify-center border rounded-lg bg-gradient-to-br from-slate-50 to-blue-50/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ol,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"Revenue chart visualization"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Total Revenue:"," ",e.jsxs("strong",{children:["KES ",r.totalRevenue.toLocaleString()]})]})]})})})]})]}),e.jsx(pe,{value:"products",children:e.jsxs(W,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(K,{children:"Product Management"}),e.jsx(re,{children:"Manage all sellhubshop listings"})]}),e.jsxs("div",{className:"flex gap-2",children:[Ie.length>0&&j.canPerformBulkActions&&e.jsxs(e.Fragment,{children:[e.jsxs(Qt,{children:[e.jsx(Jt,{asChild:!0,children:e.jsxs(v,{variant:"outline",children:["Bulk Actions (",Ie.length,")"]})}),e.jsxs(Xt,{children:[e.jsx(Fe,{onClick:()=>ls("approve","products",Ie),children:"Approve Selected"}),e.jsx(Fe,{onClick:()=>ls("feature","products",Ie),children:"Feature Selected"}),e.jsx(Fe,{onClick:()=>ls("delete","products",Ie),children:"Delete Selected"})]})]}),e.jsx(v,{variant:"ghost",onClick:()=>Ms([]),children:"Clear"})]}),e.jsxs(Qt,{children:[e.jsx(Jt,{asChild:!0,children:e.jsxs(v,{variant:"outline",children:[e.jsx(Zi,{className:"h-4 w-4 mr-2"}),"Filter"]})}),e.jsxs(Xt,{children:[e.jsx(Fe,{children:"All Products"}),e.jsx(Fe,{children:"Active Products"}),e.jsx(Fe,{children:"Featured Products"}),e.jsx(Fe,{children:"Verified Products"})]})]})]})]}),e.jsx(I,{children:e.jsxs(Ve,{children:[e.jsx(ze,{children:e.jsxs(se,{children:[j.canPerformBulkActions&&e.jsx(C,{className:"w-12",children:e.jsx(vt,{checked:Ie.length===xt.length&&xt.length>0,onCheckedChange:s=>{Ms(s?xt.map(l=>l.id):[])}})}),e.jsx(C,{children:"Image"}),e.jsx(C,{children:"Product"}),e.jsx(C,{children:"Price"}),e.jsx(C,{children:"Seller"}),e.jsx(C,{children:"Status"}),e.jsx(C,{children:"Category"}),j.canFeatureProducts&&e.jsx(C,{children:"Featured"}),j.canVerifyProducts&&e.jsx(C,{children:"Verified"}),e.jsx(C,{children:"Actions"})]})}),e.jsx(qe,{children:xt.map(s=>e.jsxs(se,{children:[j.canPerformBulkActions&&e.jsx(N,{children:e.jsx(vt,{checked:Ie.includes(s.id),onCheckedChange:l=>{Ms(l?[...Ie,s.id]:Ie.filter(d=>d!==s.id))}})}),e.jsx(N,{children:e.jsxs(Te,{className:"h-12 w-12 border rounded-md",children:[e.jsx($s,{src:s.images?.[0]||s.image,alt:s.name,className:"object-cover"}),e.jsx(Ue,{className:"bg-blue-100 text-blue-600 rounded-md",children:s.name?.charAt(0).toUpperCase()})]})}),e.jsx(N,{children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.description?.substring(0,50),"..."]})]})})}),e.jsx(N,{className:"font-semibold",children:e.jsx("div",{className:"flex flex-col",children:e.jsxs("span",{children:["KES ",s.price?.toLocaleString()]})})}),e.jsx(N,{children:s.seller_email}),e.jsx(N,{children:e.jsx(q,{variant:"default",children:s.status})}),e.jsx(N,{children:e.jsx(q,{variant:"outline",children:s.category_name||"Uncategorized"})}),j.canFeatureProducts&&e.jsx(N,{children:e.jsx(fe,{checked:s.featured,onCheckedChange:l=>zt(s.id,l),disabled:T[`feature-${s.id}`]})}),j.canVerifyProducts&&e.jsx(N,{children:e.jsx(fe,{checked:s.verified,onCheckedChange:l=>Ba(s.id,l),disabled:T[`verify-${s.id}`]})}),e.jsx(N,{children:oi(s)})]},s.id))})]})})]})}),e.jsx(pe,{value:"pending",children:e.jsxs(W,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(K,{children:"Pending Approval"}),e.jsx(re,{children:"Review and approve new product listings"})]}),e.jsxs(q,{variant:"destructive",children:[qa.length," Pending"]})]}),e.jsx(I,{children:e.jsxs(Ve,{children:[e.jsx(ze,{children:e.jsxs(se,{children:[e.jsx(C,{children:"Image"}),e.jsx(C,{children:"Product"}),e.jsx(C,{children:"Price"}),e.jsx(C,{children:"Seller"}),e.jsx(C,{children:"Category"}),e.jsx(C,{children:"Submitted"}),j.canApproveProducts&&e.jsx(C,{children:"Actions"})]})}),e.jsx(qe,{children:qa.map(s=>e.jsxs(se,{children:[e.jsx(N,{children:e.jsxs(Te,{className:"h-12 w-12 border rounded-md",children:[e.jsx($s,{src:s.images?.[0]||s.image,alt:s.name,className:"object-cover"}),e.jsx(Ue,{className:"bg-yellow-100 text-yellow-600 rounded-md",children:s.name?.charAt(0).toUpperCase()})]})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"h-10 w-10 border hidden",children:e.jsx(Ue,{className:"bg-yellow-100 text-yellow-600",children:s.name?.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.description?.substring(0,50),"..."]})]})]})}),e.jsx(N,{className:"font-semibold",children:e.jsx("div",{className:"flex flex-col",children:e.jsxs("span",{children:["KES ",s.price?.toLocaleString()]})})}),e.jsx(N,{children:s.seller_email}),e.jsx(N,{children:e.jsx(q,{variant:"outline",children:s.category_name||"Uncategorized"})}),e.jsx(N,{children:new Date(s.created_at).toLocaleDateString()}),j.canApproveProducts&&e.jsx(N,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{size:"sm",onClick:()=>Ua(s.id),disabled:T[`approve-${s.id}`],children:[T[`approve-${s.id}`]?e.jsx(Se,{className:"h-3 w-3 animate-spin mr-1"}):e.jsx(bt,{className:"h-3 w-3 mr-1"}),"Approve"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>{Lt(s.id),Fs(!0)},children:[e.jsx(ft,{className:"h-3 w-3 mr-1"}),"Reject"]})]})})]},s.id))})]})})]})}),e.jsx(pe,{value:"users",children:j.canViewUsers?ii():e.jsx(He,{children:e.jsx(Ke,{children:"You don't have permission to view user management. Contact an administrator."})})}),e.jsx(pe,{value:"categories",children:e.jsxs(W,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(K,{children:"Category Management"}),e.jsx(re,{children:"Organize product categories"})]}),j.canManageCategories&&e.jsxs(v,{onClick:()=>{Ye([]),fs({...cs,properties:"{}"}),Ls(!0)},children:[e.jsx(jt,{className:"h-4 w-4 mr-2"}),"Add Category"]})]}),e.jsx(I,{children:e.jsxs(Ve,{children:[e.jsx(ze,{children:e.jsxs(se,{children:[e.jsx(C,{children:"Name"}),e.jsx(C,{children:"Description"}),e.jsx(C,{children:"Products"}),e.jsx(C,{children:"Status"}),e.jsx(C,{children:"Created"}),j.canManageCategories&&e.jsx(C,{children:"Actions"})]})}),e.jsx(qe,{children:ai.map(s=>e.jsxs(se,{children:[e.jsx(N,{className:"font-medium",children:s.name}),e.jsx(N,{children:e.jsx("p",{className:"text-sm text-muted-foreground max-w-[200px] truncate",children:s.description||"No description"})}),e.jsx(N,{children:s.product_count||0}),e.jsx(N,{children:e.jsx(q,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})}),e.jsx(N,{children:new Date(s.created_at).toLocaleDateString()}),j.canManageCategories&&e.jsx(N,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>{vs(s);let l=[];try{const d=typeof s.properties=="string"?JSON.parse(s.properties):s.properties;l=Object.entries(d||{}).map(([h,k])=>({key:h,value:String(k)}))}catch(d){console.error("Error parsing props",d)}Ye(l),tt(!0)},children:e.jsx(el,{className:"h-3 w-3"})}),e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>Hn(s.id),disabled:T[`delete-category-${s.id}`],children:e.jsx(ys,{className:"h-3 w-3"})})]})})]},s.id))})]})})]})}),e.jsx(pe,{value:"banners",children:e.jsx(Bi,{currentAdmin:ns,permissions:j})}),e.jsx(pe,{value:"reports",children:e.jsxs(W,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(K,{children:"Report Management"}),e.jsx(re,{children:"Review and resolve user reports"})]}),e.jsxs(q,{variant:Ha.length>0?"destructive":"default",children:[Ha.length," Pending"]})]}),e.jsx(I,{children:e.jsxs(Ve,{children:[e.jsx(ze,{children:e.jsxs(se,{children:[e.jsx(C,{children:"Product"}),e.jsx(C,{children:"Reporter"}),e.jsx(C,{children:"Reason"}),e.jsx(C,{children:"Priority"}),e.jsx(C,{children:"Status"}),e.jsx(C,{children:"Reported"}),j.canResolveReports&&e.jsx(C,{children:"Actions"})]})}),e.jsx(qe,{children:Va.map(s=>e.jsxs(se,{className:"hover:bg-muted/50",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.product_images?.[0]?e.jsx("div",{className:"relative h-12 w-12 rounded-lg overflow-hidden border",children:e.jsx("img",{src:s.product_images[0],alt:s.product_name||"Product",className:"h-full w-full object-cover",onError:l=>{l.currentTarget.style.display="none";const d=l.currentTarget.parentElement;d&&(d.innerHTML=`
                              <div class="h-12 w-12 rounded-lg bg-gray-100 flex items-center justify-center">
                                <Package className="h-6 w-6 text-gray-400" />
                              </div>
                            `)}})}):e.jsx("div",{className:"h-12 w-12 rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(gt,{className:"h-6 w-6 text-gray-400"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-sm",children:s.product_name||"Unknown Product"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.product_price&&e.jsx("div",{className:"flex flex-col gap-0.5",children:e.jsxs(q,{variant:"outline",className:"text-xs",children:["KES ",s.product_price.toLocaleString()]})}),s.product_category_name&&e.jsx(q,{variant:"secondary",className:"text-xs",children:s.product_category_name}),s.product_verified&&e.jsx(q,{className:"text-xs bg-green-500",children:"Verified"})]})]})]})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-8 w-8",children:s.reporter_avatar?e.jsx($s,{src:s.reporter_avatar}):e.jsx(Ue,{className:"text-xs",children:s.reporter_email?.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.reporter_email}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.reporter_name||"Anonymous"})]})]})}),e.jsxs(N,{children:[e.jsx("span",{className:"text-sm font-medium",children:s.reason}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1 truncate max-w-[200px]",children:s.description})]}),e.jsx(N,{children:e.jsx(q,{variant:s.priority==="high"?"destructive":s.priority==="medium"?"default":"secondary",children:s.priority})}),e.jsx(N,{children:e.jsx(q,{variant:s.status==="pending"?"destructive":"default",children:s.status})}),e.jsx(N,{children:e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsx("p",{children:new Date(s.created_at).toLocaleDateString()}),e.jsx("p",{className:"text-muted-foreground",children:new Date(s.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})}),j.canResolveReports&&e.jsx(N,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(v,{size:"sm",onClick:()=>{Ot(s),At(!0)},children:[e.jsx(ta,{className:"h-3 w-3 mr-1"}),"Review"]}),s.status==="pending"&&e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>qt(s.id,"dismissed","No action required"),disabled:T[`resolve-${s.id}`],children:[e.jsx(ft,{className:"h-3 w-3 mr-1"}),"Dismiss"]})]})})]},s.id))})]})})]})}),e.jsx(pe,{value:"subscriptions",children:j.canViewSubscriptions?e.jsxs(Qa,{defaultValue:"plans",className:"space-y-4",children:[e.jsxs(Ja,{children:[e.jsx(Gt,{value:"plans",children:"Active Plans"}),e.jsx(Gt,{value:"history",children:"Transaction History"})]}),e.jsx(pe,{value:"plans",children:e.jsxs(W,{children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(K,{children:"Subscription Management"}),e.jsx(re,{children:"Manage user subscriptions and plans - All statuses shown"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(De,{value:Pt,onValueChange:nn,children:[e.jsx(Pe,{className:"w-full sm:w-[180px]",children:e.jsx(Me,{placeholder:"Filter by status"})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"all",children:"All Statuses"}),e.jsx(R,{value:"active",children:"Active"}),e.jsx(R,{value:"pending",children:"Pending"}),e.jsx(R,{value:"cancelled",children:"Cancelled"}),e.jsx(R,{value:"expired",children:"Expired"}),e.jsx(R,{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Zt,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(oe,{placeholder:"Search subscriptions...",value:Xs,onChange:s=>ln(s.target.value),className:"pl-8 w-full sm:w-[250px]"})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(q,{variant:"outline",children:[Us.length," Total"]}),e.jsxs(q,{variant:"default",children:[Us.filter(s=>s.status==="active").length," Active"]}),e.jsxs(q,{variant:"destructive",children:[Us.filter(s=>s.status==="failed").length," Failed"]}),e.jsxs(q,{variant:"secondary",children:[Us.filter(s=>s.status==="cancelled").length," Cancelled"]})]}),j.canManageSubscriptions&&e.jsxs("div",{className:"flex gap-2 mt-4 p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"System Repair Tools"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Fix subscription issues when automated systems fail"})]}),e.jsx(v,{variant:"outline",size:"sm",onClick:Zn,disabled:T["recalculate-all"],children:T["recalculate-all"]?e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4 mr-2 animate-spin"}),"Recalculating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ws,{className:"h-4 w-4 mr-2"}),"Recalculate All Limits"]})})]})]}),e.jsx(I,{children:e.jsxs(Ve,{children:[e.jsx(ze,{children:e.jsxs(se,{children:[e.jsx(C,{children:"User"}),e.jsx(C,{children:"Plan"}),e.jsx(C,{children:"Status"}),e.jsx(C,{children:"Reference"}),e.jsx(C,{children:"Price"}),e.jsx(C,{children:"Renews"}),e.jsx(C,{children:"Created"}),j.canManageSubscriptions&&e.jsx(C,{children:"Actions"})]})}),e.jsx(qe,{children:Us.map(s=>e.jsxs(se,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-6 w-6",children:e.jsx(Ue,{children:s.user_email?.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.user_email}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.user_name})]})]})}),e.jsx(N,{children:e.jsx(q,{variant:"outline",children:s.plan_name})}),e.jsx(N,{children:e.jsx(q,{variant:s.status==="active"?"default":s.status==="failed"?"destructive":"secondary",children:s.status})}),e.jsx(N,{children:e.jsx("span",{className:"text-xs font-mono bg-muted p-1 rounded",children:s.mpesa_receipt_number||s.payment_method||"-"})}),e.jsx(N,{children:e.jsx("div",{className:"flex flex-col",children:e.jsxs("span",{children:["KES ",s.price_monthly?.toLocaleString()]})})}),e.jsx(N,{children:new Date(s.current_period_end).toLocaleDateString()}),e.jsx(N,{children:new Date(s.created_at).toLocaleDateString()}),j.canManageSubscriptions&&e.jsx(N,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>{mn(s),Mt(!0)},children:e.jsx(ta,{className:"h-3 w-3"})}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>Xn(s.id),disabled:T[`sync-${s.id}`],title:"Sync upload limit to plan",children:T[`sync-${s.id}`]?e.jsx(Se,{className:"h-3 w-3 animate-spin"}):e.jsx(ws,{className:"h-3 w-3"})}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>{Sa(s),et({uploadLimit:0,status:s.status,notes:""}),Zs(!0)},children:[e.jsx(Xa,{className:"h-3 w-3 mr-1"}),"Adjust"]})]})})]},s.id))})]})})]})}),e.jsx(pe,{value:"history",children:e.jsxs(W,{children:[e.jsx(H,{children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(K,{children:"Transaction History"}),e.jsx(re,{children:"Real-time payment logs (Success, Failed, Pending)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Zt,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(oe,{placeholder:"Search transactions...",value:ka,onChange:s=>cn(s.target.value),className:"pl-8 w-full sm:w-[250px]"})]})]})}),e.jsx(I,{children:e.jsxs(Ve,{children:[e.jsx(ze,{children:e.jsxs(se,{children:[e.jsx(C,{children:"User"}),e.jsx(C,{children:"Amount"}),e.jsx(C,{children:"Status"}),e.jsx(C,{children:"M-Pesa Receipt"}),e.jsx(C,{children:"Method"}),e.jsx(C,{children:"Description"}),e.jsx(C,{children:"Date"})]})}),e.jsx(qe,{children:za.length===0?e.jsx(se,{children:e.jsx(N,{colSpan:7,className:"text-center py-10 text-muted-foreground",children:"No transactions found"})}):za.map(s=>e.jsxs(se,{children:[e.jsx(N,{children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.user_email}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.user_name})]})}),e.jsxs(N,{className:"font-medium",children:["KES ",s.amount.toLocaleString()]}),e.jsx(N,{children:e.jsx(q,{variant:s.status==="completed"||s.status==="success"?"default":s.status==="failed"?"destructive":"secondary",children:s.status})}),e.jsx(N,{className:"font-mono text-xs",children:s.mpesa_receipt_number||"N/A"}),e.jsx(N,{className:"capitalize",children:s.payment_method}),e.jsx(N,{className:"max-w-[200px] truncate",title:s.description,children:s.description}),e.jsx(N,{className:"text-xs",children:new Date(s.created_at).toLocaleString()})]},s.id))})]})})]})})]}):e.jsx(He,{children:e.jsx(Ke,{children:"You don't have permission to view subscriptions. Contact an administrator."})})}),e.jsx(pe,{value:"withdrawals",className:"space-y-6",children:e.jsx(Wi,{})}),e.jsx(pe,{value:"admins",children:li()}),e.jsx(pe,{value:"analytics",children:j.canViewAnalytics?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(W,{children:[e.jsx(H,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(sa,{className:"h-5 w-5"}),"User Analytics"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"New Registrations"}),e.jsxs(q,{variant:"default",children:["+",r.todayRegistrations," today"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Active Sellers"}),e.jsx("span",{className:"text-sm font-bold",children:Math.round(r.userEngagement/100*r.totalUsers)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Growth Rate"}),e.jsxs("div",{className:"flex items-center gap-1",children:[r.weeklyGrowth>0?e.jsx(sl,{className:"h-4 w-4 text-green-500"}):e.jsx(ArrowDownRight,{className:"h-4 w-4 text-red-500"}),e.jsxs("span",{className:`text-sm font-bold ${r.weeklyGrowth>0?"text-green-500":"text-red-500"}`,children:[r.weeklyGrowth,"%"]})]})]})]})})]}),e.jsxs(W,{children:[e.jsx(H,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(gt,{className:"h-5 w-5"}),"Product Analytics"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Products"}),e.jsx("span",{className:"text-sm font-bold",children:r.totalProducts})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Approval Rate"}),e.jsxs("span",{className:"text-sm font-bold",children:[r.totalProducts>0?Math.round(r.approvedProducts/r.totalProducts*100):0,"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Featured Products"}),e.jsx("span",{className:"text-sm font-bold",children:r.featuredProducts})]})]})})]}),e.jsxs(W,{children:[e.jsx(H,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(ar,{className:"h-5 w-5"}),"Revenue Analytics"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx("span",{className:"text-sm font-bold flex flex-col items-end",children:e.jsxs("span",{children:["KES ",r.totalRevenue.toLocaleString()]})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Active Subscriptions"}),e.jsx("span",{className:"text-sm font-bold",children:r.activeSubscriptions})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Conversion Rate"}),e.jsxs("span",{className:"text-sm font-bold",children:[r.totalProducts>0?Math.round(r.activeSubscriptions/r.totalUsers*100):0,"%"]})]})]})})]})]}),e.jsxs(W,{children:[e.jsxs(H,{children:[e.jsx(K,{children:"Revenue Trends"}),e.jsx(re,{children:"Weekly revenue and order performance"})]}),e.jsx(I,{children:e.jsx("div",{className:"h-80 flex items-center justify-center border rounded-lg bg-gradient-to-br from-slate-50 to-blue-50/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ll,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Revenue Analytics"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Interactive charts showing platform performance"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"font-semibold",children:["KES ",r.totalRevenue.toLocaleString()]}),e.jsx("p",{className:"text-muted-foreground",children:"Total Revenue"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"font-semibold",children:[r.weeklyGrowth,"%"]}),e.jsx("p",{className:"text-muted-foreground",children:"Weekly Growth"})]})]})]})})})]})]}):e.jsx(He,{children:e.jsx(Ke,{children:"You don't have permission to view analytics. Contact an administrator."})})}),e.jsx(pe,{value:"system",children:j.canManageSystem?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(W,{children:[e.jsx(H,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(xr,{className:"h-5 w-5"}),"System Health"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Database Size"}),e.jsx("span",{className:"text-sm font-mono",children:U?.database_size})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Active Connections"}),e.jsx(q,{variant:"outline",children:U?.active_connections})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Server Uptime"}),e.jsx("span",{className:"text-sm",children:U?.server_uptime})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Cache Hit Rate"}),e.jsxs("span",{className:"text-sm font-bold",children:[U?.cache_hit_rate,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Storage Used"}),e.jsx("span",{className:"text-sm",children:U?.storage_used})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Memory Usage"}),e.jsxs("span",{className:"text-sm font-bold",children:[U?.memory_usage,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Last Backup"}),e.jsx("span",{className:"text-sm",children:U?.last_backup?new Date(U.last_backup).toLocaleDateString():"Never"})]})]})})]}),e.jsxs(W,{children:[e.jsx(H,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(pr,{className:"h-5 w-5"}),"System Actions"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-3",children:[j.canBackupSystem&&e.jsxs(v,{className:"w-full justify-start",variant:"outline",onClick:()=>Os(!0),disabled:T["system-backup"],children:[e.jsx(wt,{className:"h-4 w-4 mr-2"}),T["system-backup"]?"Backing up...":"Backup Database"]}),e.jsxs(v,{className:"w-full justify-start",variant:"outline",children:[e.jsx(cl,{className:"h-4 w-4 mr-2"}),"Optimize Database"]}),e.jsxs(v,{className:"w-full justify-start",variant:"outline",children:[e.jsx(ys,{className:"h-4 w-4 mr-2"}),"Clear Cache"]}),e.jsxs(v,{className:"w-full justify-start",variant:"outline",children:[e.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Generate Reports"]}),e.jsxs(v,{className:"w-full justify-start",variant:"outline",children:[e.jsx(aa,{className:"h-4 w-4 mr-2"}),"Security Scan"]}),e.jsxs(v,{className:"w-full justify-start",variant:"outline",onClick:()=>Rt(!0),children:[e.jsx(tl,{className:"h-4 w-4 mr-2"}),"View Audit Log"]})]})})]})]}),e.jsxs(W,{children:[e.jsxs(H,{children:[e.jsx(K,{children:"System Configuration"}),e.jsx(re,{children:"Platform settings and preferences"})]}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(_,{htmlFor:"maintenance-mode",className:"flex items-center gap-2",children:[e.jsx(al,{className:"h-4 w-4"}),"Maintenance Mode"]}),e.jsx(fe,{id:"maintenance-mode",checked:ie.enable_maintenance_mode,onCheckedChange:s=>xe(l=>({...l,enable_maintenance_mode:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(_,{htmlFor:"auto-approve",className:"flex items-center gap-2",children:[e.jsx(bt,{className:"h-4 w-4"}),"Auto-approve Products"]}),e.jsx(fe,{id:"auto-approve",checked:ie.auto_approve_products,onCheckedChange:s=>xe(l=>({...l,auto_approve_products:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(_,{htmlFor:"email-verification",className:"flex items-center gap-2",children:[e.jsx(ul,{className:"h-4 w-4"}),"Require Email Verification"]}),e.jsx(fe,{id:"email-verification",checked:ie.require_email_verification,onCheckedChange:s=>xe(l=>({...l,require_email_verification:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(_,{htmlFor:"auto-backup",className:"flex items-center gap-2",children:[e.jsx(wt,{className:"h-4 w-4"}),"Auto Backup"]}),e.jsx(fe,{id:"auto-backup",checked:ie.auto_backup,onCheckedChange:s=>xe(l=>({...l,auto_backup:s}))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"max-products",children:"Max Products Per User"}),e.jsx(oe,{id:"max-products",type:"number",value:ie.max_products_per_user,onChange:s=>xe(l=>({...l,max_products_per_user:parseInt(s.target.value)||50}))})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"commission",children:"Platform Commission (%)"}),e.jsx(oe,{id:"commission",type:"number",value:ie.platform_commission,onChange:s=>xe(l=>({...l,platform_commission:parseInt(s.target.value)||5}))})]})]}),e.jsxs(v,{className:"w-full",onClick:Ia,disabled:T["update-settings"],children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Save System Settings"]})]})})]})]}):e.jsx(He,{children:e.jsx(Ke,{children:"You don't have permission to access system settings. Contact an administrator."})})}),e.jsxs(pe,{value:"security",className:"space-y-6",children:[e.jsxs(W,{children:[e.jsxs(H,{children:[e.jsx(K,{children:"Security Audit Logs"}),e.jsx(re,{children:"Track administrative actions and system security events"})]}),e.jsx(I,{children:e.jsxs(Ve,{children:[e.jsx(ze,{children:e.jsxs(se,{children:[e.jsx(C,{children:"Time"}),e.jsx(C,{children:"Admin ID"}),e.jsx(C,{children:"Action"}),e.jsx(C,{children:"Resource"}),e.jsx(C,{children:"Details"})]})}),e.jsx(qe,{children:Ce&&Ce.length>0?Ce.map(s=>e.jsxs(se,{children:[e.jsx(N,{className:"font-mono text-xs",children:new Date(s.created_at).toLocaleString()}),e.jsxs(N,{className:"font-mono text-xs",children:[s.admin_id?.slice(0,8),"..."]}),e.jsx(N,{children:e.jsx(q,{variant:"outline",children:s.action_type})}),e.jsx(N,{children:e.jsx("span",{className:"text-xs",children:s.resource_type})}),e.jsx(N,{children:e.jsx("div",{className:"max-w-[300px] overflow-hidden text-ellipsis whitespace-nowrap text-xs text-muted-foreground",children:JSON.stringify(s.details)})})]},s.id)):e.jsx(se,{children:e.jsx(N,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No audit logs found. Actions taken by admins will appear here."})})})]})})]}),!ns?.two_factor_enabled&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Account Security"}),e.jsx(Nl,{onComplete:async()=>{y({title:"Success",description:"2FA Enabled! You can now perform sensitive actions."}),await dt()},onCancel:()=>{}})]})]}),e.jsx(pe,{value:"health",className:"space-y-6",children:e.jsx(bl,{})})]}),e.jsx(ce,{open:gn,onOpenChange:st,children:e.jsxs(de,{children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Add New Admin"}),e.jsx(he,{children:js?"Grant admin privileges to a user by their email address.":"You can only add moderators. Contact a super admin for higher privileges."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"admin-email",children:"Email Address"}),e.jsx(oe,{id:"admin-email",type:"email",placeholder:"user@example.com",value:$t,onChange:s=>Ea(s.target.value)})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"admin-role",children:"Role"}),e.jsxs(De,{value:Wt,onValueChange:s=>An(s),disabled:!js,children:[e.jsx(Pe,{children:e.jsx(Me,{})}),e.jsxs(Ae,{children:[js&&e.jsx(R,{value:"admin",children:"Admin"}),e.jsx(R,{value:"moderator",children:"Moderator"})]})]}),!js&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"You can only create moderator accounts"})]}),e.jsxs("div",{className:"border rounded-lg p-3 space-y-2",children:[e.jsx(_,{className:"text-sm font-medium",children:"Permissions"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Select what this admin can do:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(Fa).map(([s,l])=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`perm-${s}`,checked:l,onChange:d=>Rn(h=>({...h,[s]:d.target.checked})),className:"h-4 w-4 rounded border-gray-300"}),e.jsx("label",{htmlFor:`perm-${s}`,className:"text-xs",children:s.replace(/_/g," ").replace(/can /i,"")})]},s))})]})]}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>st(!1),children:"Cancel"}),e.jsxs(v,{onClick:()=>Yn($t,Wt),disabled:!$t||T["add-admin"],children:[T["add-admin"]?e.jsx(Se,{className:"h-4 w-4 animate-spin mr-2"}):null,"Add ",Wt==="admin"?"Admin":"Moderator"]})]})]})}),e.jsx(ce,{open:yn,onOpenChange:Rs,children:e.jsxs(de,{children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Ban User"}),e.jsx(he,{children:"Permanently ban this user from the platform."})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(_,{htmlFor:"ban-reason",children:"Ban Reason"}),e.jsx(hs,{id:"ban-reason",placeholder:"Enter the reason for banning this user...",value:Tt,onChange:s=>Da(s.target.value)})]})}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>Rs(!1),children:"Cancel"}),e.jsxs(v,{variant:"destructive",onClick:()=>it&&Wn(it,Tt),disabled:!Tt.trim()||T[`ban-${it}`],children:[T[`ban-${it}`]?e.jsx(Se,{className:"h-4 w-4 animate-spin mr-2"}):null,"Ban User"]})]})]})}),e.jsx(ce,{open:wn,onOpenChange:Es,children:e.jsxs(de,{children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Suspend User"}),e.jsx(he,{children:"Temporarily suspend user account with specified duration."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"suspend-reason",children:"Suspension Reason"}),e.jsx(hs,{id:"suspend-reason",placeholder:"Enter the reason for suspending this user...",value:Ut,onChange:s=>Pa(s.target.value)})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"suspend-duration",children:"Suspension Duration (Days)"}),e.jsxs(De,{value:Ma,onValueChange:Aa,children:[e.jsx(Pe,{children:e.jsx(Me,{})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"1",children:"1 Day"}),e.jsx(R,{value:"3",children:"3 Days"}),e.jsx(R,{value:"7",children:"7 Days"}),e.jsx(R,{value:"14",children:"14 Days"}),e.jsx(R,{value:"30",children:"30 Days"})]})]})]})]}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>Es(!1),children:"Cancel"}),e.jsxs(v,{variant:"destructive",onClick:()=>lt&&In(lt,Ut,Ma),disabled:!Ut.trim()||T[`suspend-${lt}`],children:[T[`suspend-${lt}`]?e.jsx(Se,{className:"h-4 w-4 animate-spin mr-2"}):null,"Suspend User"]})]})]})}),e.jsx(ce,{open:bn,onOpenChange:Fs,children:e.jsxs(de,{children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Reject Product"}),e.jsx(he,{children:"Provide a reason for rejecting this product listing."})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(_,{htmlFor:"rejection-reason",children:"Rejection Reason"}),e.jsx(hs,{id:"rejection-reason",placeholder:"Enter the reason for rejecting this product...",value:Bt,onChange:s=>Ra(s.target.value)})]})}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>Fs(!1),children:"Cancel"}),e.jsxs(v,{variant:"destructive",onClick:()=>ot&&$n(ot,Bt),disabled:!Bt.trim()||T[`reject-${ot}`],children:[T[`reject-${ot}`]?e.jsx(Se,{className:"h-4 w-4 animate-spin mr-2"}):null,"Reject Product"]})]})]})}),e.jsx(ce,{open:Nn,onOpenChange:Ls,children:e.jsxs(de,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Add New Category"}),e.jsx(he,{children:"Create a category with dynamic properties and configuration."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(_,{children:"Category Name"}),e.jsx(oe,{placeholder:"e.g., Electronics",value:cs.name,onChange:s=>fs(l=>({...l,name:s.target.value}))})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(_,{children:"Description"}),e.jsx(hs,{placeholder:"Describe this category...",value:cs.description,onChange:s=>fs(l=>({...l,description:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(_,{children:"Parent Category"}),e.jsxs(De,{value:cs.parent_id,onValueChange:s=>fs(l=>({...l,parent_id:s})),children:[e.jsx(Pe,{children:e.jsx(Me,{placeholder:"None (Top Level)"})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"",children:"None (Top Level)"}),n.filter(s=>!s.parent_id).map(s=>e.jsx(R,{value:s.id,children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[e.jsx(fe,{checked:cs.is_active,onCheckedChange:s=>fs(l=>({...l,is_active:s}))}),e.jsx(_,{children:"Active Status"})]})]}),e.jsxs("div",{className:"border rounded-lg p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(_,{className:"text-base font-semibold",children:"Properties & Attributes"}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>Ye([...we,{key:"",value:""}]),children:[e.jsx(jt,{className:"h-3 w-3 mr-1"}),"Add Property"]})]}),we.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:"No properties defined. Add specific attributes like 'Size', 'Color', etc."}):e.jsx("div",{className:"space-y-3",children:we.map((s,l)=>e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx(oe,{placeholder:"Key (e.g. Size)",value:s.key,onChange:d=>{const h=[...we];h[l].key=d.target.value,Ye(h)},className:"flex-1"}),e.jsx(oe,{placeholder:"Value (e.g. S,M,L)",value:s.value,onChange:d=>{const h=[...we];h[l].value=d.target.value,Ye(h)},className:"flex-1"}),e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>{const d=we.filter((h,k)=>k!==l);Ye(d)},children:e.jsx(ys,{className:"h-4 w-4 text-red-500"})})]},l))})]})]}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>Ls(!1),children:"Cancel"}),e.jsxs(v,{onClick:()=>{const s=we.reduce((l,d)=>(d.key&&(l[d.key]=d.value),l),{});zn({...cs,properties:s})},disabled:!cs.name||T["create-category"],children:[T["create-category"]?e.jsx(Se,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Mr,{className:"h-4 w-4 mr-2"}),"Create Category"]})]})]})}),e.jsx(ce,{open:_n,onOpenChange:tt,children:e.jsxs(de,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Edit Category"}),e.jsxs(he,{children:["Modify ",je?.name," details and properties."]})]}),je&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(_,{children:"Category Name"}),e.jsx(oe,{value:je.name,onChange:s=>vs(l=>l?{...l,name:s.target.value}:null)})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(_,{children:"Description"}),e.jsx(hs,{value:je.description||"",onChange:s=>vs(l=>l?{...l,description:s.target.value}:null)})]}),e.jsxs("div",{children:[e.jsx(_,{children:"Parent Category"}),e.jsxs(De,{value:je.parent_id||"none",onValueChange:s=>vs(l=>l?{...l,parent_id:s==="none"?null:s}:null),children:[e.jsx(Pe,{children:e.jsx(Me,{placeholder:"None (Top Level)"})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"none",children:"None (Top Level)"}),n.filter(s=>!s.parent_id&&s.id!==je.id).map(s=>e.jsx(R,{value:s.id,children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-4",children:[e.jsx(fe,{checked:je.is_active,onCheckedChange:s=>vs(l=>l?{...l,is_active:s}:null)}),e.jsx(_,{children:"Active Status"})]})]}),e.jsxs("div",{className:"border rounded-lg p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(_,{className:"text-base font-semibold",children:"Properties & Attributes"}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>Ye([...we,{key:"",value:""}]),children:[e.jsx(jt,{className:"h-3 w-3 mr-1"}),"Add Property"]})]}),we.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:"No properties defined."}):e.jsx("div",{className:"space-y-3",children:we.map((s,l)=>e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx(oe,{placeholder:"Key",value:s.key,onChange:d=>{const h=[...we];h[l].key=d.target.value,Ye(h)},className:"flex-1"}),e.jsx(oe,{placeholder:"Value",value:s.value,onChange:d=>{const h=[...we];h[l].value=d.target.value,Ye(h)},className:"flex-1"}),e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>{const d=we.filter((h,k)=>k!==l);Ye(d)},children:e.jsx(ys,{className:"h-4 w-4 text-red-500"})})]},l))})]})]}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>tt(!1),children:"Cancel"}),e.jsxs(v,{onClick:()=>{if(je){const s=we.reduce((l,d)=>(d.key&&(l[d.key]=d.value),l),{});qn(je.id,{name:je.name,description:je.description,is_active:je.is_active,properties:s})}},disabled:!je?.name||T[`update-category-${je?.id}`],children:[T[`update-category-${je?.id}`]?e.jsx(Se,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Update Category"]})]})]})}),e.jsx(ce,{open:Cn,onOpenChange:s=>{At(s),s||Ot(null)},children:e.jsxs(de,{className:"max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs(ue,{className:"flex-shrink-0",children:[e.jsx(me,{children:"Report Details"}),e.jsx(he,{children:"Review and take action on this report."})]}),z?e.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[e.jsx("div",{className:"mb-4 flex-shrink-0",children:e.jsxs("details",{className:"text-xs",children:[e.jsx("summary",{className:"cursor-pointer font-medium text-gray-600",children:"Debug Info"}),e.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded",children:e.jsx("pre",{className:"overflow-auto max-h-32",children:JSON.stringify({id:z.id,product_id:z.reported_id,product_name:z.product_name,has_images:z.product_images?.length>0,reporter_email:z.reporter_email},null,2)})})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Report ID"}),e.jsx("p",{className:"text-sm font-mono truncate",children:z.id})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Status"}),e.jsx(q,{variant:z.status==="pending"?"destructive":"default",children:z.status})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Reporter"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"h-10 w-10 flex-shrink-0",children:e.jsx(Ue,{children:z.reporter_email?.charAt(0)?.toUpperCase()||"R"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:z.reporter_email||"Unknown"}),e.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:["Reported on:"," ",new Date(z.created_at).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Report Reason"}),e.jsx("p",{className:"text-sm font-medium",children:z.reason}),z.description&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Additional Details:"}),e.jsx("div",{className:"max-h-32 overflow-y-auto",children:e.jsx("p",{className:"text-sm p-2 bg-gray-50 rounded whitespace-pre-wrap",children:z.description})})]})]}),z.product_name&&e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-sm mb-2 flex items-center gap-2",children:[e.jsx(gt,{className:"h-4 w-4 flex-shrink-0"}),"Reported Product"]}),e.jsxs("div",{className:"flex items-start gap-4",children:[z.product_images?.[0]&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:z.product_images[0],alt:z.product_name,className:"h-20 w-20 rounded object-cover border",onError:s=>{s.currentTarget.style.display="none"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-medium truncate",children:z.product_name}),e.jsxs("div",{className:"space-y-1 mt-2",children:[z.product_price&&e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Price:"})," KES"," ",z.product_price.toLocaleString()]}),z.product_category_name&&e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Category:"})," ",z.product_category_name]}),z.seller_name&&e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Seller:"})," ",z.seller_name]}),z.product_created_at&&e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Listed:"})," ",new Date(z.product_created_at).toLocaleDateString()]})]})]})]})]}),e.jsx("div",{className:"pt-4 pb-2 border-t mt-4 flex-shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",onClick:()=>{qt(z.id,"dismissed","Report dismissed without action")},disabled:T[`resolve-${z.id}`],className:"flex-1",children:[T[`resolve-${z.id}`]?e.jsx(Se,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(ft,{className:"h-4 w-4 mr-2"}),"Dismiss"]}),e.jsxs(v,{variant:"destructive",onClick:()=>{qt(z.id,"action_taken","Appropriate action taken")},disabled:T[`resolve-${z.id}`],className:"flex-1",children:[e.jsx(aa,{className:"h-4 w-4 mr-2"}),"Take Action"]})]})})]})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading report details..."})]})})]})}),e.jsx(ce,{open:Sn,onOpenChange:at,children:e.jsxs(de,{children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Bulk Actions"}),e.jsx(he,{children:"Perform actions on multiple items at once."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"bulk-action",children:"Select Action"}),e.jsxs(De,{value:es,onValueChange:En,children:[e.jsx(Pe,{children:e.jsx(Me,{placeholder:"Choose an action"})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"approve",children:"Approve Products"}),e.jsx(R,{value:"feature",children:"Feature Products"}),e.jsx(R,{value:"ban",children:"Ban Users"}),e.jsx(R,{value:"suspend",children:"Suspend Users"}),e.jsx(R,{value:"activate",children:"Activate Categories"}),e.jsx(R,{value:"deactivate",children:"Deactivate Categories"})]})]})]}),es&&e.jsx(He,{children:e.jsx(Ke,{children:"This action will be performed on all selected items. This cannot be undone."})})]}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>at(!1),children:"Cancel"}),e.jsx(v,{onClick:()=>{es.includes("product")?ls(es,"products",Ie):es.includes("user")?ls(es,"users",Ee):es.includes("category")&&ls(es,"categories",hn)},disabled:!es,children:"Execute Bulk Action"})]})]})}),e.jsx(ce,{open:kn,onOpenChange:rt,children:e.jsxs(de,{className:"max-w-2xl",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"System Settings"}),e.jsx(he,{children:"Configure platform-wide settings and preferences."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"Product Settings"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{htmlFor:"auto-approve-setting",children:"Auto-approve Products"}),e.jsx(fe,{id:"auto-approve-setting",checked:ie.auto_approve_products,onCheckedChange:s=>xe(l=>({...l,auto_approve_products:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{htmlFor:"email-verification-setting",children:"Email Verification"}),e.jsx(fe,{id:"email-verification-setting",checked:ie.require_email_verification,onCheckedChange:s=>xe(l=>({...l,require_email_verification:s}))})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"User Settings"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{htmlFor:"allow-signups-setting",children:"Allow New Signups"}),e.jsx(fe,{id:"allow-signups-setting",checked:ie.allow_new_signups,onCheckedChange:s=>xe(l=>({...l,allow_new_signups:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{htmlFor:"maintenance-setting",children:"Maintenance Mode"}),e.jsx(fe,{id:"maintenance-setting",checked:ie.enable_maintenance_mode,onCheckedChange:s=>xe(l=>({...l,enable_maintenance_mode:s}))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"max-products-setting",children:"Max Products Per User"}),e.jsx(oe,{id:"max-products-setting",type:"number",value:ie.max_products_per_user,onChange:s=>xe(l=>({...l,max_products_per_user:parseInt(s.target.value)||50}))})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"commission-setting",children:"Platform Commission (%)"}),e.jsx(oe,{id:"commission-setting",type:"number",value:ie.platform_commission,onChange:s=>xe(l=>({...l,platform_commission:parseInt(s.target.value)||5}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"currency-setting",children:"Currency"}),e.jsxs(De,{value:ie.currency,onValueChange:s=>xe(l=>({...l,currency:s})),children:[e.jsx(Pe,{children:e.jsx(Me,{})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"KES",children:"KES - Kenyan Shilling"}),e.jsx(R,{value:"USD",children:"USD - US Dollar"}),e.jsx(R,{value:"EUR",children:"EUR - Euro"})]})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"support-email",children:"Support Email"}),e.jsx(oe,{id:"support-email",type:"email",value:ie.support_email,onChange:s=>xe(l=>({...l,support_email:s.target.value}))})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold",children:"Backup Settings"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{htmlFor:"auto-backup-setting",children:"Auto Backup"}),e.jsx(fe,{id:"auto-backup-setting",checked:ie.auto_backup,onCheckedChange:s=>xe(l=>({...l,auto_backup:s}))})]}),ie.auto_backup&&e.jsxs("div",{children:[e.jsx(_,{htmlFor:"backup-frequency",children:"Backup Frequency"}),e.jsxs(De,{value:ie.backup_frequency,onValueChange:s=>xe(l=>({...l,backup_frequency:s})),children:[e.jsx(Pe,{children:e.jsx(Me,{})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"daily",children:"Daily"}),e.jsx(R,{value:"weekly",children:"Weekly"}),e.jsx(R,{value:"monthly",children:"Monthly"})]})]})]})]})]}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>rt(!1),children:"Cancel"}),e.jsxs(v,{onClick:Ia,disabled:T["update-settings"],children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Save Settings"]})]})]})}),e.jsx(ce,{open:Dn,onOpenChange:nt,children:e.jsxs(de,{className:"max-w-2xl",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Email Template"}),e.jsx(he,{children:"Create and send emails to users."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"email-type",children:"Email Type"}),e.jsxs(De,{value:is.type,onValueChange:s=>Ts(l=>({...l,type:s})),children:[e.jsx(Pe,{children:e.jsx(Me,{})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"welcome",children:"Welcome Email"}),e.jsx(R,{value:"notification",children:"System Notification"}),e.jsx(R,{value:"promotional",children:"Promotional"}),e.jsx(R,{value:"alert",children:"Security Alert"})]})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"email-recipients",children:"Recipients"}),e.jsxs(De,{value:is.recipients,onValueChange:s=>Ts(l=>({...l,recipients:s})),children:[e.jsx(Pe,{children:e.jsx(Me,{})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"all",children:"All Users"}),e.jsx(R,{value:"sellers",children:"Sellers Only"}),e.jsx(R,{value:"buyers",children:"Buyers Only"}),e.jsx(R,{value:"premium",children:"Premium Users"})]})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"email-subject",children:"Subject"}),e.jsx(oe,{id:"email-subject",placeholder:"Enter email subject",value:is.subject,onChange:s=>Ts(l=>({...l,subject:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"email-content",children:"Content"}),e.jsx(hs,{id:"email-content",placeholder:"Enter email content...",rows:8,value:is.content,onChange:s=>Ts(l=>({...l,content:s.target.value}))})]})]}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>nt(!1),children:"Cancel"}),e.jsxs(v,{onClick:Qn,disabled:!is.subject||!is.content||T["bulk-email"],children:[e.jsx(Za,{className:"h-4 w-4 mr-2"}),"Send Email"]})]})]})}),e.jsx(ce,{open:Pn,onOpenChange:Rt,children:e.jsxs(de,{className:"max-w-4xl",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Admin Activity Log"}),e.jsx(he,{children:"Recent administrative actions and changes."})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:e.jsxs(Ve,{children:[e.jsx(ze,{children:e.jsxs(se,{children:[e.jsx(C,{children:"Admin"}),e.jsx(C,{children:"Action"}),e.jsx(C,{children:"Resource"}),e.jsx(C,{children:"Details"}),e.jsx(C,{children:"Time"})]})}),e.jsx(qe,{children:Ce.map(s=>e.jsxs(se,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-6 w-6",children:e.jsx(Ue,{className:"text-xs",children:s.admin_email?.charAt(0).toUpperCase()})}),e.jsx("span",{className:"text-sm",children:s.admin_email})]})}),e.jsx(N,{children:e.jsx(q,{variant:"outline",className:"capitalize",children:s.action_type.replace(/_/g," ")})}),e.jsx(N,{children:e.jsx("span",{className:"text-sm capitalize",children:s.resource_type})}),e.jsx(N,{children:e.jsx("p",{className:"text-sm text-muted-foreground max-w-[200px] truncate",children:JSON.stringify(s.details)})}),e.jsx(N,{children:e.jsx("span",{className:"text-sm",children:new Date(s.created_at).toLocaleString()})})]},s.id))})]})})]})}),e.jsx(ce,{open:Mn,onOpenChange:Os,children:e.jsxs(de,{children:[e.jsxs(ue,{children:[e.jsx(me,{children:"System Backup"}),e.jsx(he,{children:"Create a backup of the system data and configuration."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"backup-type",children:"Backup Type"}),e.jsxs(De,{value:ct.backup_type,onValueChange:s=>It(l=>({...l,backup_type:s})),children:[e.jsx(Pe,{children:e.jsx(Me,{})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"full",children:"Full Backup"}),e.jsx(R,{value:"database",children:"Database Only"}),e.jsx(R,{value:"media",children:"Media Files Only"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fe,{id:"include-media",checked:ct.include_media,onCheckedChange:s=>It(l=>({...l,include_media:s}))}),e.jsx(_,{htmlFor:"include-media",children:"Include Media Files"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fe,{id:"include-database",checked:ct.include_database,onCheckedChange:s=>It(l=>({...l,include_database:s}))}),e.jsx(_,{htmlFor:"include-database",children:"Include Database"})]}),e.jsx(He,{children:e.jsx(Ke,{children:"This process may take several minutes depending on the amount of data."})})]}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>Os(!1),children:"Cancel"}),e.jsxs(v,{onClick:Gn,disabled:T["system-backup"],children:[T["system-backup"]?e.jsx(Se,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(wt,{className:"h-4 w-4 mr-2"}),"Start Backup"]})]})]})}),e.jsx(ce,{open:on,onOpenChange:Zs,children:e.jsxs(de,{children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Adjust Subscription"}),e.jsx(he,{children:"Manually adjust upload limits and subscription status"})]}),ve&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"User"}),e.jsx("p",{className:"text-sm",children:ve.user_email}),e.jsx("p",{className:"text-xs text-muted-foreground",children:ve.plan_name})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"status",children:"Subscription Status"}),e.jsxs(De,{value:Re.status,onValueChange:s=>et({...Re,status:s}),children:[e.jsx(Pe,{children:e.jsx(Me,{})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"active",children:"Active"}),e.jsx(R,{value:"pending",children:"Pending"}),e.jsx(R,{value:"cancelled",children:"Cancelled"}),e.jsx(R,{value:"expired",children:"Expired"}),e.jsx(R,{value:"failed",children:"Failed"})]})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"notes",children:"Admin Notes"}),e.jsx(hs,{id:"notes",value:Re.notes,onChange:s=>et({...Re,notes:s.target.value}),placeholder:"Reason for manual adjustment (for audit trail)",rows:3})]})]}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>Zs(!1),children:"Cancel"}),e.jsx(v,{onClick:Jn,disabled:T[`adjust-subscription-${ve?.id}`],children:T[`adjust-subscription-${ve?.id}`]?e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4 mr-2 animate-spin"}),"Adjusting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})}),e.jsx(ce,{open:vn,onOpenChange:jn,children:e.jsxs(de,{className:"max-w-2xl",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Product Details"}),e.jsx(he,{children:"Detailed information about the product listing."})]}),ne&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Product Name"}),e.jsx("p",{className:"text-sm",children:ne.name})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Price"}),e.jsxs("p",{className:"text-sm font-semibold",children:["KES ",ne.price?.toLocaleString()]})]})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ne.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Seller"}),e.jsx("p",{className:"text-sm",children:ne.seller_email})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Category"}),e.jsx("p",{className:"text-sm",children:ne.category_name||"Uncategorized"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Status"}),e.jsx(q,{variant:"default",children:ne.status})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Created"}),e.jsx("p",{className:"text-sm",children:new Date(ne.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[j.canFeatureProducts&&e.jsx(v,{variant:"outline",onClick:()=>zt(ne.id,!ne.featured),disabled:T[`feature-${ne.id}`],children:ne.featured?"Unfeature":"Feature"}),j.canVerifyProducts&&e.jsx(v,{variant:"outline",onClick:()=>Ba(ne.id,!ne.verified),disabled:T[`verify-${ne.id}`],children:ne.verified?"Unverify":"Verify"}),j.canDeleteProducts&&e.jsx(v,{variant:"destructive",onClick:()=>$a(ne.id),disabled:T[`delete-${ne.id}`],children:"Delete"})]})]})]})}),e.jsx(ce,{open:pn,onOpenChange:As,children:e.jsxs(de,{className:"max-w-2xl",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"User Details"}),e.jsx(he,{children:"Detailed information about the user account."})]}),ae&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Te,{className:"h-16 w-16",children:ae.avatar_url?e.jsx($s,{src:ae.avatar_url}):e.jsx(Ue,{className:"text-lg",children:ae.email?.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:ae.email}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ae.full_name}),e.jsx(q,{variant:ae.status==="active"?"default":ae.status==="banned"?"destructive":"secondary",children:ae.status})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Products Listed"}),e.jsx("p",{className:"text-sm",children:ae.products_count||0})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Reviews Written"}),e.jsx("p",{className:"text-sm",children:ae.reviews_count||0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Plan Type"}),e.jsx("p",{className:"text-sm capitalize",children:ae.plan_type})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Joined"}),e.jsx("p",{className:"text-sm",children:new Date(ae.created_at).toLocaleDateString()})]})]}),ae.ban_reason&&e.jsxs("div",{children:[e.jsx(_,{className:"text-sm font-medium",children:"Ban Reason"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ae.ban_reason})]}),e.jsx("div",{className:"flex gap-2 pt-4",children:ae.status==="active"?e.jsxs(e.Fragment,{children:[j.canSuspendUsers&&e.jsx(v,{variant:"outline",onClick:()=>{Ft(ae.id),Es(!0),As(!1)},children:"Suspend"}),j.canBanUsers&&e.jsx(v,{variant:"destructive",onClick:()=>{Et(ae.id),Rs(!0),As(!1)},children:"Ban"})]}):j.canBanUsers&&e.jsx(v,{variant:"outline",onClick:()=>{Wa(ae.id),As(!1)},disabled:T[`unban-${ae.id}`],children:"Unban"})})]})]})}),e.jsx(ce,{open:un,onOpenChange:Mt,children:e.jsxs(de,{className:"max-w-3xl",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Payment Details"}),e.jsx(he,{children:"Transaction history for this subscription attempt."})]}),ye&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 border-b pb-4",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-xs text-muted-foreground",children:"User"}),e.jsx("p",{className:"text-sm font-medium",children:ye.profiles?.email||"Unknown"})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-xs text-muted-foreground",children:"Plan"}),e.jsxs("p",{className:"text-sm font-medium capitalize",children:[ye.plan_name," (",ye.billing_cycle,")"]})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-xs text-muted-foreground",children:"Status"}),e.jsx(q,{variant:ye.status==="active"?"default":ye.status==="failed"?"destructive":"secondary",children:ye.status})]}),e.jsxs("div",{children:[e.jsx(_,{className:"text-xs text-muted-foreground",children:"Amount"}),e.jsxs("p",{className:"text-sm font-bold",children:["KES ",ye.amount?.toLocaleString()]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Technical Details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 bg-muted/30 p-3 rounded-md text-xs font-mono",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Checkout Request ID:"}),e.jsx("span",{children:ye.checkout_request_id||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"M-Pesa Receipt:"}),e.jsx("span",{children:ye.mpesa_receipt_number||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Initiated At:"}),e.jsx("span",{children:ye.initiated_at?new Date(ye.initiated_at).toLocaleString():"N/A"})]}),ye.failure_reason&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-red-100 text-red-600",children:[e.jsx("span",{className:"font-semibold",children:"Failure Reason: "}),ye.failure_reason]})]})]})]}),e.jsx(ke,{children:e.jsx(v,{onClick:()=>Mt(!1),children:"Close"})})]})}),e.jsx(ce,{open:Y,onOpenChange:Q,children:e.jsxs(de,{className:"sm:max-w-[425px]",children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Export Data"}),e.jsx(he,{children:"Select data type and optional date range for export."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(_,{htmlFor:"resource-type",className:"text-right",children:"Data Type"}),e.jsxs(De,{value:D,onValueChange:P,children:[e.jsx(Pe,{className:"col-span-3",children:e.jsx(Me,{placeholder:"Select type"})}),e.jsxs(Ae,{children:[e.jsx(R,{value:"users",children:"Users"}),e.jsx(R,{value:"products",children:"Products"}),e.jsx(R,{value:"transactions",children:"Transactions"}),e.jsx(R,{value:"subscriptions",children:"Subscriptions"}),e.jsx(R,{value:"withdrawals",children:"Withdrawals"}),e.jsx(R,{value:"reports",children:"Reports"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(_,{className:"text-right",children:"Start Date"}),e.jsx("div",{className:"col-span-3",children:e.jsxs(wr,{children:[e.jsx(br,{asChild:!0,children:e.jsxs(v,{variant:"outline",className:bs("w-full justify-start text-left font-normal",!J&&"text-muted-foreground"),children:[e.jsx(ur,{className:"mr-2 h-4 w-4"}),J?Ge(J,"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(ha,{className:"w-auto p-0",children:e.jsx(ma,{mode:"single",selected:J,onSelect:Xe,initialFocus:!0})})]})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(_,{className:"text-right",children:"End Date"}),e.jsx("div",{className:"col-span-3",children:e.jsxs(wr,{children:[e.jsx(br,{asChild:!0,children:e.jsxs(v,{variant:"outline",className:bs("w-full justify-start text-left font-normal",!We&&"text-muted-foreground"),children:[e.jsx(ur,{className:"mr-2 h-4 w-4"}),We?Ge(We,"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(ha,{className:"w-auto p-0",children:e.jsx(ma,{mode:"single",selected:We,onSelect:Gs,initialFocus:!0})})]})})]})]}),e.jsxs(ke,{children:[e.jsx(v,{variant:"outline",onClick:()=>Q(!1),children:"Cancel"}),e.jsxs(v,{onClick:si,children:[e.jsx(er,{className:"mr-2 h-4 w-4"}),"Export CSV"]})]})]})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-blue-50/30",children:e.jsxs(W,{className:"w-full max-w-md",children:[e.jsxs(H,{children:[e.jsx(K,{className:"text-center",children:"Access Denied"}),e.jsx(re,{className:"text-center",children:"You don't have administrator privileges to access this dashboard."})]}),e.jsx(I,{className:"flex justify-center",children:e.jsx(v,{onClick:()=>window.location.href="/",children:"Return to Home"})})]})})}export{od as default};
